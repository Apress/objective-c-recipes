<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>API: AppKit/CPTableView.j Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">API&#160;<span id="projectnumber">0.9.5</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_c_p_table_view_8j.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">AppKit/CPTableView.j</div>  </div>
</div>
<div class="contents">
<a href="_c_p_table_view_8j.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * CPTableView.j</span>
<a name="l00003"></a>00003 <span class="comment"> * AppKit</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * Created by Francisco Tolmasky.</span>
<a name="l00006"></a>00006 <span class="comment"> * Copyright 2009, 280 North, Inc.</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * This library is free software; you can redistribute it and/or</span>
<a name="l00009"></a>00009 <span class="comment"> * modify it under the terms of the GNU Lesser General Public</span>
<a name="l00010"></a>00010 <span class="comment"> * License as published by the Free Software Foundation; either</span>
<a name="l00011"></a>00011 <span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> * This library is distributed in the hope that it will be useful,</span>
<a name="l00014"></a>00014 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00015"></a>00015 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span>
<a name="l00016"></a>00016 <span class="comment"> * Lesser General Public License for more details.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> * You should have received a copy of the GNU Lesser General Public</span>
<a name="l00019"></a>00019 <span class="comment"> * License along with this library; if not, write to the Free Software</span>
<a name="l00020"></a>00020 <span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</span>
<a name="l00021"></a>00021 <span class="comment"> */</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="_c_p_table_view_8j.html#a6db94aeda7d0b1f024686ab91d7a9fbd">00027</a> <a class="code" href="_c_p_table_view_8j.html#a6db94aeda7d0b1f024686ab91d7a9fbd">CPTableViewColumnDidMoveNotification</a>        = <span class="stringliteral">@&quot;CPTableViewColumnDidMoveNotification&quot;</span>;
<a name="l00028"></a><a class="code" href="_c_p_table_view_8j.html#ad35f7c5fbd420b1766b470df7df236ed">00028</a> <a class="code" href="_c_p_table_view_8j.html#ad35f7c5fbd420b1766b470df7df236ed">CPTableViewColumnDidResizeNotification</a>      = <span class="stringliteral">@&quot;CPTableViewColumnDidResizeNotification&quot;</span>;
<a name="l00029"></a><a class="code" href="_c_p_table_view_8j.html#a51f328a6630fa3c37dd97e3ebcd47bad">00029</a> <a class="code" href="_c_p_table_view_8j.html#a51f328a6630fa3c37dd97e3ebcd47bad">CPTableViewSelectionDidChangeNotification</a>   = <span class="stringliteral">@&quot;CPTableViewSelectionDidChangeNotification&quot;</span>;
<a name="l00030"></a><a class="code" href="_c_p_table_view_8j.html#a05ad281074c809f38e75ada2b2ac510f">00030</a> <a class="code" href="_c_p_table_view_8j.html#a05ad281074c809f38e75ada2b2ac510f">CPTableViewSelectionIsChangingNotification</a>  = <span class="stringliteral">@&quot;CPTableViewSelectionIsChangingNotification&quot;</span>;
<a name="l00031"></a>00031 
<a name="l00032"></a><a class="code" href="_c_p_table_view_8j.html#a79c288910d3f547d5433a6946cec05bc">00032</a> var <a class="code" href="_c_p_table_view_8j.html#a79c288910d3f547d5433a6946cec05bc">CPTableViewDataSource_numberOfRowsInTableView_</a>                                                      = 1 &lt;&lt; 0,
<a name="l00033"></a><a class="code" href="_c_p_table_view_8j.html#a23288f0ff7ed53d22d474f4248c733b1">00033</a>     <a class="code" href="_c_p_table_view_8j.html#a23288f0ff7ed53d22d474f4248c733b1">CPTableViewDataSource_tableView_objectValueForTableColumn_row_</a>                                      = 1 &lt;&lt; 1,
<a name="l00034"></a><a class="code" href="_c_p_table_view_8j.html#a9f25c28df39dca590ad108beb6b4b48b">00034</a>     <a class="code" href="_c_p_table_view_8j.html#a9f25c28df39dca590ad108beb6b4b48b">CPTableViewDataSource_tableView_setObjectValue_forTableColumn_row_</a>                                  = 1 &lt;&lt; 2,
<a name="l00035"></a><a class="code" href="_c_p_table_view_8j.html#a71f4aae1a37e8503f63542e1d977edce">00035</a>     <a class="code" href="_c_p_table_view_8j.html#a71f4aae1a37e8503f63542e1d977edce">CPTableViewDataSource_tableView_acceptDrop_row_dropOperation_</a>                                       = 1 &lt;&lt; 3,
<a name="l00036"></a><a class="code" href="_c_p_table_view_8j.html#a70eaee52bd8ae42e829dc246bfffa90f">00036</a>     <a class="code" href="_c_p_table_view_8j.html#a70eaee52bd8ae42e829dc246bfffa90f">CPTableViewDataSource_tableView_namesOfPromisedFilesDroppedAtDestination_forDraggedRowsWithIndexes_</a> = 1 &lt;&lt; 4,
<a name="l00037"></a><a class="code" href="_c_p_table_view_8j.html#a4f6917aa9754d8c13c933ae043ca4963">00037</a>     <a class="code" href="_c_p_table_view_8j.html#a4f6917aa9754d8c13c933ae043ca4963">CPTableViewDataSource_tableView_validateDrop_proposedRow_proposedDropOperation_</a>                     = 1 &lt;&lt; 5,
<a name="l00038"></a><a class="code" href="_c_p_table_view_8j.html#a3fb0a731ef8cca0484830f426bcbe81f">00038</a>     <a class="code" href="_c_p_table_view_8j.html#a3fb0a731ef8cca0484830f426bcbe81f">CPTableViewDataSource_tableView_writeRowsWithIndexes_toPasteboard_</a>                                  = 1 &lt;&lt; 6,
<a name="l00039"></a>00039 
<a name="l00040"></a><a class="code" href="_c_p_table_view_8j.html#a3270c812883a130ed7efbc0f119a8ec7">00040</a>     <a class="code" href="_c_p_table_view_8j.html#a3270c812883a130ed7efbc0f119a8ec7">CPTableViewDataSource_tableView_sortDescriptorsDidChange_</a>                                           = 1 &lt;&lt; 7;
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="_c_p_table_view_8j.html#a17dd3c2f77d47e02db83a2643962e03f">00042</a> var <a class="code" href="_c_p_table_view_8j.html#a17dd3c2f77d47e02db83a2643962e03f">CPTableViewDelegate_selectionShouldChangeInTableView_</a>                                               = 1 &lt;&lt; 0,
<a name="l00043"></a><a class="code" href="_c_p_table_view_8j.html#a50ccc5dbd574a129aca4b61924308813">00043</a>     <a class="code" href="_c_p_table_view_8j.html#a50ccc5dbd574a129aca4b61924308813">CPTableViewDelegate_tableView_dataViewForTableColumn_row_</a>                                           = 1 &lt;&lt; 1,
<a name="l00044"></a><a class="code" href="_c_p_table_view_8j.html#a11302327c1511f3a71d93e494794c655">00044</a>     <a class="code" href="_c_p_table_view_8j.html#a11302327c1511f3a71d93e494794c655">CPTableViewDelegate_tableView_didClickTableColumn_</a>                                                  = 1 &lt;&lt; 2,
<a name="l00045"></a><a class="code" href="_c_p_table_view_8j.html#ac6764797b21b0862c8ea1223c05626c2">00045</a>     <a class="code" href="_c_p_table_view_8j.html#ac6764797b21b0862c8ea1223c05626c2">CPTableViewDelegate_tableView_didDragTableColumn_</a>                                                   = 1 &lt;&lt; 3,
<a name="l00046"></a><a class="code" href="_c_p_table_view_8j.html#afd61c24dda7ceebc29da34fa3b5f4a3a">00046</a>     <a class="code" href="_c_p_table_view_8j.html#afd61c24dda7ceebc29da34fa3b5f4a3a">CPTableViewDelegate_tableView_heightOfRow_</a>                                                          = 1 &lt;&lt; 4,
<a name="l00047"></a><a class="code" href="_c_p_table_view_8j.html#a1b2d38c75129c936b93b4163a5a32889">00047</a>     <a class="code" href="_c_p_table_view_8j.html#a1b2d38c75129c936b93b4163a5a32889">CPTableViewDelegate_tableView_isGroupRow_</a>                                                           = 1 &lt;&lt; 5,
<a name="l00048"></a><a class="code" href="_c_p_table_view_8j.html#a53db520f3c6c396184ef32c5a586b027">00048</a>     <a class="code" href="_c_p_table_view_8j.html#a53db520f3c6c396184ef32c5a586b027">CPTableViewDelegate_tableView_mouseDownInHeaderOfTableColumn_</a>                                       = 1 &lt;&lt; 6,
<a name="l00049"></a><a class="code" href="_c_p_table_view_8j.html#abf8671c1652c48238dc5c04fc9550a62">00049</a>     <a class="code" href="_c_p_table_view_8j.html#abf8671c1652c48238dc5c04fc9550a62">CPTableViewDelegate_tableView_nextTypeSelectMatchFromRow_toRow_forString_</a>                           = 1 &lt;&lt; 7,
<a name="l00050"></a><a class="code" href="_c_p_table_view_8j.html#a87a639d266ecdd1db204b2b3e3d0e97d">00050</a>     <a class="code" href="_c_p_table_view_8j.html#a87a639d266ecdd1db204b2b3e3d0e97d">CPTableViewDelegate_tableView_selectionIndexesForProposedSelection_</a>                                 = 1 &lt;&lt; 8,
<a name="l00051"></a><a class="code" href="_c_p_table_view_8j.html#a13a5d77ea463b7ee16d106bdf440baef">00051</a>     <a class="code" href="_c_p_table_view_8j.html#a13a5d77ea463b7ee16d106bdf440baef">CPTableViewDelegate_tableView_shouldEditTableColumn_row_</a>                                            = 1 &lt;&lt; 9,
<a name="l00052"></a><a class="code" href="_c_p_table_view_8j.html#aaea951ab19dc11a096a69b28cc216e38">00052</a>     <a class="code" href="_c_p_table_view_8j.html#aaea951ab19dc11a096a69b28cc216e38">CPTableViewDelegate_tableView_shouldSelectRow_</a>                                                      = 1 &lt;&lt; 10,
<a name="l00053"></a><a class="code" href="_c_p_table_view_8j.html#a40e46e56c68f00ce2e3fe0c2dce75577">00053</a>     <a class="code" href="_c_p_table_view_8j.html#a40e46e56c68f00ce2e3fe0c2dce75577">CPTableViewDelegate_tableView_shouldSelectTableColumn_</a>                                              = 1 &lt;&lt; 11,
<a name="l00054"></a><a class="code" href="_c_p_table_view_8j.html#a47c3d5fa0d018996943ef98b80ffd3ed">00054</a>     <a class="code" href="_c_p_table_view_8j.html#a47c3d5fa0d018996943ef98b80ffd3ed">CPTableViewDelegate_tableView_shouldShowViewExpansionForTableColumn_row_</a>                            = 1 &lt;&lt; 12,
<a name="l00055"></a><a class="code" href="_c_p_table_view_8j.html#a84373538a8878335c8efedfc6a73dfda">00055</a>     <a class="code" href="_c_p_table_view_8j.html#a84373538a8878335c8efedfc6a73dfda">CPTableViewDelegate_tableView_shouldTrackView_forTableColumn_row_</a>                                   = 1 &lt;&lt; 13,
<a name="l00056"></a><a class="code" href="_c_p_table_view_8j.html#a90bdeeee16a3591df2596384e4f627e3">00056</a>     <a class="code" href="_c_p_table_view_8j.html#a90bdeeee16a3591df2596384e4f627e3">CPTableViewDelegate_tableView_shouldTypeSelectForEvent_withCurrentSearchString_</a>                     = 1 &lt;&lt; 14,
<a name="l00057"></a><a class="code" href="_c_p_table_view_8j.html#a106983f227bb2afdff8e05449a4ea33a">00057</a>     <a class="code" href="_c_p_table_view_8j.html#a106983f227bb2afdff8e05449a4ea33a">CPTableViewDelegate_tableView_toolTipForView_rect_tableColumn_row_mouseLocation_</a>                    = 1 &lt;&lt; 15,
<a name="l00058"></a><a class="code" href="_c_p_table_view_8j.html#a8a84faf4826019c8a187588890360704">00058</a>     <a class="code" href="_c_p_table_view_8j.html#a8a84faf4826019c8a187588890360704">CPTableViewDelegate_tableView_typeSelectStringForTableColumn_row_</a>                                   = 1 &lt;&lt; 16,
<a name="l00059"></a><a class="code" href="_c_p_table_view_8j.html#ad543a1b68132942313c20a9414cb508c">00059</a>     <a class="code" href="_c_p_table_view_8j.html#ad543a1b68132942313c20a9414cb508c">CPTableViewDelegate_tableView_willDisplayView_forTableColumn_row_</a>                                   = 1 &lt;&lt; 17,
<a name="l00060"></a><a class="code" href="_c_p_table_view_8j.html#a0e92f5ab48715248e82afe1bd74528b7">00060</a>     <a class="code" href="_c_p_table_view_8j.html#a0e92f5ab48715248e82afe1bd74528b7">CPTableViewDelegate_tableViewSelectionDidChange_</a>                                                    = 1 &lt;&lt; 18,
<a name="l00061"></a><a class="code" href="_c_p_table_view_8j.html#ac80a4fc92d5dd3f875a79b2c44b55ed3">00061</a>     <a class="code" href="_c_p_table_view_8j.html#ac80a4fc92d5dd3f875a79b2c44b55ed3">CPTableViewDelegate_tableViewSelectionIsChanging_</a>                                                   = 1 &lt;&lt; 19,
<a name="l00062"></a><a class="code" href="_c_p_table_view_8j.html#aa51e2e3e077c35d99ca7b87d83e2eb01">00062</a>     <a class="code" href="_c_p_table_view_8j.html#aa51e2e3e077c35d99ca7b87d83e2eb01">CPTableViewDelegate_tableViewMenuForTableColumn_Row_</a>                                                = 1 &lt;&lt; 20;
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="comment">//CPTableViewDraggingDestinationFeedbackStyles</span>
<a name="l00065"></a><a class="code" href="_c_p_table_view_8j.html#a7d721e523dd8ab8740aff52cb54efa91">00065</a> <a class="code" href="_c_p_table_view_8j.html#a7d721e523dd8ab8740aff52cb54efa91">CPTableViewDraggingDestinationFeedbackStyleNone</a> = -1;
<a name="l00066"></a><a class="code" href="_c_p_table_view_8j.html#a4b9131f16846d5b2e77fbb2d855f48c1">00066</a> <a class="code" href="_c_p_table_view_8j.html#a4b9131f16846d5b2e77fbb2d855f48c1">CPTableViewDraggingDestinationFeedbackStyleRegular</a> = 0;
<a name="l00067"></a><a class="code" href="_c_p_table_view_8j.html#a5c1e1977569dc9ea54f519916529114b">00067</a> <a class="code" href="_c_p_table_view_8j.html#a5c1e1977569dc9ea54f519916529114b">CPTableViewDraggingDestinationFeedbackStyleSourceList</a> = 1;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 <span class="comment">//CPTableViewDropOperations</span>
<a name="l00070"></a><a class="code" href="_c_p_table_view_8j.html#a279093eafa50075a94c202e0dd51861a">00070</a> <a class="code" href="_c_p_table_view_8j.html#a279093eafa50075a94c202e0dd51861a">CPTableViewDropOn</a> = 0;
<a name="l00071"></a><a class="code" href="_c_p_table_view_8j.html#a4c2d1434c8bc5b937eeb47b55f5c74d0">00071</a> <a class="code" href="_c_p_table_view_8j.html#a4c2d1434c8bc5b937eeb47b55f5c74d0">CPTableViewDropAbove</a> = 1;
<a name="l00072"></a>00072 
<a name="l00073"></a><a class="code" href="_c_p_table_view_8j.html#ada5bc5795efd9616ee12493f704326f3">00073</a> <a class="code" href="_c_p_table_view_8j.html#ada5bc5795efd9616ee12493f704326f3">CPSourceListGradient</a> = <span class="stringliteral">&quot;CPSourceListGradient&quot;</span>;
<a name="l00074"></a><a class="code" href="_c_p_table_view_8j.html#adce48404c5e3cd2d4d0c138e5e1a0bfe">00074</a> <a class="code" href="_c_p_table_view_8j.html#adce48404c5e3cd2d4d0c138e5e1a0bfe">CPSourceListTopLineColor</a> = <span class="stringliteral">&quot;CPSourceListTopLineColor&quot;</span>;
<a name="l00075"></a><a class="code" href="_c_p_table_view_8j.html#a465d9d7df4346c4d8a82919df3c8f938">00075</a> <a class="code" href="_c_p_table_view_8j.html#a465d9d7df4346c4d8a82919df3c8f938">CPSourceListBottomLineColor</a> = <span class="stringliteral">&quot;CPSourceListBottomLineColor&quot;</span>;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="comment">// TODO: add docs</span>
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="_c_p_table_view_8j.html#a01cb9ff2b6562f83a7f4073abf81f7ce">00079</a> <a class="code" href="_c_p_table_view_8j.html#a01cb9ff2b6562f83a7f4073abf81f7ce">CPTableViewSelectionHighlightStyleNone</a> = -1;
<a name="l00080"></a><a class="code" href="_c_p_table_view_8j.html#aca8acc7a64967150badd9c4b7c6eedf9">00080</a> <a class="code" href="_c_p_table_view_8j.html#aca8acc7a64967150badd9c4b7c6eedf9">CPTableViewSelectionHighlightStyleRegular</a> = 0;
<a name="l00081"></a><a class="code" href="_c_p_table_view_8j.html#a9b1494c16eb023b6a546dc0fb584fce7">00081</a> <a class="code" href="_c_p_table_view_8j.html#a9b1494c16eb023b6a546dc0fb584fce7">CPTableViewSelectionHighlightStyleSourceList</a> = 1;
<a name="l00082"></a>00082 
<a name="l00083"></a><a class="code" href="_c_p_table_view_8j.html#aa39cb0e13ea617a0962d2b72bbbedd81">00083</a> <a class="code" href="_c_p_table_view_8j.html#aa39cb0e13ea617a0962d2b72bbbedd81">CPTableViewGridNone</a>                    = 0;
<a name="l00084"></a><a class="code" href="_c_p_table_view_8j.html#af147002e8b12fcaf12a2df975edb95b5">00084</a> <a class="code" href="_c_p_table_view_8j.html#af147002e8b12fcaf12a2df975edb95b5">CPTableViewSolidVerticalGridLineMask</a>   = 1 &lt;&lt; 0;
<a name="l00085"></a><a class="code" href="_c_p_table_view_8j.html#acc262027919f5d8fa9961299c57e4887">00085</a> <a class="code" href="_c_p_table_view_8j.html#acc262027919f5d8fa9961299c57e4887">CPTableViewSolidHorizontalGridLineMask</a> = 1 &lt;&lt; 1;
<a name="l00086"></a>00086 
<a name="l00087"></a><a class="code" href="_c_p_table_view_8j.html#ad0b8e7aa32705666ec47cfdb3fdbdeef">00087</a> <a class="code" href="_c_p_table_view_8j.html#ad0b8e7aa32705666ec47cfdb3fdbdeef">CPTableViewNoColumnAutoresizing</a> = 0;
<a name="l00088"></a><a class="code" href="_c_p_table_view_8j.html#a8f4ff5bd6c8f021a249d46098015f486">00088</a> <a class="code" href="_c_p_table_view_8j.html#a8f4ff5bd6c8f021a249d46098015f486">CPTableViewUniformColumnAutoresizingStyle</a> = 1; <span class="comment">// FIX ME: This is FUBAR</span>
<a name="l00089"></a><a class="code" href="_c_p_table_view_8j.html#a14105ece8d41c22e1552964bc8c97224">00089</a> <a class="code" href="_c_p_table_view_8j.html#a14105ece8d41c22e1552964bc8c97224">CPTableViewSequentialColumnAutoresizingStyle</a> = 2;
<a name="l00090"></a><a class="code" href="_c_p_table_view_8j.html#a48dbe0f6475c9d66899227d2bbaad37a">00090</a> <a class="code" href="_c_p_table_view_8j.html#a48dbe0f6475c9d66899227d2bbaad37a">CPTableViewReverseSequentialColumnAutoresizingStyle</a> = 3;
<a name="l00091"></a><a class="code" href="_c_p_table_view_8j.html#a0f472ac2d7a9f96e5ad5ec35e8d4af3f">00091</a> <a class="code" href="_c_p_table_view_8j.html#a0f472ac2d7a9f96e5ad5ec35e8d4af3f">CPTableViewLastColumnOnlyAutoresizingStyle</a> = 4;
<a name="l00092"></a><a class="code" href="_c_p_table_view_8j.html#a2817258659933aa465a18e1798822134">00092</a> <a class="code" href="_c_p_table_view_8j.html#a2817258659933aa465a18e1798822134">CPTableViewFirstColumnOnlyAutoresizingStyle</a> = 5;
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="_c_p_table_view_8j.html#aa0c3e20940452d04b6708ec8b82b482b">00094</a> <span class="preprocessor">#define NUMBER_OF_COLUMNS() (_tableColumns.length)</span>
<a name="l00095"></a><a class="code" href="_c_p_table_view_8j.html#a8d863ee1b9f1e447c7ee408af11b8f22">00095</a> <span class="preprocessor"></span><span class="preprocessor">#define UPDATE_COLUMN_RANGES_IF_NECESSARY() if (_dirtyTableColumnRangeIndex !== CPNotFound) [self _recalculateTableColumnRanges];</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span>
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 <span class="keyword">@implementation </span>_CPTableDrawView : <a class="code" href="interface_c_p_view.html">CPView</a>
<a name="l00099"></a>00099 {
<a name="l00100"></a>00100     <a class="code" href="interface_c_p_table_view.html">CPTableView</a> _tableView;
<a name="l00101"></a>00101 }
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 - (id)initWithTableView:(<a class="code" href="interface_c_p_table_view.html">CPTableView</a>)aTableView
<a name="l00104"></a>00104 {
<a name="l00105"></a>00105     <span class="keyword">self</span> = [<span class="keyword">super</span> init];
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     <span class="keywordflow">if</span> (<span class="keyword">self</span>)
<a name="l00108"></a>00108         _tableView = aTableView;
<a name="l00109"></a>00109 
<a name="l00110"></a>00110     <span class="keywordflow">return</span> <span class="keyword">self</span>;
<a name="l00111"></a>00111 }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 - (void)drawRect:(CGRect)aRect
<a name="l00114"></a>00114 {
<a name="l00115"></a>00115     var <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a> = [<span class="keyword">self</span> frame],
<a name="l00116"></a>00116         context = [[<a class="code" href="interface_c_p_graphics_context.html">CPGraphicsContext</a> <a class="code" href="interface_c_p_graphics_context.html#a378dafc8fb951053dd6877fb45e87f61">currentContext</a>] <a class="code" href="interface_c_p_graphics_context.html#a92895bd939c04da463d02425bec83f0b">graphicsPort</a>];
<a name="l00117"></a>00117 
<a name="l00118"></a>00118     <a class="code" href="group__coregraphics.html#ga2351bbe153eb35f881d0de33de240e02">CGContextTranslateCTM</a>(context, -_CGRectGetMinX(<a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>), -_CGRectGetMinY(<a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>));
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     [_tableView _drawRect:aRect];
<a name="l00121"></a>00121 }
<a name="l00122"></a>00122 
<a name="l00123"></a>00123 <span class="keyword">@end</span>
<a name="l00124"></a>00124 
<a name="l00148"></a>00148 <span class="keyword">@implementation </span><a class="code" href="interface_c_p_table_view.html">CPTableView</a> : <a class="code" href="interface_c_p_control.html">CPControl</a>
<a name="l00149"></a>00149 {
<a name="l00150"></a>00150     <span class="keywordtype">id</span>                  _dataSource;
<a name="l00151"></a>00151     CPInteger           _implementedDataSourceMethods;
<a name="l00152"></a>00152 
<a name="l00153"></a>00153     <span class="keywordtype">id</span>                  _delegate;
<a name="l00154"></a>00154     CPInteger           _implementedDelegateMethods;
<a name="l00155"></a>00155 
<a name="l00156"></a>00156     <a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>             _tableColumns;
<a name="l00157"></a>00157     <a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>             _tableColumnRanges;
<a name="l00158"></a>00158     CPInteger           _dirtyTableColumnRangeIndex;
<a name="l00159"></a>00159     CPInteger           _numberOfHiddenColumns;
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     BOOL                _reloadAllRows;
<a name="l00162"></a>00162     Object              _objectValues;
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     CGRect              _exposedRect;
<a name="l00165"></a>00165     <a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>          _exposedRows;
<a name="l00166"></a>00166     <a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>          _exposedColumns;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168     Object              _dataViewsForTableColumns;
<a name="l00169"></a>00169     Object              _cachedDataViews;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171     <span class="comment">//Configuring Behavior</span>
<a name="l00172"></a>00172     BOOL                _allowsColumnReordering;
<a name="l00173"></a>00173     BOOL                _allowsColumnResizing;
<a name="l00174"></a>00174     BOOL                _allowsColumnSelection;
<a name="l00175"></a>00175     BOOL                _allowsMultipleSelection;
<a name="l00176"></a>00176     BOOL                _allowsEmptySelection;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178     <a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>             _sortDescriptors;
<a name="l00179"></a>00179 
<a name="l00180"></a>00180     <span class="comment">//Setting Display Attributes</span>
<a name="l00181"></a>00181     CGSize              _intercellSpacing;
<a name="l00182"></a>00182     <span class="keywordtype">float</span>               _rowHeight;
<a name="l00183"></a>00183 
<a name="l00184"></a>00184     BOOL                _usesAlternatingRowBackgroundColors;
<a name="l00185"></a>00185     <a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>             _alternatingRowBackgroundColors;
<a name="l00186"></a>00186 
<a name="l00187"></a>00187     <span class="keywordtype">unsigned</span>            _selectionHighlightStyle;
<a name="l00188"></a>00188     <a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>       _currentHighlightedTableColumn;
<a name="l00189"></a>00189     <span class="keywordtype">unsigned</span>            _gridStyleMask;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191     <span class="keywordtype">unsigned</span>            _numberOfRows;
<a name="l00192"></a>00192     <a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>          _groupRows;
<a name="l00193"></a>00193 
<a name="l00194"></a>00194     <a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>             _cachedRowHeights;
<a name="l00195"></a>00195 
<a name="l00196"></a>00196     <span class="comment">// Persistence</span>
<a name="l00197"></a>00197     <a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>            _autosaveName;
<a name="l00198"></a>00198     BOOL                _autosaveTableColumns;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <a class="code" href="interface_c_p_table_header_view.html">CPTableHeaderView</a>   _headerView;
<a name="l00201"></a>00201     _CPCornerView       _cornerView;
<a name="l00202"></a>00202 
<a name="l00203"></a>00203     <a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>          _selectedColumnIndexes;
<a name="l00204"></a>00204     <a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>          _selectedRowIndexes;
<a name="l00205"></a>00205     CPInteger           _selectionAnchorRow;
<a name="l00206"></a>00206     CPInteger           _lastSelectedRow;
<a name="l00207"></a>00207     <a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>          _previouslySelectedRowIndexes;
<a name="l00208"></a>00208     CGPoint             _startTrackingPoint;
<a name="l00209"></a>00209     <a class="code" href="interface_c_p_date.html" title="A representation of a single point in time.">CPDate</a>              _startTrackingTimestamp;
<a name="l00210"></a>00210     BOOL                _trackingPointMovedOutOfClickSlop;
<a name="l00211"></a>00211     CGPoint             _editingCellIndex;
<a name="l00212"></a>00212 
<a name="l00213"></a>00213     _CPTableDrawView    _tableDrawView;
<a name="l00214"></a>00214 
<a name="l00215"></a>00215     <span class="keywordtype">SEL</span>                 _doubleAction;
<a name="l00216"></a>00216     CPInteger           _clickedRow;
<a name="l00217"></a>00217     <span class="keywordtype">unsigned</span>            _columnAutoResizingStyle;
<a name="l00218"></a>00218 
<a name="l00219"></a>00219     <span class="keywordtype">int</span>                 _lastTrackedRowIndex;
<a name="l00220"></a>00220     CGPoint             _originalMouseDownPoint;
<a name="l00221"></a>00221     BOOL                _verticalMotionCanDrag;
<a name="l00222"></a>00222     <span class="keywordtype">unsigned</span>            _destinationDragStyle;
<a name="l00223"></a>00223     BOOL                _isSelectingSession;
<a name="l00224"></a>00224     <a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>          _draggedRowIndexes;
<a name="l00225"></a>00225     BOOL                _wasSelectionBroken;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227     _CPDropOperationDrawingView _dropOperationFeedbackView;
<a name="l00228"></a>00228     CPDragOperation     _dragOperationDefaultMask;
<a name="l00229"></a>00229     <span class="keywordtype">int</span>                 _retargetedDropRow;
<a name="l00230"></a>00230     CPDragOperation     _retargetedDropOperation;
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     BOOL                _disableAutomaticResizing;
<a name="l00233"></a>00233     BOOL                _lastColumnShouldSnap;
<a name="l00234"></a>00234     BOOL                _implementsCustomDrawRow;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236     <a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>       _draggedColumn;
<a name="l00237"></a>00237     <a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>             _differedColumnDataToRemove;
<a name="l00238"></a>00238 }
<a name="l00239"></a>00239 
<a name="l00243"></a><a class="code" href="interface_c_p_table_view.html#a81b5265425a8e9b2b928e61f85c76d5c">00243</a> + (<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)defaultThemeClass
<a name="l00244"></a>00244 {
<a name="l00245"></a>00245     <span class="keywordflow">return</span> <span class="stringliteral">@&quot;tableview&quot;</span>;
<a name="l00246"></a>00246 }
<a name="l00247"></a>00247 
<a name="l00251"></a><a class="code" href="interface_c_p_table_view.html#aa8cb633ed30475eae338d9e859bb237b">00251</a> + (id)themeAttributes
<a name="l00252"></a>00252 {
<a name="l00253"></a>00253     <span class="keywordflow">return</span> [<a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection.">CPDictionary</a> <a class="code" href="interface_c_p_dictionary.html#ac4d7617692c892eaed4d00de281c4c83">dictionaryWithObjects</a>:[[<a class="code" href="class_c_p_null.html" title="An object representation of nil.">CPNull</a> <a class="code" href="class_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>], [<a class="code" href="class_c_p_null.html" title="An object representation of nil.">CPNull</a> <a class="code" href="class_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>], [<a class="code" href="class_c_p_null.html" title="An object representation of nil.">CPNull</a> <a class="code" href="class_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>], [<a class="code" href="class_c_p_null.html" title="An object representation of nil.">CPNull</a> <a class="code" href="class_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>], [<a class="code" href="class_c_p_null.html" title="An object representation of nil.">CPNull</a> <a class="code" href="class_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>], [<a class="code" href="class_c_p_null.html" title="An object representation of nil.">CPNull</a> <a class="code" href="class_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>], [<a class="code" href="class_c_p_null.html" title="An object representation of nil.">CPNull</a> <a class="code" href="class_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>]]
<a name="l00254"></a>00254                                        <a class="code" href="interface_c_p_dictionary.html#ac4d7617692c892eaed4d00de281c4c83">forKeys</a>:[&quot;alternating-row-colors&quot;, &quot;grid-color&quot;, &quot;highlighted-grid-color&quot;, &quot;selection-color&quot;, &quot;sourcelist-selection-color&quot;, &quot;sort-image&quot;, &quot;sort-image-reversed&quot;]];
<a name="l00255"></a>00255 }
<a name="l00256"></a>00256 
<a name="l00257"></a><a class="code" href="interface_c_p_table_view.html#a989e49a95e3816cc201830e49965304a">00257</a> - (id)initWithFrame:(CGRect)aFrame
<a name="l00258"></a>00258 {
<a name="l00259"></a>00259     <span class="keyword">self</span> = [<span class="keyword">super</span> <a class="code" href="interface_c_p_control.html#a9fbb9581b79b7c03c97ca77b64c5f2f1">initWithFrame</a>:aFrame];
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     <span class="keywordflow">if</span> (<span class="keyword">self</span>)
<a name="l00262"></a>00262     {
<a name="l00263"></a>00263         <span class="comment">//Configuring Behavior</span>
<a name="l00264"></a>00264         _allowsColumnReordering = YES;
<a name="l00265"></a>00265         _allowsColumnResizing = YES;
<a name="l00266"></a>00266         _allowsMultipleSelection = NO;
<a name="l00267"></a>00267         _allowsEmptySelection = YES;
<a name="l00268"></a>00268         _allowsColumnSelection = NO;
<a name="l00269"></a>00269         _disableAutomaticResizing = NO;
<a name="l00270"></a>00270 
<a name="l00271"></a>00271         <span class="comment">//Setting Display Attributes</span>
<a name="l00272"></a>00272         _selectionHighlightStyle = <a class="code" href="_c_p_table_view_8j.html#aca8acc7a64967150badd9c4b7c6eedf9">CPTableViewSelectionHighlightStyleRegular</a>;
<a name="l00273"></a>00273 
<a name="l00274"></a>00274         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a6265d6d38253d8e95a112e226cdefe4d">setUsesAlternatingRowBackgroundColors</a>:NO];
<a name="l00275"></a>00275         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aa50e7802368fe0b0be6756beaa70fd71">setAlternatingRowBackgroundColors</a>:
<a name="l00276"></a>00276             [[<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#a713287464015f76e4359aeedc0110dc5">whiteColor</a>], [<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#a53e6bdd0c0cba190891d19dd30ac36f1">colorWithRed</a>:245.0 / 255.0 <a class="code" href="interface_c_p_color.html#a53e6bdd0c0cba190891d19dd30ac36f1">green</a>:249.0 / 255.0 <a class="code" href="interface_c_p_color.html#a53e6bdd0c0cba190891d19dd30ac36f1">blue</a>:252.0 / 255.0 <a class="code" href="interface_c_p_color.html#a53e6bdd0c0cba190891d19dd30ac36f1">alpha</a>:1.0]]];
<a name="l00277"></a>00277 
<a name="l00278"></a>00278         _tableColumns = [];
<a name="l00279"></a>00279         _tableColumnRanges = [];
<a name="l00280"></a>00280         _dirtyTableColumnRangeIndex = <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l00281"></a>00281         _numberOfHiddenColumns = 0;
<a name="l00282"></a>00282 
<a name="l00283"></a>00283         _intercellSpacing = _CGSizeMake(3.0, 2.0);
<a name="l00284"></a>00284         _rowHeight = 23.0;
<a name="l00285"></a>00285 
<a name="l00286"></a>00286         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a87d09099f126a8e7e741a192e05e10f7">setGridColor</a>:[<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#a80c4273ef2d3bb9cc836946de79c8a1e">colorWithHexString</a>:@&quot;dce0e2&quot;]];
<a name="l00287"></a>00287         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a10dc95485219186d423799fedac67efd">setGridStyleMask</a>:CPTableViewGridNone];
<a name="l00288"></a>00288 
<a name="l00289"></a>00289         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#ade4b1dc944f33bcdbb33699aaa2c52f3">setHeaderView</a>:[[<a class="code" href="interface_c_p_table_header_view.html">CPTableHeaderView</a> alloc] initWithFrame:_CGRectMake(0, 0, [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#af0bd55e12e5ac7ea4b137eae5f1829af">bounds</a>].size.width, _rowHeight)]];
<a name="l00290"></a>00290         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#ad6c2cf202a6c05de91e2e56fe7368811">setCornerView</a>:[[_CPCornerView alloc] initWithFrame:_CGRectMake(0, 0, [<a class="code" href="interface_c_p_scroller.html">CPScroller</a> <a class="code" href="interface_c_p_scroller.html#aa561236fe659f6ccd8f06f7c6755476e">scrollerWidth</a>], _CGRectGetHeight([_headerView frame]))]];
<a name="l00291"></a>00291 
<a name="l00292"></a>00292         _currentHighlightedTableColumn = nil;
<a name="l00293"></a>00293 
<a name="l00294"></a>00294         _draggedRowIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l00295"></a>00295         _verticalMotionCanDrag = YES;
<a name="l00296"></a>00296         _isSelectingSession = NO;
<a name="l00297"></a>00297         _retargetedDropRow = nil;
<a name="l00298"></a>00298         _retargetedDropOperation = nil;
<a name="l00299"></a>00299         _dragOperationDefaultMask = nil;
<a name="l00300"></a>00300         _destinationDragStyle = <a class="code" href="_c_p_table_view_8j.html#a4b9131f16846d5b2e77fbb2d855f48c1">CPTableViewDraggingDestinationFeedbackStyleRegular</a>;
<a name="l00301"></a>00301 
<a name="l00302"></a>00302         [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a70973147abbbf54e7149b266f18faaa3">setBackgroundColor</a>:[<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#a713287464015f76e4359aeedc0110dc5">whiteColor</a>]];
<a name="l00303"></a>00303         [<span class="keyword">self</span> _init];
<a name="l00304"></a>00304     }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306     <span class="keywordflow">return</span> <span class="keyword">self</span>;
<a name="l00307"></a>00307 }
<a name="l00308"></a>00308 
<a name="l00309"></a>00309 
<a name="l00315"></a>00315 - (void)_init
<a name="l00316"></a>00316 {
<a name="l00317"></a>00317     _tableViewFlags = 0;
<a name="l00318"></a>00318     _lastSelectedRow = -1;
<a name="l00319"></a>00319 
<a name="l00320"></a>00320     _selectedColumnIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l00321"></a>00321     _selectedRowIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l00322"></a>00322 
<a name="l00323"></a>00323     _dropOperationFeedbackView = [[_CPDropOperationDrawingView alloc] initWithFrame:_CGRectMakeZero()];
<a name="l00324"></a>00324     [_dropOperationFeedbackView setTableView:self];
<a name="l00325"></a>00325 
<a name="l00326"></a>00326     _lastColumnShouldSnap = NO;
<a name="l00327"></a>00327 
<a name="l00328"></a>00328     <span class="keywordflow">if</span> (!_alternatingRowBackgroundColors)
<a name="l00329"></a>00329         _alternatingRowBackgroundColors = [[<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#a713287464015f76e4359aeedc0110dc5">whiteColor</a>], [<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#a80c4273ef2d3bb9cc836946de79c8a1e">colorWithHexString</a>:@&quot;e4e7ff&quot;]];
<a name="l00330"></a>00330 
<a name="l00331"></a>00331     _selectionHighlightColor = [<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#a80c4273ef2d3bb9cc836946de79c8a1e">colorWithHexString</a>:@&quot;5f83b9&quot;];
<a name="l00332"></a>00332 
<a name="l00333"></a>00333     _tableColumnRanges = [];
<a name="l00334"></a>00334     _dirtyTableColumnRangeIndex = 0;
<a name="l00335"></a>00335     _numberOfHiddenColumns = 0;
<a name="l00336"></a>00336 
<a name="l00337"></a>00337     _objectValues = { };
<a name="l00338"></a>00338     _dataViewsForTableColumns = { };
<a name="l00339"></a>00339     _dataViews =  [];
<a name="l00340"></a>00340     _numberOfRows = 0;
<a name="l00341"></a>00341     _exposedRows = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l00342"></a>00342     _exposedColumns = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l00343"></a>00343     _cachedDataViews = { };
<a name="l00344"></a>00344     _cachedRowHeights = [];
<a name="l00345"></a>00345 
<a name="l00346"></a>00346     _groupRows = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l00347"></a>00347 
<a name="l00348"></a>00348     _tableDrawView = [[_CPTableDrawView alloc] initWithTableView:self];
<a name="l00349"></a>00349     [_tableDrawView setBackgroundColor:[<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#a89743805aa7a7ab79df291661fc4a736">clearColor</a>]];
<a name="l00350"></a>00350     [<span class="keyword">self</span> addSubview:_tableDrawView];
<a name="l00351"></a>00351 
<a name="l00352"></a>00352     _draggedColumn = nil;
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 <span class="comment">/*      //gradients for the source list when CPTableView is NOT first responder or the window is NOT key</span>
<a name="l00355"></a>00355 <span class="comment">    // FIX ME: we need to actually implement this.</span>
<a name="l00356"></a>00356 <span class="comment">    _sourceListInactiveGradient = CGGradientCreateWithColorComponents(CGColorSpaceCreateDeviceRGB(), [168.0/255.0,183.0/255.0,205.0/255.0,1.0,157.0/255.0,174.0/255.0,199.0/255.0,1.0], [0,1], 2);</span>
<a name="l00357"></a>00357 <span class="comment">    _sourceListInactiveTopLineColor = [CPColor colorWithCalibratedRed:(173.0/255.0) green:(187.0/255.0) blue:(209.0/255.0) alpha:1.0];</span>
<a name="l00358"></a>00358 <span class="comment">    _sourceListInactiveBottomLineColor = [CPColor colorWithCalibratedRed:(150.0/255.0) green:(161.0/255.0) blue:(183.0/255.0) alpha:1.0];*/</span>
<a name="l00359"></a>00359     _differedColumnDataToRemove = [];
<a name="l00360"></a>00360     _implementsCustomDrawRow = [<span class="keyword">self</span> implementsSelector:@selector(drawRow:clipRect:)];
<a name="l00361"></a>00361 
<a name="l00362"></a>00362     <span class="keywordflow">if</span> (!_sortDescriptors)
<a name="l00363"></a>00363         _sortDescriptors = [];
<a name="l00364"></a>00364 }
<a name="l00365"></a>00365 
<a name="l00431"></a><a class="code" href="interface_c_p_table_view.html#a13b891524111eeb3c8873a789df3cb6a">00431</a> - (void)setDataSource:(<span class="keywordtype">id</span>)aDataSource
<a name="l00432"></a>00432 {
<a name="l00433"></a>00433     <span class="keywordflow">if</span> (_dataSource === aDataSource)
<a name="l00434"></a>00434         <span class="keywordflow">return</span>;
<a name="l00435"></a>00435 
<a name="l00436"></a>00436     _dataSource = aDataSource;
<a name="l00437"></a>00437     _implementedDataSourceMethods = 0;
<a name="l00438"></a>00438 
<a name="l00439"></a>00439     <span class="keywordflow">if</span> (!_dataSource)
<a name="l00440"></a>00440         <span class="keywordflow">return</span>;
<a name="l00441"></a>00441 
<a name="l00442"></a>00442     var hasContentBinding = !![<span class="keyword">self</span> <a class="code" href="class_c_p_object.html#a78aa766bf03851ddd6db2be8a96ab1cb">infoForBinding</a>:@&quot;content&quot;];
<a name="l00443"></a>00443 
<a name="l00444"></a>00444     <span class="keywordflow">if</span> ([_dataSource respondsToSelector:<span class="keyword">@selector</span>(numberOfRowsInTableView:)])
<a name="l00445"></a>00445         _implementedDataSourceMethods |= <a class="code" href="_c_p_table_view_8j.html#a79c288910d3f547d5433a6946cec05bc">CPTableViewDataSource_numberOfRowsInTableView_</a>;
<a name="l00446"></a>00446 
<a name="l00447"></a>00447     <span class="keywordflow">if</span> ([_dataSource respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:objectValueForTableColumn:row:)])
<a name="l00448"></a>00448         _implementedDataSourceMethods |= <a class="code" href="_c_p_table_view_8j.html#a23288f0ff7ed53d22d474f4248c733b1">CPTableViewDataSource_tableView_objectValueForTableColumn_row_</a>;
<a name="l00449"></a>00449 
<a name="l00450"></a>00450     <span class="keywordflow">if</span> ([_dataSource respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:setObjectValue:forTableColumn:row:)])
<a name="l00451"></a>00451         _implementedDataSourceMethods |= <a class="code" href="_c_p_table_view_8j.html#a9f25c28df39dca590ad108beb6b4b48b">CPTableViewDataSource_tableView_setObjectValue_forTableColumn_row_</a>;
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     <span class="keywordflow">if</span> ([_dataSource respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:acceptDrop:row:dropOperation:)])
<a name="l00454"></a>00454         _implementedDataSourceMethods |= <a class="code" href="_c_p_table_view_8j.html#a71f4aae1a37e8503f63542e1d977edce">CPTableViewDataSource_tableView_acceptDrop_row_dropOperation_</a>;
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     <span class="keywordflow">if</span> ([_dataSource respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:namesOfPromisedFilesDroppedAtDestination:forDraggedRowsWithIndexes:)])
<a name="l00457"></a>00457         _implementedDataSourceMethods |= <a class="code" href="_c_p_table_view_8j.html#a70eaee52bd8ae42e829dc246bfffa90f">CPTableViewDataSource_tableView_namesOfPromisedFilesDroppedAtDestination_forDraggedRowsWithIndexes_</a>;
<a name="l00458"></a>00458 
<a name="l00459"></a>00459     <span class="keywordflow">if</span> ([_dataSource respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:validateDrop:proposedRow:proposedDropOperation:)])
<a name="l00460"></a>00460         _implementedDataSourceMethods |= <a class="code" href="_c_p_table_view_8j.html#a4f6917aa9754d8c13c933ae043ca4963">CPTableViewDataSource_tableView_validateDrop_proposedRow_proposedDropOperation_</a>;
<a name="l00461"></a>00461 
<a name="l00462"></a>00462     <span class="keywordflow">if</span> ([_dataSource respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:writeRowsWithIndexes:toPasteboard:)])
<a name="l00463"></a>00463         _implementedDataSourceMethods |= <a class="code" href="_c_p_table_view_8j.html#a3fb0a731ef8cca0484830f426bcbe81f">CPTableViewDataSource_tableView_writeRowsWithIndexes_toPasteboard_</a>;
<a name="l00464"></a>00464 
<a name="l00465"></a>00465     <span class="keywordflow">if</span> ([_dataSource respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:sortDescriptorsDidChange:)])
<a name="l00466"></a>00466         _implementedDataSourceMethods |= <a class="code" href="_c_p_table_view_8j.html#a3270c812883a130ed7efbc0f119a8ec7">CPTableViewDataSource_tableView_sortDescriptorsDidChange_</a>;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a25ec67f805f6a97b91879cb04933310e">reloadData</a>];
<a name="l00469"></a>00469 }
<a name="l00470"></a>00470 
<a name="l00474"></a><a class="code" href="interface_c_p_table_view.html#a95b4de8f3494b67946e65f9cc914bd63">00474</a> - (id)dataSource
<a name="l00475"></a>00475 {
<a name="l00476"></a>00476     <span class="keywordflow">return</span> _dataSource;
<a name="l00477"></a>00477 }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479 <span class="comment">//Loading Data</span>
<a name="l00480"></a>00480 
<a name="l00486"></a><a class="code" href="interface_c_p_table_view.html#a69ae01655437f565b3f51bd2805fe68a">00486</a> - (void)reloadDataForRowIndexes:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)rowIndexes columnIndexes:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)columnIndexes
<a name="l00487"></a>00487 {
<a name="l00488"></a>00488     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a25ec67f805f6a97b91879cb04933310e">reloadData</a>];
<a name="l00489"></a>00489 <span class="comment">//    [_previouslyExposedRows removeIndexes:rowIndexes];</span>
<a name="l00490"></a>00490 <span class="comment">//    [_previouslyExposedColumns removeIndexes:columnIndexes];</span>
<a name="l00491"></a>00491 }
<a name="l00492"></a>00492 
<a name="l00496"></a><a class="code" href="interface_c_p_table_view.html#a25ec67f805f6a97b91879cb04933310e">00496</a> - (void)reloadData
<a name="l00497"></a>00497 {
<a name="l00498"></a>00498     <span class="comment">//if (!_dataSource)</span>
<a name="l00499"></a>00499     <span class="comment">//    return;</span>
<a name="l00500"></a>00500 
<a name="l00501"></a>00501     _reloadAllRows = YES;
<a name="l00502"></a>00502     _objectValues = { };
<a name="l00503"></a>00503     _cachedRowHeights = [];
<a name="l00504"></a>00504 
<a name="l00505"></a>00505     <span class="comment">// Otherwise, if we have a row marked as group with a</span>
<a name="l00506"></a>00506     <span class="comment">// index greater than the new number or rows</span>
<a name="l00507"></a>00507     <span class="comment">// it keeps the the graphical group style.</span>
<a name="l00508"></a>00508     [_groupRows removeAllIndexes];
<a name="l00509"></a>00509 
<a name="l00510"></a>00510     <span class="comment">// This updates the size too.</span>
<a name="l00511"></a>00511     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aa1b1194b660a264c3c330892e4f4ffe4">noteNumberOfRowsChanged</a>];
<a name="l00512"></a>00512 
<a name="l00513"></a>00513     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a39431c7a00864c9ddfe57c191fd82ccf">setNeedsLayout</a>];
<a name="l00514"></a>00514     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a31af19dc321476a95414cd5e5da60ef0">setNeedsDisplay</a>:YES];
<a name="l00515"></a>00515 }
<a name="l00516"></a>00516 
<a name="l00517"></a>00517 <span class="comment">//Target-action Behavior</span>
<a name="l00524"></a><a class="code" href="interface_c_p_table_view.html#a0b5806376d8b3bd70908606b9f033967">00524</a> <span class="comment"></span>- (void)setDoubleAction:(<span class="keywordtype">SEL</span>)anAction
<a name="l00525"></a>00525 {
<a name="l00526"></a>00526     _doubleAction = anAction;
<a name="l00527"></a>00527 }
<a name="l00528"></a>00528 
<a name="l00532"></a><a class="code" href="interface_c_p_table_view.html#a88e1bd1cff9f5263bbf63e70fe072590">00532</a> - (SEL)doubleAction
<a name="l00533"></a>00533 {
<a name="l00534"></a>00534     <span class="keywordflow">return</span> _doubleAction;
<a name="l00535"></a>00535 }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 <span class="comment">/*</span>
<a name="l00538"></a>00538 <span class="comment">    * - clickedColumn</span>
<a name="l00539"></a>00539 <span class="comment">*/</span>
<a name="l00540"></a>00540 
<a name="l00544"></a><a class="code" href="interface_c_p_table_view.html#abbefdb91b142a102b886bc6b1081590b">00544</a> - (CPInteger)clickedRow
<a name="l00545"></a>00545 {
<a name="l00546"></a>00546     <span class="keywordflow">return</span> _clickedRow;
<a name="l00547"></a>00547 }
<a name="l00548"></a>00548 
<a name="l00549"></a>00549 <span class="comment">//Configuring Behavior</span>
<a name="l00550"></a>00550 
<a name="l00554"></a><a class="code" href="interface_c_p_table_view.html#ac51162f8f381b09f8d5675f93f20dc3e">00554</a> - (void)setAllowsColumnReordering:(BOOL)shouldAllowColumnReordering
<a name="l00555"></a>00555 {
<a name="l00556"></a>00556     _allowsColumnReordering = !!shouldAllowColumnReordering;
<a name="l00557"></a>00557 }
<a name="l00558"></a>00558 
<a name="l00562"></a><a class="code" href="interface_c_p_table_view.html#aafea3a20010fe56053976716aefd3e23">00562</a> - (BOOL)allowsColumnReordering
<a name="l00563"></a>00563 {
<a name="l00564"></a>00564     <span class="keywordflow">return</span> _allowsColumnReordering;
<a name="l00565"></a>00565 }
<a name="l00566"></a>00566 
<a name="l00571"></a><a class="code" href="interface_c_p_table_view.html#a2d6fa30d3c1e3ca05fb35c0a3399936b">00571</a> - (void)setAllowsColumnResizing:(BOOL)shouldAllowColumnResizing
<a name="l00572"></a>00572 {
<a name="l00573"></a>00573     _allowsColumnResizing = !!shouldAllowColumnResizing;
<a name="l00574"></a>00574 }
<a name="l00575"></a>00575 
<a name="l00579"></a><a class="code" href="interface_c_p_table_view.html#aff343b53a8899d41f057c9cc83623246">00579</a> - (BOOL)allowsColumnResizing
<a name="l00580"></a>00580 {
<a name="l00581"></a>00581     <span class="keywordflow">return</span> _allowsColumnResizing;
<a name="l00582"></a>00582 }
<a name="l00583"></a>00583 
<a name="l00588"></a><a class="code" href="interface_c_p_table_view.html#a686ac257cf5af1e68814683a8221bc73">00588</a> - (void)setAllowsMultipleSelection:(BOOL)shouldAllowMultipleSelection
<a name="l00589"></a>00589 {
<a name="l00590"></a>00590     _allowsMultipleSelection = !!shouldAllowMultipleSelection;
<a name="l00591"></a>00591 }
<a name="l00592"></a>00592 
<a name="l00598"></a><a class="code" href="interface_c_p_table_view.html#aabfd101c3912b0326c6c3771f6b7563f">00598</a> - (BOOL)allowsMultipleSelection
<a name="l00599"></a>00599 {
<a name="l00600"></a>00600     <span class="keywordflow">return</span> _allowsMultipleSelection;
<a name="l00601"></a>00601 }
<a name="l00602"></a>00602 
<a name="l00607"></a><a class="code" href="interface_c_p_table_view.html#af021ea8b8110ac3546501724d00e5310">00607</a> - (void)setAllowsEmptySelection:(BOOL)shouldAllowEmptySelection
<a name="l00608"></a>00608 {
<a name="l00609"></a>00609     _allowsEmptySelection = !!shouldAllowEmptySelection;
<a name="l00610"></a>00610 }
<a name="l00611"></a>00611 
<a name="l00615"></a><a class="code" href="interface_c_p_table_view.html#a2564b452a1cc98317407513f15853a0b">00615</a> - (BOOL)allowsEmptySelection
<a name="l00616"></a>00616 {
<a name="l00617"></a>00617     <span class="keywordflow">return</span> _allowsEmptySelection;
<a name="l00618"></a>00618 }
<a name="l00619"></a>00619 
<a name="l00625"></a><a class="code" href="interface_c_p_table_view.html#aabe3fb9faaa638fdc941544fca72c7f3">00625</a> - (void)setAllowsColumnSelection:(BOOL)shouldAllowColumnSelection
<a name="l00626"></a>00626 {
<a name="l00627"></a>00627     _allowsColumnSelection = !!shouldAllowColumnSelection;
<a name="l00628"></a>00628 }
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 
<a name="l00634"></a><a class="code" href="interface_c_p_table_view.html#ac26501a6db564b0ff7c3574f6fa675ae">00634</a> - (BOOL)allowsColumnSelection
<a name="l00635"></a>00635 {
<a name="l00636"></a>00636     <span class="keywordflow">return</span> _allowsColumnSelection;
<a name="l00637"></a>00637 }
<a name="l00638"></a>00638 
<a name="l00639"></a>00639 <span class="comment">//Setting Display Attributes</span>
<a name="l00646"></a><a class="code" href="interface_c_p_table_view.html#ae865cae60edeccb26435c710eb6198b9">00646</a> <span class="comment"></span>- (void)setIntercellSpacing:(CGSize)aSize
<a name="l00647"></a>00647 {
<a name="l00648"></a>00648     <span class="keywordflow">if</span> (_CGSizeEqualToSize(_intercellSpacing, aSize))
<a name="l00649"></a>00649         <span class="keywordflow">return</span>;
<a name="l00650"></a>00650 
<a name="l00651"></a>00651     _intercellSpacing = _CGSizeMakeCopy(aSize);
<a name="l00652"></a>00652 
<a name="l00653"></a>00653     _dirtyTableColumnRangeIndex = 0; <span class="comment">// so that _recalculateTableColumnRanges will work</span>
<a name="l00654"></a>00654     [<span class="keyword">self</span> _recalculateTableColumnRanges];
<a name="l00655"></a>00655 
<a name="l00656"></a>00656     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a39431c7a00864c9ddfe57c191fd82ccf">setNeedsLayout</a>];
<a name="l00657"></a>00657     [_headerView setNeedsDisplay:YES];
<a name="l00658"></a>00658     [_headerView setNeedsLayout];
<a name="l00659"></a>00659 
<a name="l00660"></a>00660     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a25ec67f805f6a97b91879cb04933310e">reloadData</a>];
<a name="l00661"></a>00661 }
<a name="l00662"></a>00662 
<a name="l00666"></a><a class="code" href="interface_c_p_table_view.html#afc5c31281c6039f4f36f5b156152f98b">00666</a> - (CGSize)intercellSpacing
<a name="l00667"></a>00667 {
<a name="l00668"></a>00668     <span class="keywordflow">return</span> _CGSizeMakeCopy(_intercellSpacing);
<a name="l00669"></a>00669 }
<a name="l00670"></a>00670 
<a name="l00677"></a><a class="code" href="interface_c_p_table_view.html#a81cdb48fa8ad23cbab2f9ed44f6ff172">00677</a> - (void)setRowHeight:(<span class="keywordtype">unsigned</span>)aRowHeight
<a name="l00678"></a>00678 {
<a name="l00679"></a>00679     aRowHeight = +aRowHeight;
<a name="l00680"></a>00680 
<a name="l00681"></a>00681     <span class="keywordflow">if</span> (_rowHeight === aRowHeight)
<a name="l00682"></a>00682         <span class="keywordflow">return</span>;
<a name="l00683"></a>00683 
<a name="l00684"></a>00684     _rowHeight = MAX(0.0, aRowHeight);
<a name="l00685"></a>00685 
<a name="l00686"></a>00686     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a39431c7a00864c9ddfe57c191fd82ccf">setNeedsLayout</a>];
<a name="l00687"></a>00687 }
<a name="l00688"></a>00688 
<a name="l00692"></a><a class="code" href="interface_c_p_table_view.html#a37b1a549fa54390fd5c824fc2a405122">00692</a> - (unsigned)rowHeight
<a name="l00693"></a>00693 {
<a name="l00694"></a>00694     <span class="keywordflow">return</span> _rowHeight;
<a name="l00695"></a>00695 }
<a name="l00696"></a>00696 
<a name="l00702"></a><a class="code" href="interface_c_p_table_view.html#a6265d6d38253d8e95a112e226cdefe4d">00702</a> - (void)setUsesAlternatingRowBackgroundColors:(BOOL)shouldUseAlternatingRowBackgroundColors
<a name="l00703"></a>00703 {
<a name="l00704"></a>00704     _usesAlternatingRowBackgroundColors = shouldUseAlternatingRowBackgroundColors;
<a name="l00705"></a>00705 }
<a name="l00706"></a>00706 
<a name="l00710"></a><a class="code" href="interface_c_p_table_view.html#a10754c93019a092e554c07ac969adf59">00710</a> - (BOOL)usesAlternatingRowBackgroundColors
<a name="l00711"></a>00711 {
<a name="l00712"></a>00712     <span class="keywordflow">return</span> _usesAlternatingRowBackgroundColors;
<a name="l00713"></a>00713 }
<a name="l00714"></a>00714 
<a name="l00720"></a><a class="code" href="interface_c_p_table_view.html#aa50e7802368fe0b0be6756beaa70fd71">00720</a> - (void)setAlternatingRowBackgroundColors:(<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>)alternatingRowBackgroundColors
<a name="l00721"></a>00721 {
<a name="l00722"></a>00722     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a1706dcb83afd559e12da0f8c71fcd53a">setValue</a>:alternatingRowBackgroundColors <a class="code" href="interface_c_p_view.html#a1706dcb83afd559e12da0f8c71fcd53a">forThemeAttribute</a>:&quot;alternating-row-colors&quot;];
<a name="l00723"></a>00723 
<a name="l00724"></a>00724     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a31af19dc321476a95414cd5e5da60ef0">setNeedsDisplay</a>:YES];
<a name="l00725"></a>00725 }
<a name="l00726"></a>00726 
<a name="l00730"></a><a class="code" href="interface_c_p_table_view.html#aa31301940f52f185b7905f89a17e9bc1">00730</a> - (<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>)alternatingRowBackgroundColors
<a name="l00731"></a>00731 {
<a name="l00732"></a>00732     <span class="keywordflow">return</span> [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a717c1679a7ef9b6b9b9976153a74dc5e">currentValueForThemeAttribute</a>:@&quot;alternating-row-colors&quot;];
<a name="l00733"></a>00733 }
<a name="l00734"></a>00734 
<a name="l00746"></a><a class="code" href="interface_c_p_table_view.html#afb36a911c32b6b31152cbb458feebc3b">00746</a> - (unsigned)selectionHighlightStyle
<a name="l00747"></a>00747 {
<a name="l00748"></a>00748     <span class="keywordflow">return</span> _selectionHighlightStyle;
<a name="l00749"></a>00749 }
<a name="l00750"></a>00750 
<a name="l00762"></a><a class="code" href="interface_c_p_table_view.html#af68f68ebb5944d09c7b999d124aebd97">00762</a> - (void)setSelectionHighlightStyle:(<span class="keywordtype">unsigned</span>)aSelectionHighlightStyle
<a name="l00763"></a>00763 {
<a name="l00764"></a>00764     <span class="comment">//early return for IE.</span>
<a name="l00765"></a>00765     <span class="keywordflow">if</span> (aSelectionHighlightStyle == <a class="code" href="_c_p_table_view_8j.html#a9b1494c16eb023b6a546dc0fb584fce7">CPTableViewSelectionHighlightStyleSourceList</a> &amp;&amp; !<a class="code" href="_c_p_compatibility_8j.html#a1fbfe7ca6b2cef354ecfe78f6cfd6659">CPFeatureIsCompatible</a>(<a class="code" href="_c_p_compatibility_8j.html#a3665bae1ce94c5c2c3d9e65fb78d0f15">CPHTMLCanvasFeature</a>))
<a name="l00766"></a>00766         <span class="keywordflow">return</span>;
<a name="l00767"></a>00767 
<a name="l00768"></a>00768     _selectionHighlightStyle = aSelectionHighlightStyle;
<a name="l00769"></a>00769     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a31af19dc321476a95414cd5e5da60ef0">setNeedsDisplay</a>:YES];
<a name="l00770"></a>00770 
<a name="l00771"></a>00771     <span class="keywordflow">if</span> (aSelectionHighlightStyle === <a class="code" href="_c_p_table_view_8j.html#a9b1494c16eb023b6a546dc0fb584fce7">CPTableViewSelectionHighlightStyleSourceList</a>)
<a name="l00772"></a>00772         _destinationDragStyle = <a class="code" href="_c_p_table_view_8j.html#a5c1e1977569dc9ea54f519916529114b">CPTableViewDraggingDestinationFeedbackStyleSourceList</a>;
<a name="l00773"></a>00773     <span class="keywordflow">else</span>
<a name="l00774"></a>00774         _destinationDragStyle = <a class="code" href="_c_p_table_view_8j.html#a4b9131f16846d5b2e77fbb2d855f48c1">CPTableViewDraggingDestinationFeedbackStyleRegular</a>;
<a name="l00775"></a>00775 }
<a name="l00776"></a>00776 
<a name="l00782"></a><a class="code" href="interface_c_p_table_view.html#a5f2f774a6cf944e13a927e4577109e3a">00782</a> - (void)setSelectionHighlightColor:(<a class="code" href="interface_c_p_color.html">CPColor</a>)aColor
<a name="l00783"></a>00783 {
<a name="l00784"></a>00784     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a1706dcb83afd559e12da0f8c71fcd53a">setValue</a>:aColor <a class="code" href="interface_c_p_view.html#a1706dcb83afd559e12da0f8c71fcd53a">forThemeAttribute</a>:&quot;selection-color&quot;];
<a name="l00785"></a>00785 
<a name="l00786"></a>00786     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a31af19dc321476a95414cd5e5da60ef0">setNeedsDisplay</a>:YES];
<a name="l00787"></a>00787 }
<a name="l00788"></a>00788 
<a name="l00792"></a><a class="code" href="interface_c_p_table_view.html#ad7269481be5a77cb295ec2328d8576df">00792</a> - (<a class="code" href="interface_c_p_color.html">CPColor</a>)selectionHighlightColor
<a name="l00793"></a>00793 {
<a name="l00794"></a>00794     <span class="keywordflow">return</span> [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a717c1679a7ef9b6b9b9976153a74dc5e">currentValueForThemeAttribute</a>:@&quot;selection-color&quot;];
<a name="l00795"></a>00795 }
<a name="l00796"></a>00796 
<a name="l00808"></a><a class="code" href="interface_c_p_table_view.html#a71e1f5aa747523569a463f5dbe9afdac">00808</a> - (void)setSelectionGradientColors:(<a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection.">CPDictionary</a>)aDictionary
<a name="l00809"></a>00809 {
<a name="l00810"></a>00810     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a1706dcb83afd559e12da0f8c71fcd53a">setValue</a>:aDictionary <a class="code" href="interface_c_p_view.html#a1706dcb83afd559e12da0f8c71fcd53a">forThemeAttribute</a>:&quot;sourcelist-selection-color&quot;];
<a name="l00811"></a>00811 
<a name="l00812"></a>00812     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a31af19dc321476a95414cd5e5da60ef0">setNeedsDisplay</a>:YES];
<a name="l00813"></a>00813 }
<a name="l00814"></a>00814 
<a name="l00823"></a><a class="code" href="interface_c_p_table_view.html#a6a923296245546e44a0c25f7709a1285">00823</a> - (<a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection.">CPDictionary</a>)selectionGradientColors
<a name="l00824"></a>00824 {
<a name="l00825"></a>00825     <span class="keywordflow">return</span> [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a717c1679a7ef9b6b9b9976153a74dc5e">currentValueForThemeAttribute</a>:@&quot;sourcelist-selection-color&quot;];
<a name="l00826"></a>00826 }
<a name="l00827"></a>00827 
<a name="l00832"></a><a class="code" href="interface_c_p_table_view.html#a87d09099f126a8e7e741a192e05e10f7">00832</a> - (void)setGridColor:(<a class="code" href="interface_c_p_color.html">CPColor</a>)aColor
<a name="l00833"></a>00833 {
<a name="l00834"></a>00834     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a1706dcb83afd559e12da0f8c71fcd53a">setValue</a>:aColor <a class="code" href="interface_c_p_view.html#a1706dcb83afd559e12da0f8c71fcd53a">forThemeAttribute</a>:&quot;grid-color&quot;];
<a name="l00835"></a>00835 
<a name="l00836"></a>00836     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a31af19dc321476a95414cd5e5da60ef0">setNeedsDisplay</a>:YES];
<a name="l00837"></a>00837 }
<a name="l00838"></a>00838 
<a name="l00842"></a><a class="code" href="interface_c_p_table_view.html#a23c390780203dd17c0593b269b705814">00842</a> - (<a class="code" href="interface_c_p_color.html">CPColor</a>)gridColor
<a name="l00843"></a>00843 {
<a name="l00844"></a>00844     <span class="keywordflow">return</span> [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a717c1679a7ef9b6b9b9976153a74dc5e">currentValueForThemeAttribute</a>:@&quot;grid-color&quot;];;
<a name="l00845"></a>00845 }
<a name="l00846"></a>00846 
<a name="l00852"></a><a class="code" href="interface_c_p_table_view.html#a10dc95485219186d423799fedac67efd">00852</a> - (void)setGridStyleMask:(<span class="keywordtype">unsigned</span>)aGrideStyleMask
<a name="l00853"></a>00853 {
<a name="l00854"></a>00854     <span class="keywordflow">if</span> (_gridStyleMask === aGrideStyleMask)
<a name="l00855"></a>00855         <span class="keywordflow">return</span>;
<a name="l00856"></a>00856 
<a name="l00857"></a>00857     _gridStyleMask = aGrideStyleMask;
<a name="l00858"></a>00858 
<a name="l00859"></a>00859     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a31af19dc321476a95414cd5e5da60ef0">setNeedsDisplay</a>:YES];
<a name="l00860"></a>00860 }
<a name="l00861"></a>00861 
<a name="l00865"></a><a class="code" href="interface_c_p_table_view.html#a9b133d62d7aba9a887f38e686627e160">00865</a> - (unsigned)gridStyleMask
<a name="l00866"></a>00866 {
<a name="l00867"></a>00867     <span class="keywordflow">return</span> _gridStyleMask;
<a name="l00868"></a>00868 }
<a name="l00869"></a>00869 
<a name="l00870"></a>00870 <span class="comment">//Column Management</span>
<a name="l00871"></a>00871 
<a name="l00876"></a><a class="code" href="interface_c_p_table_view.html#a3ab58abeecd8620354e7686b04869331">00876</a> - (void)addTableColumn:(<a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>)aTableColumn
<a name="l00877"></a>00877 {
<a name="l00878"></a>00878     [_tableColumns addObject:aTableColumn];
<a name="l00879"></a>00879     [aTableColumn <a class="code" href="interface_c_p_table_column.html#ad5566ac159b6de84c6672343cbffae17">setTableView</a>:self];
<a name="l00880"></a>00880 
<a name="l00881"></a>00881     <span class="keywordflow">if</span> (_dirtyTableColumnRangeIndex &lt; 0)
<a name="l00882"></a>00882         _dirtyTableColumnRangeIndex = <a class="code" href="_c_p_table_view_8j.html#aa0c3e20940452d04b6708ec8b82b482b">NUMBER_OF_COLUMNS</a>() - 1;
<a name="l00883"></a>00883     <span class="keywordflow">else</span>
<a name="l00884"></a>00884         _dirtyTableColumnRangeIndex = MIN(<a class="code" href="_c_p_table_view_8j.html#aa0c3e20940452d04b6708ec8b82b482b">NUMBER_OF_COLUMNS</a>() - 1, _dirtyTableColumnRangeIndex);
<a name="l00885"></a>00885 
<a name="l00886"></a>00886     <span class="keywordflow">if</span> ([[<span class="keyword">self</span> sortDescriptors] count] &gt; 0)
<a name="l00887"></a>00887     {
<a name="l00888"></a>00888         var mainSortDescriptor = [[<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#ad471440f19239990d1947a3a2f026f2a">sortDescriptors</a>] <a class="code" href="interface_c_p_array.html#a5f4c80df5e0ce9c9c7c64c7c24d917eb">objectAtIndex</a>:0];
<a name="l00889"></a>00889 
<a name="l00890"></a>00890         <span class="keywordflow">if</span> (aTableColumn === [<span class="keyword">self</span> _tableColumnForSortDescriptor:mainSortDescriptor])
<a name="l00891"></a>00891         {
<a name="l00892"></a>00892             var image = [mainSortDescriptor ascending] ? [<span class="keyword">self</span> _tableHeaderSortImage] : [<span class="keyword">self</span> _tableHeaderReverseSortImage];
<a name="l00893"></a>00893             [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#af9691a3301ba43ac53f9e8f2333476a4">setIndicatorImage</a>:image <a class="code" href="interface_c_p_table_view.html#af9691a3301ba43ac53f9e8f2333476a4">inTableColumn</a>:aTableColumn];
<a name="l00894"></a>00894         }
<a name="l00895"></a>00895     }
<a name="l00896"></a>00896 
<a name="l00897"></a>00897     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#af2af4f3cd8a4020f17c25c64548051ea">tile</a>];
<a name="l00898"></a>00898     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a39431c7a00864c9ddfe57c191fd82ccf">setNeedsLayout</a>];
<a name="l00899"></a>00899 }
<a name="l00900"></a>00900 
<a name="l00905"></a><a class="code" href="interface_c_p_table_view.html#a198e564259771a27d4ab7664c591cde2">00905</a> - (void)removeTableColumn:(<a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>)aTableColumn
<a name="l00906"></a>00906 {
<a name="l00907"></a>00907     <span class="keywordflow">if</span> ([aTableColumn <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>] !== <span class="keyword">self</span>)
<a name="l00908"></a>00908         <span class="keywordflow">return</span>;
<a name="l00909"></a>00909 
<a name="l00910"></a>00910     var index = [_tableColumns indexOfObjectIdenticalTo:aTableColumn];
<a name="l00911"></a>00911 
<a name="l00912"></a>00912     <span class="keywordflow">if</span> (index === <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l00913"></a>00913         <span class="keywordflow">return</span>;
<a name="l00914"></a>00914 
<a name="l00915"></a>00915     <span class="comment">// we defer the actual removal until the end of the runloop in order to keep a reference to the column.</span>
<a name="l00916"></a>00916     [_differedColumnDataToRemove addObject:{&quot;column&quot;:aTableColumn, &quot;shouldBeHidden&quot;: [aTableColumn <a class="code" href="interface_c_p_table_column.html#a8f44d171a90cd05c28345ea16fe51bb0">isHidden</a>]}];
<a name="l00917"></a>00917 
<a name="l00918"></a>00918     [aTableColumn <a class="code" href="interface_c_p_table_column.html#adbb4897cd4e7a65da3a00841a2b8726d">setHidden</a>:YES];
<a name="l00919"></a>00919     [aTableColumn <a class="code" href="interface_c_p_table_column.html#ad5566ac159b6de84c6672343cbffae17">setTableView</a>:nil];
<a name="l00920"></a>00920 
<a name="l00921"></a>00921     var tableColumnUID = [aTableColumn UID];
<a name="l00922"></a>00922 
<a name="l00923"></a>00923     <span class="keywordflow">if</span> (_objectValues[tableColumnUID])
<a name="l00924"></a>00924         _objectValues[tableColumnUID] = nil;
<a name="l00925"></a>00925 
<a name="l00926"></a>00926     <span class="keywordflow">if</span> (_dirtyTableColumnRangeIndex &lt; 0)
<a name="l00927"></a>00927         _dirtyTableColumnRangeIndex = index;
<a name="l00928"></a>00928     <span class="keywordflow">else</span>
<a name="l00929"></a>00929         _dirtyTableColumnRangeIndex = MIN(index, _dirtyTableColumnRangeIndex);
<a name="l00930"></a>00930 
<a name="l00931"></a>00931     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a39431c7a00864c9ddfe57c191fd82ccf">setNeedsLayout</a>];
<a name="l00932"></a>00932 }
<a name="l00933"></a>00933 
<a name="l00938"></a>00938 - (void)_setDraggedColumn:(<a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>)aColumn
<a name="l00939"></a>00939 {
<a name="l00940"></a>00940     <span class="keywordflow">if</span> (_draggedColumn === aColumn)
<a name="l00941"></a>00941         <span class="keywordflow">return</span>;
<a name="l00942"></a>00942 
<a name="l00943"></a>00943     _draggedColumn = aColumn;
<a name="l00944"></a>00944 
<a name="l00945"></a>00945     [<span class="keyword">self</span> reloadDataForRowIndexes:_exposedRows columnIndexes:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:[_tableColumns indexOfObject:aColumn]]];
<a name="l00946"></a>00946 }
<a name="l00947"></a>00947 
<a name="l00948"></a>00948 <span class="comment">/*</span>
<a name="l00949"></a>00949 <span class="comment">    @ignore</span>
<a name="l00950"></a>00950 <span class="comment">    Same as moveColumn:toColumn: but doesn&#39;t trigger an autosave</span>
<a name="l00951"></a>00951 <span class="comment">*/</span>
<a name="l00952"></a>00952 - (void)_moveColumn:(<span class="keywordtype">unsigned</span>)fromIndex toColumn:(<span class="keywordtype">unsigned</span>)toIndex
<a name="l00953"></a>00953 {
<a name="l00954"></a>00954     fromIndex = +fromIndex;
<a name="l00955"></a>00955     toIndex = +toIndex;
<a name="l00956"></a>00956 
<a name="l00957"></a>00957     <span class="keywordflow">if</span> (fromIndex === toIndex)
<a name="l00958"></a>00958         <span class="keywordflow">return</span>;
<a name="l00959"></a>00959 
<a name="l00960"></a>00960     <span class="keywordflow">if</span> (_dirtyTableColumnRangeIndex &lt; 0)
<a name="l00961"></a>00961         _dirtyTableColumnRangeIndex = MIN(fromIndex, toIndex);
<a name="l00962"></a>00962     <span class="keywordflow">else</span>
<a name="l00963"></a>00963         _dirtyTableColumnRangeIndex = MIN(fromIndex, toIndex, _dirtyTableColumnRangeIndex);
<a name="l00964"></a>00964 
<a name="l00965"></a>00965     var tableColumn = _tableColumns[fromIndex];
<a name="l00966"></a>00966 
<a name="l00967"></a>00967     [_tableColumns removeObjectAtIndex:fromIndex];
<a name="l00968"></a>00968     [_tableColumns insertObject:tableColumn atIndex:toIndex];
<a name="l00969"></a>00969 
<a name="l00970"></a>00970     [[<span class="keyword">self</span> headerView] setNeedsLayout];
<a name="l00971"></a>00971     [[<span class="keyword">self</span> headerView] setNeedsDisplay:YES];
<a name="l00972"></a>00972 
<a name="l00973"></a>00973     var rowIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4c32a454bd5323253b9e8c4f81712ea5">indexSetWithIndexesInRange</a>:CPMakeRange(0, [<span class="keyword">self</span> numberOfRows])],
<a name="l00974"></a>00974         columnIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4c32a454bd5323253b9e8c4f81712ea5">indexSetWithIndexesInRange</a>:CPMakeRange(fromIndex, toIndex)];
<a name="l00975"></a>00975 
<a name="l00976"></a>00976     [<span class="keyword">self</span> reloadDataForRowIndexes:rowIndexes columnIndexes:columnIndexes];
<a name="l00977"></a>00977 }
<a name="l00978"></a>00978 
<a name="l00984"></a><a class="code" href="interface_c_p_table_view.html#aadd26573d8a0769322e8cdea88e1f3e3">00984</a> - (void)moveColumn:(<span class="keywordtype">int</span>)theColumnIndex toColumn:(<span class="keywordtype">int</span>)theToIndex
<a name="l00985"></a>00985 {
<a name="l00986"></a>00986     [<span class="keyword">self</span> _moveColumn:theColumnIndex toColumn:theToIndex];
<a name="l00987"></a>00987     [<span class="keyword">self</span> _autosave];
<a name="l00988"></a>00988 }
<a name="l00989"></a>00989 
<a name="l00994"></a>00994 - (void)_tableColumnVisibilityDidChange:(<a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>)aColumn
<a name="l00995"></a>00995 {
<a name="l00996"></a>00996     var columnIndex = [[<span class="keyword">self</span> tableColumns] indexOfObjectIdenticalTo:aColumn];
<a name="l00997"></a>00997 
<a name="l00998"></a>00998     <span class="keywordflow">if</span> (_dirtyTableColumnRangeIndex &lt; 0)
<a name="l00999"></a>00999         _dirtyTableColumnRangeIndex = columnIndex;
<a name="l01000"></a>01000     <span class="keywordflow">else</span>
<a name="l01001"></a>01001         _dirtyTableColumnRangeIndex = MIN(columnIndex, _dirtyTableColumnRangeIndex);
<a name="l01002"></a>01002 
<a name="l01003"></a>01003     [[<span class="keyword">self</span> headerView] setNeedsLayout];
<a name="l01004"></a>01004     [[<span class="keyword">self</span> headerView] setNeedsDisplay:YES];
<a name="l01005"></a>01005 
<a name="l01006"></a>01006     var rowIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4c32a454bd5323253b9e8c4f81712ea5">indexSetWithIndexesInRange</a>:CPMakeRange(0, [<span class="keyword">self</span> numberOfRows])];
<a name="l01007"></a>01007     [<span class="keyword">self</span> reloadDataForRowIndexes:rowIndexes columnIndexes:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:columnIndex]];
<a name="l01008"></a>01008 }
<a name="l01009"></a>01009 
<a name="l01013"></a><a class="code" href="interface_c_p_table_view.html#addef4fffbf36e02b399b1fad4425b71e">01013</a> - (<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>)tableColumns
<a name="l01014"></a>01014 {
<a name="l01015"></a>01015     <span class="keywordflow">return</span> _tableColumns;
<a name="l01016"></a>01016 }
<a name="l01017"></a>01017 
<a name="l01024"></a><a class="code" href="interface_c_p_table_view.html#a0e0170cf4b064a18328eaf849f164151">01024</a> - (CPInteger)columnWithIdentifier:(<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)anIdentifier
<a name="l01025"></a>01025 {
<a name="l01026"></a>01026     var index = 0,
<a name="l01027"></a>01027         count = <a class="code" href="_c_p_table_view_8j.html#aa0c3e20940452d04b6708ec8b82b482b">NUMBER_OF_COLUMNS</a>();
<a name="l01028"></a>01028 
<a name="l01029"></a>01029     <span class="keywordflow">for</span> (; index &lt; count; ++index)
<a name="l01030"></a>01030         <span class="keywordflow">if</span> ([_tableColumns[index] identifier] === anIdentifier)
<a name="l01031"></a>01031             <span class="keywordflow">return</span> index;
<a name="l01032"></a>01032 
<a name="l01033"></a>01033     <span class="keywordflow">return</span> <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l01034"></a>01034 }
<a name="l01035"></a>01035 
<a name="l01042"></a><a class="code" href="interface_c_p_table_view.html#ac38f1645e78de903c53e3d51ea2c34ac">01042</a> - (<a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>)tableColumnWithIdentifier:(<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)anIdentifier
<a name="l01043"></a>01043 {
<a name="l01044"></a>01044     var index = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a0e0170cf4b064a18328eaf849f164151">columnWithIdentifier</a>:anIdentifier];
<a name="l01045"></a>01045 
<a name="l01046"></a>01046     <span class="keywordflow">if</span> (index === <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l01047"></a>01047         <span class="keywordflow">return</span> nil;
<a name="l01048"></a>01048 
<a name="l01049"></a>01049     <span class="keywordflow">return</span> _tableColumns[index];
<a name="l01050"></a>01050 }
<a name="l01051"></a>01051 
<a name="l01055"></a>01055 - (void)_didResizeTableColumn:(<a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>)theColumn
<a name="l01056"></a>01056 {
<a name="l01057"></a>01057     [<span class="keyword">self</span> _autosave];
<a name="l01058"></a>01058 }
<a name="l01059"></a>01059 
<a name="l01060"></a>01060 <span class="comment">//Selecting Columns and Rows</span>
<a name="l01061"></a>01061 
<a name="l01068"></a><a class="code" href="interface_c_p_table_view.html#aea838609fe453ae9ed670d98c3c4ff04">01068</a> - (void)selectColumnIndexes:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)columns byExtendingSelection:(BOOL)shouldExtendSelection
<a name="l01069"></a>01069 {
<a name="l01070"></a>01070     <span class="comment">// If we&#39;re out of range, just return</span>
<a name="l01071"></a>01071     <span class="keywordflow">if</span> (([columns firstIndex] != <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a> &amp;&amp; [columns firstIndex] &lt; 0) || [columns lastIndex] &gt;= [<span class="keyword">self</span> numberOfColumns])
<a name="l01072"></a>01072         <span class="keywordflow">return</span>;
<a name="l01073"></a>01073 
<a name="l01074"></a>01074     <span class="comment">// We deselect all rows when selecting columns.</span>
<a name="l01075"></a>01075     <span class="keywordflow">if</span> ([_selectedRowIndexes count] &gt; 0)
<a name="l01076"></a>01076     {
<a name="l01077"></a>01077         [<span class="keyword">self</span> _updateHighlightWithOldRows:_selectedRowIndexes newRows:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>]];
<a name="l01078"></a>01078         _selectedRowIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l01079"></a>01079     }
<a name="l01080"></a>01080 
<a name="l01081"></a>01081     var previousSelectedIndexes = [_selectedColumnIndexes copy];
<a name="l01082"></a>01082 
<a name="l01083"></a>01083     <span class="keywordflow">if</span> (shouldExtendSelection)
<a name="l01084"></a>01084         [_selectedColumnIndexes addIndexes:columns];
<a name="l01085"></a>01085     <span class="keywordflow">else</span>
<a name="l01086"></a>01086         _selectedColumnIndexes = [columns <a class="code" href="class_c_p_index_set.html#a3012b890a21584080a2a52e399b39f58">copy</a>];
<a name="l01087"></a>01087 
<a name="l01088"></a>01088     [<span class="keyword">self</span> _updateHighlightWithOldColumns:previousSelectedIndexes newColumns:_selectedColumnIndexes];
<a name="l01089"></a>01089     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a31af19dc321476a95414cd5e5da60ef0">setNeedsDisplay</a>:YES]; <span class="comment">// FIXME: should be setNeedsDisplayInRect:enclosing rect of new (de)selected columns</span>
<a name="l01090"></a>01090                               <span class="comment">// but currently -drawRect: is not implemented here</span>
<a name="l01091"></a>01091     <span class="keywordflow">if</span> (_headerView)
<a name="l01092"></a>01092         [_headerView setNeedsDisplay:YES];
<a name="l01093"></a>01093 
<a name="l01094"></a>01094     [<span class="keyword">self</span> _noteSelectionDidChange];
<a name="l01095"></a>01095 }
<a name="l01096"></a>01096 
<a name="l01100"></a>01100 - (void)_setSelectedRowIndexes:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)rows
<a name="l01101"></a>01101 {
<a name="l01102"></a>01102     <span class="keywordflow">if</span> ([_selectedRowIndexes isEqualToIndexSet:rows])
<a name="l01103"></a>01103         <span class="keywordflow">return</span>;
<a name="l01104"></a>01104 
<a name="l01105"></a>01105     var previousSelectedIndexes = _selectedRowIndexes;
<a name="l01106"></a>01106 
<a name="l01107"></a>01107     _lastSelectedRow = ([rows count] &gt; 0) ? [rows lastIndex] : -1;
<a name="l01108"></a>01108     _selectedRowIndexes = [rows copy];
<a name="l01109"></a>01109 
<a name="l01110"></a>01110     [<span class="keyword">self</span> _updateHighlightWithOldRows:previousSelectedIndexes newRows:_selectedRowIndexes];
<a name="l01111"></a>01111     [<span class="keyword">self</span> setNeedsDisplay:YES]; <span class="comment">// FIXME: should be setNeedsDisplayInRect:enclosing rect of new (de)selected rows</span>
<a name="l01112"></a>01112                               <span class="comment">// but currently -drawRect: is not implemented here</span>
<a name="l01113"></a>01113 
<a name="l01114"></a>01114     var binderClass = [[<span class="keyword">self</span> class] _binderClassForBinding:@&quot;selectionIndexes&quot;];
<a name="l01115"></a>01115     [[binderClass getBinding:@&quot;selectionIndexes&quot; forObject:self] reverseSetValueFor:@&quot;selectedRowIndexes&quot;];
<a name="l01116"></a>01116 
<a name="l01117"></a>01117     [<span class="keyword">self</span> _noteSelectionDidChange];
<a name="l01118"></a>01118 }
<a name="l01119"></a>01119 
<a name="l01126"></a><a class="code" href="interface_c_p_table_view.html#a9b6204a962c90a046897dce505fec408">01126</a> - (void)selectRowIndexes:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)rows byExtendingSelection:(BOOL)shouldExtendSelection
<a name="l01127"></a>01127 {
<a name="l01128"></a>01128     <span class="keywordflow">if</span> ([rows isEqualToIndexSet:_selectedRowIndexes] ||
<a name="l01129"></a>01129         (([rows firstIndex] != <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a> &amp;&amp; [rows firstIndex] &lt; 0) || [rows lastIndex] &gt;= [<span class="keyword">self</span> numberOfRows]))
<a name="l01130"></a>01130         <span class="keywordflow">return</span>;
<a name="l01131"></a>01131 
<a name="l01132"></a>01132     <span class="comment">// We deselect all columns when selecting rows.</span>
<a name="l01133"></a>01133     <span class="keywordflow">if</span> ([_selectedColumnIndexes count] &gt; 0)
<a name="l01134"></a>01134     {
<a name="l01135"></a>01135         [<span class="keyword">self</span> _updateHighlightWithOldColumns:_selectedColumnIndexes newColumns:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>]];
<a name="l01136"></a>01136         _selectedColumnIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l01137"></a>01137         <span class="keywordflow">if</span> (_headerView)
<a name="l01138"></a>01138             [_headerView setNeedsDisplay:YES];
<a name="l01139"></a>01139     }
<a name="l01140"></a>01140 
<a name="l01141"></a>01141     var newSelectedIndexes;
<a name="l01142"></a>01142     <span class="keywordflow">if</span> (shouldExtendSelection)
<a name="l01143"></a>01143     {
<a name="l01144"></a>01144         newSelectedIndexes = [_selectedRowIndexes copy];
<a name="l01145"></a>01145         [newSelectedIndexes addIndexes:rows];
<a name="l01146"></a>01146     }
<a name="l01147"></a>01147     <span class="keywordflow">else</span>
<a name="l01148"></a>01148         newSelectedIndexes = [rows <a class="code" href="class_c_p_index_set.html#a3012b890a21584080a2a52e399b39f58">copy</a>];
<a name="l01149"></a>01149 
<a name="l01150"></a>01150     [<span class="keyword">self</span> _setSelectedRowIndexes:newSelectedIndexes];
<a name="l01151"></a>01151 }
<a name="l01152"></a>01152 
<a name="l01156"></a>01156 - (void)_updateHighlightWithOldRows:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)oldRows newRows:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)newRows
<a name="l01157"></a>01157 {
<a name="l01158"></a>01158     var firstExposedRow = [_exposedRows firstIndex],
<a name="l01159"></a>01159         exposedLength = [_exposedRows lastIndex] - firstExposedRow + 1,
<a name="l01160"></a>01160         deselectRows = [],
<a name="l01161"></a>01161         selectRows = [],
<a name="l01162"></a>01162         deselectRowIndexes = [oldRows copy],
<a name="l01163"></a>01163         selectRowIndexes = [newRows copy];
<a name="l01164"></a>01164 
<a name="l01165"></a>01165     [deselectRowIndexes removeMatches:selectRowIndexes];
<a name="l01166"></a>01166     [deselectRowIndexes getIndexes:deselectRows maxCount:-1 inIndexRange:CPMakeRange(firstExposedRow, exposedLength)];
<a name="l01167"></a>01167     [selectRowIndexes getIndexes:selectRows maxCount:-1 inIndexRange:CPMakeRange(firstExposedRow, exposedLength)];
<a name="l01168"></a>01168 
<a name="l01169"></a>01169     <span class="keywordflow">for</span> (var identifier in _dataViewsForTableColumns)
<a name="l01170"></a>01170     {
<a name="l01171"></a>01171         var dataViewsInTableColumn = _dataViewsForTableColumns[identifier],
<a name="l01172"></a>01172             count = deselectRows.length;
<a name="l01173"></a>01173         <span class="keywordflow">while</span> (count--)
<a name="l01174"></a>01174             [<span class="keyword">self</span> _performSelection:NO forRow:deselectRows[count] context:dataViewsInTableColumn];
<a name="l01175"></a>01175 
<a name="l01176"></a>01176         count = selectRows.length;
<a name="l01177"></a>01177         <span class="keywordflow">while</span> (count--)
<a name="l01178"></a>01178             [<span class="keyword">self</span> _performSelection:YES forRow:selectRows[count] context:dataViewsInTableColumn];
<a name="l01179"></a>01179     }
<a name="l01180"></a>01180 }
<a name="l01181"></a>01181 
<a name="l01185"></a>01185 - (void)_performSelection:(BOOL)select forRow:(CPInteger)rowIndex context:(<span class="keywordtype">id</span>)context
<a name="l01186"></a>01186 {
<a name="l01187"></a>01187     var view = context[rowIndex],
<a name="l01188"></a>01188         selector = select ? <span class="stringliteral">@&quot;setThemeState:&quot;</span> : <span class="stringliteral">@&quot;unsetThemeState:&quot;</span>;
<a name="l01189"></a>01189 
<a name="l01190"></a>01190     [view performSelector:CPSelectorFromString(selector) withObject:CPThemeStateSelectedDataView];
<a name="l01191"></a>01191 }
<a name="l01192"></a>01192 
<a name="l01196"></a>01196 - (void)_updateHighlightWithOldColumns:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)oldColumns newColumns:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)newColumns
<a name="l01197"></a>01197 {
<a name="l01198"></a>01198     var firstExposedColumn = [_exposedColumns firstIndex],
<a name="l01199"></a>01199         exposedLength = [_exposedColumns lastIndex] - firstExposedColumn  +1,
<a name="l01200"></a>01200         deselectColumns  = [],
<a name="l01201"></a>01201         selectColumns  = [],
<a name="l01202"></a>01202         deselectColumnIndexes = [oldColumns copy],
<a name="l01203"></a>01203         selectColumnIndexes = [newColumns copy],
<a name="l01204"></a>01204         selectRows = [];
<a name="l01205"></a>01205 
<a name="l01206"></a>01206     [deselectColumnIndexes removeMatches:selectColumnIndexes];
<a name="l01207"></a>01207     [deselectColumnIndexes getIndexes:deselectColumns maxCount:-1 inIndexRange:CPMakeRange(firstExposedColumn, exposedLength)];
<a name="l01208"></a>01208     [selectColumnIndexes getIndexes:selectColumns maxCount:-1 inIndexRange:CPMakeRange(firstExposedColumn, exposedLength)];
<a name="l01209"></a>01209     [_exposedRows getIndexes:selectRows maxCount:-1 inIndexRange:nil];
<a name="l01210"></a>01210 
<a name="l01211"></a>01211     var rowsCount = selectRows.length,
<a name="l01212"></a>01212         count = deselectColumns.length;
<a name="l01213"></a>01213     <span class="keywordflow">while</span> (count--)
<a name="l01214"></a>01214     {
<a name="l01215"></a>01215         var columnIndex = deselectColumns[count],
<a name="l01216"></a>01216             identifier = [_tableColumns[columnIndex] UID],
<a name="l01217"></a>01217             dataViewsInTableColumn = _dataViewsForTableColumns[identifier];
<a name="l01218"></a>01218 
<a name="l01219"></a>01219         <span class="keywordflow">for</span> (var i = 0; i &lt; rowsCount; i++)
<a name="l01220"></a>01220         {
<a name="l01221"></a>01221             var rowIndex = selectRows[i],
<a name="l01222"></a>01222                 dataView = dataViewsInTableColumn[rowIndex];
<a name="l01223"></a>01223             [dataView unsetThemeState:CPThemeStateSelectedDataView];
<a name="l01224"></a>01224         }
<a name="l01225"></a>01225 
<a name="l01226"></a>01226         <span class="keywordflow">if</span> (_headerView)
<a name="l01227"></a>01227         {
<a name="l01228"></a>01228             var headerView = [_tableColumns[columnIndex] headerView];
<a name="l01229"></a>01229             [headerView unsetThemeState:CPThemeStateSelected];
<a name="l01230"></a>01230         }
<a name="l01231"></a>01231     }
<a name="l01232"></a>01232 
<a name="l01233"></a>01233     count = selectColumns.length;
<a name="l01234"></a>01234     <span class="keywordflow">while</span> (count--)
<a name="l01235"></a>01235     {
<a name="l01236"></a>01236         var columnIndex = selectColumns[count],
<a name="l01237"></a>01237             identifier = [_tableColumns[columnIndex] UID],
<a name="l01238"></a>01238             dataViewsInTableColumn = _dataViewsForTableColumns[identifier];
<a name="l01239"></a>01239 
<a name="l01240"></a>01240         <span class="keywordflow">for</span> (var i = 0; i &lt; rowsCount; i++)
<a name="l01241"></a>01241         {
<a name="l01242"></a>01242             var rowIndex = selectRows[i],
<a name="l01243"></a>01243                 dataView = dataViewsInTableColumn[rowIndex];
<a name="l01244"></a>01244             [dataView setThemeState:CPThemeStateSelectedDataView];
<a name="l01245"></a>01245         }
<a name="l01246"></a>01246         <span class="keywordflow">if</span> (_headerView)
<a name="l01247"></a>01247         {
<a name="l01248"></a>01248             var headerView = [_tableColumns[columnIndex] headerView];
<a name="l01249"></a>01249             [headerView setThemeState:CPThemeStateSelected];
<a name="l01250"></a>01250         }
<a name="l01251"></a>01251     }
<a name="l01252"></a>01252 }
<a name="l01253"></a>01253 
<a name="l01257"></a><a class="code" href="interface_c_p_table_view.html#aa72723cae269bec0cbb0c479fb85a4c1">01257</a> - (int)selectedColumn
<a name="l01258"></a>01258 {
<a name="l01259"></a>01259     [_selectedColumnIndexes lastIndex];
<a name="l01260"></a>01260 }
<a name="l01261"></a>01261 
<a name="l01265"></a><a class="code" href="interface_c_p_table_view.html#a26beabf6bfecebb33c7b0128a169cd9e">01265</a> - (<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)selectedColumnIndexes
<a name="l01266"></a>01266 {
<a name="l01267"></a>01267     <span class="keywordflow">return</span> _selectedColumnIndexes;
<a name="l01268"></a>01268 }
<a name="l01269"></a>01269 
<a name="l01273"></a><a class="code" href="interface_c_p_table_view.html#aebb33e5ef504a1a2cc3aef9937a1c50f">01273</a> - (int)selectedRow
<a name="l01274"></a>01274 {
<a name="l01275"></a>01275     <span class="keywordflow">return</span> _lastSelectedRow;
<a name="l01276"></a>01276 }
<a name="l01277"></a>01277 
<a name="l01281"></a><a class="code" href="interface_c_p_table_view.html#a2bb55a58f2ae8d7636b0553982f3c9a7">01281</a> - (<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)selectedRowIndexes
<a name="l01282"></a>01282 {
<a name="l01283"></a>01283     <span class="keywordflow">return</span> [_selectedRowIndexes copy];
<a name="l01284"></a>01284 }
<a name="l01285"></a>01285 
<a name="l01291"></a><a class="code" href="interface_c_p_table_view.html#a71e1d942e9621e3ecaf1dd14f2a79192">01291</a> - (void)deselectColumn:(CPInteger)anIndex
<a name="l01292"></a>01292 {
<a name="l01293"></a>01293     var selectedColumnIndexes = [_selectedColumnIndexes copy];
<a name="l01294"></a>01294     [<a class="code" href="interface_c_p_table_view.html#a26beabf6bfecebb33c7b0128a169cd9e">selectedColumnIndexes</a> <a class="code" href="class_c_p_index_set.html#ae5735bf105324052eb4f502244cdd0db">removeIndex</a>:anIndex];
<a name="l01295"></a>01295     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aea838609fe453ae9ed670d98c3c4ff04">selectColumnIndexes</a>:selectedColumnIndexes <a class="code" href="interface_c_p_table_view.html#aea838609fe453ae9ed670d98c3c4ff04">byExtendingSelection</a>:NO];
<a name="l01296"></a>01296     [<span class="keyword">self</span> _noteSelectionDidChange];
<a name="l01297"></a>01297 }
<a name="l01298"></a>01298 
<a name="l01304"></a><a class="code" href="interface_c_p_table_view.html#aa03aa6f24b45e335d09e2aea7d4a44c2">01304</a> - (void)deselectRow:(CPInteger)aRow
<a name="l01305"></a>01305 {
<a name="l01306"></a>01306     var selectedRowIndexes = [_selectedRowIndexes copy];
<a name="l01307"></a>01307     [<a class="code" href="interface_c_p_table_view.html#a2bb55a58f2ae8d7636b0553982f3c9a7">selectedRowIndexes</a> <a class="code" href="class_c_p_index_set.html#ae5735bf105324052eb4f502244cdd0db">removeIndex</a>:aRow];
<a name="l01308"></a>01308     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a9b6204a962c90a046897dce505fec408">selectRowIndexes</a>:selectedRowIndexes <a class="code" href="interface_c_p_table_view.html#a9b6204a962c90a046897dce505fec408">byExtendingSelection</a>:NO];
<a name="l01309"></a>01309     [<span class="keyword">self</span> _noteSelectionDidChange];
<a name="l01310"></a>01310 }
<a name="l01311"></a>01311 
<a name="l01315"></a><a class="code" href="interface_c_p_table_view.html#a246c8b3a4b46973fa63e56ade90f3363">01315</a> - (CPInteger)numberOfSelectedColumns
<a name="l01316"></a>01316 {
<a name="l01317"></a>01317     <span class="keywordflow">return</span> [_selectedColumnIndexes count];
<a name="l01318"></a>01318 }
<a name="l01319"></a>01319 
<a name="l01323"></a><a class="code" href="interface_c_p_table_view.html#ab087d7a16c2f5430eecc4d173280e40c">01323</a> - (CPInteger)numberOfSelectedRows
<a name="l01324"></a>01324 {
<a name="l01325"></a>01325     <span class="keywordflow">return</span> [_selectedRowIndexes count];
<a name="l01326"></a>01326 }
<a name="l01327"></a>01327 
<a name="l01334"></a><a class="code" href="interface_c_p_table_view.html#a1bcb13f307f474906b1451746e7e1fdc">01334</a> - (BOOL)isColumnSelected:(CPInteger)anIndex
<a name="l01335"></a>01335 {
<a name="l01336"></a>01336     <span class="keywordflow">return</span> [_selectedColumnIndexes containsIndex:anIndex];
<a name="l01337"></a>01337 }
<a name="l01338"></a>01338 
<a name="l01345"></a><a class="code" href="interface_c_p_table_view.html#a39fa58bb83f641a87f792ac788bc4c0c">01345</a> - (BOOL)isRowSelected:(CPInteger)aRow
<a name="l01346"></a>01346 {
<a name="l01347"></a>01347     <span class="keywordflow">return</span> [_selectedRowIndexes containsIndex:aRow];
<a name="l01348"></a>01348 }
<a name="l01349"></a>01349 
<a name="l01350"></a>01350 
<a name="l01354"></a><a class="code" href="interface_c_p_table_view.html#a000c8dd3192600081340358c7f04c104">01354</a> - (void)deselectAll
<a name="l01355"></a>01355 {
<a name="l01356"></a>01356     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a9b6204a962c90a046897dce505fec408">selectRowIndexes</a>:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>] <a class="code" href="interface_c_p_table_view.html#a9b6204a962c90a046897dce505fec408">byExtendingSelection</a>:NO];
<a name="l01357"></a>01357     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aea838609fe453ae9ed670d98c3c4ff04">selectColumnIndexes</a>:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>] <a class="code" href="interface_c_p_table_view.html#aea838609fe453ae9ed670d98c3c4ff04">byExtendingSelection</a>:NO];
<a name="l01358"></a>01358 }
<a name="l01359"></a>01359 
<a name="l01363"></a><a class="code" href="interface_c_p_table_view.html#ae601240f59853d00860181c80d763a03">01363</a> - (int)numberOfColumns
<a name="l01364"></a>01364 {
<a name="l01365"></a>01365     <span class="keywordflow">return</span> <a class="code" href="_c_p_table_view_8j.html#aa0c3e20940452d04b6708ec8b82b482b">NUMBER_OF_COLUMNS</a>();
<a name="l01366"></a>01366 }
<a name="l01367"></a>01367 
<a name="l01371"></a><a class="code" href="interface_c_p_table_view.html#ab93d1883609b8aaca737188ee9667c17">01371</a> - (int)numberOfRows
<a name="l01372"></a>01372 {
<a name="l01373"></a>01373     <span class="keywordflow">if</span> (_numberOfRows !== nil)
<a name="l01374"></a>01374         <span class="keywordflow">return</span> _numberOfRows;
<a name="l01375"></a>01375 
<a name="l01376"></a>01376     var contentBindingInfo = [<span class="keyword">self</span> <a class="code" href="class_c_p_object.html#a78aa766bf03851ddd6db2be8a96ab1cb">infoForBinding</a>:@&quot;content&quot;];
<a name="l01377"></a>01377 
<a name="l01378"></a>01378     <span class="keywordflow">if</span> (contentBindingInfo)
<a name="l01379"></a>01379     {
<a name="l01380"></a>01380         var destination = [contentBindingInfo objectForKey:CPObservedObjectKey],
<a name="l01381"></a>01381             keyPath = [contentBindingInfo objectForKey:CPObservedKeyPathKey];
<a name="l01382"></a>01382 
<a name="l01383"></a>01383         _numberOfRows = [[destination valueForKeyPath:keyPath] count];
<a name="l01384"></a>01384     }
<a name="l01385"></a>01385     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_dataSource &amp;&amp; (_implementedDataSourceMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a79c288910d3f547d5433a6946cec05bc">CPTableViewDataSource_numberOfRowsInTableView_</a>))
<a name="l01386"></a>01386         _numberOfRows = [_dataSource numberOfRowsInTableView:self] || 0;
<a name="l01387"></a>01387     <span class="keywordflow">else</span>
<a name="l01388"></a>01388     {
<a name="l01389"></a>01389         <span class="keywordflow">if</span> (_dataSource)
<a name="l01390"></a>01390             CPLog(<span class="stringliteral">@&quot;no content binding established and data source &quot;</span> + [_dataSource description] + <span class="stringliteral">&quot; does not implement numberOfRowsInTableView:&quot;</span>);
<a name="l01391"></a>01391         _numberOfRows = 0;
<a name="l01392"></a>01392     }
<a name="l01393"></a>01393 
<a name="l01394"></a>01394     <span class="keywordflow">return</span> _numberOfRows;
<a name="l01395"></a>01395 }
<a name="l01396"></a>01396 
<a name="l01406"></a><a class="code" href="interface_c_p_table_view.html#a4787c1ca24a7e508bc95eabd86eddbbf">01406</a> - (void)editColumn:(CPInteger)columnIndex row:(CPInteger)rowIndex withEvent:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)theEvent select:(BOOL)flag
<a name="l01407"></a>01407 {
<a name="l01408"></a>01408     <span class="comment">// FIX ME: Cocoa documentation says all this should be called in THIS method:</span>
<a name="l01409"></a>01409     <span class="comment">// sets up the field editor, and sends selectWithFrame:inView:editor:delegate:start:length: and editWithFrame:inView:editor:delegate:event: to the field editor&#39;s NSCell object with the NSTableView as the text delegate.</span>
<a name="l01410"></a>01410 
<a name="l01411"></a>01411     <span class="keywordflow">if</span> (![<span class="keyword">self</span> isRowSelected:rowIndex])
<a name="l01412"></a>01412         [[<a class="code" href="interface_c_p_exception.html" title="Used to implement exception handling (creating &amp; raising).">CPException</a> <a class="code" href="interface_c_p_exception.html#a44c9e2d9ffa44471351ac8086093f542">exceptionWithName</a>:@&quot;Error&quot; <a class="code" href="interface_c_p_exception.html#a44c9e2d9ffa44471351ac8086093f542">reason</a>:@&quot;Attempt to edit row=&quot;+rowIndex+&quot; when not selected.&quot; <a class="code" href="interface_c_p_exception.html#a44c9e2d9ffa44471351ac8086093f542">userInfo</a>:nil] <a class="code" href="interface_c_p_exception.html#a1428cc4e84f1d200dea624a85d6c9336">raise</a>];
<a name="l01413"></a>01413 
<a name="l01414"></a>01414     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aac2521d3f258b8a58f3357756a5b830f">scrollRowToVisible</a>:rowIndex];
<a name="l01415"></a>01415     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a2ffae1b91fadd2aa6055af8b2be802d8">scrollColumnToVisible</a>:columnIndex];
<a name="l01416"></a>01416 
<a name="l01417"></a>01417     <span class="comment">// TODO Do something with flag.</span>
<a name="l01418"></a>01418 
<a name="l01419"></a>01419     _editingCellIndex = CGPointMake(columnIndex, rowIndex);
<a name="l01420"></a>01420     _editingCellIndex._shouldSelect = flag;
<a name="l01421"></a>01421 
<a name="l01422"></a>01422     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a69ae01655437f565b3f51bd2805fe68a">reloadDataForRowIndexes</a>:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:rowIndex]
<a name="l01423"></a>01423         <a class="code" href="interface_c_p_table_view.html#a69ae01655437f565b3f51bd2805fe68a">columnIndexes</a>:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:columnIndex]];
<a name="l01424"></a>01424 }
<a name="l01425"></a>01425 
<a name="l01429"></a><a class="code" href="interface_c_p_table_view.html#aab2509005e961a47adf2fa648c4f9246">01429</a> - (CPInteger)editedColumn
<a name="l01430"></a>01430 {
<a name="l01431"></a>01431     <span class="keywordflow">if</span> (!_editingCellIndex)
<a name="l01432"></a>01432         <span class="keywordflow">return</span> <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l01433"></a>01433     <span class="keywordflow">return</span> _editingCellIndex.x;
<a name="l01434"></a>01434 }
<a name="l01435"></a>01435 
<a name="l01439"></a><a class="code" href="interface_c_p_table_view.html#abc2ea2f21ecc058296ed2e870e5389cd">01439</a> - (CPInteger)editedRow
<a name="l01440"></a>01440 {
<a name="l01441"></a>01441     <span class="keywordflow">if</span> (!_editingCellIndex)
<a name="l01442"></a>01442         <span class="keywordflow">return</span> <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l01443"></a>01443     <span class="keywordflow">return</span> _editingCellIndex.y;
<a name="l01444"></a>01444 }
<a name="l01445"></a>01445 
<a name="l01449"></a><a class="code" href="interface_c_p_table_view.html#ac06f185ca68d4bbe813ebcf4f0da66c6">01449</a> - (<a class="code" href="interface_c_p_view.html">CPView</a>)cornerView
<a name="l01450"></a>01450 {
<a name="l01451"></a>01451     <span class="keywordflow">return</span> _cornerView;
<a name="l01452"></a>01452 }
<a name="l01453"></a>01453 
<a name="l01457"></a><a class="code" href="interface_c_p_table_view.html#ad6c2cf202a6c05de91e2e56fe7368811">01457</a> - (void)setCornerView:(<a class="code" href="interface_c_p_view.html">CPView</a>)aView
<a name="l01458"></a>01458 {
<a name="l01459"></a>01459     <span class="keywordflow">if</span> (_cornerView === aView)
<a name="l01460"></a>01460         <span class="keywordflow">return</span>;
<a name="l01461"></a>01461 
<a name="l01462"></a>01462     _cornerView = aView;
<a name="l01463"></a>01463 
<a name="l01464"></a>01464     var scrollView = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a9a888331b1834c12552ab08f80269f77">enclosingScrollView</a>];
<a name="l01465"></a>01465 
<a name="l01466"></a>01466     <span class="keywordflow">if</span> ([scrollView isKindOfClass:[<a class="code" href="interface_c_p_scroll_view.html">CPScrollView</a> <span class="keyword">class</span>]] &amp;&amp; [scrollView documentView] === <span class="keyword">self</span>)
<a name="l01467"></a>01467         [scrollView _updateCornerAndHeaderView];
<a name="l01468"></a>01468 }
<a name="l01469"></a>01469 
<a name="l01473"></a><a class="code" href="interface_c_p_table_view.html#a1200e854924976eed1efa14719a8eba6">01473</a> - (<a class="code" href="interface_c_p_view.html">CPView</a>)headerView
<a name="l01474"></a>01474 {
<a name="l01475"></a>01475     <span class="keywordflow">return</span> _headerView;
<a name="l01476"></a>01476 }
<a name="l01477"></a>01477 
<a name="l01478"></a>01478 
<a name="l01486"></a><a class="code" href="interface_c_p_table_view.html#ade4b1dc944f33bcdbb33699aaa2c52f3">01486</a> - (void)setHeaderView:(<a class="code" href="interface_c_p_view.html">CPView</a>)aHeaderView
<a name="l01487"></a>01487 {
<a name="l01488"></a>01488     <span class="keywordflow">if</span> (_headerView === aHeaderView)
<a name="l01489"></a>01489         <span class="keywordflow">return</span>;
<a name="l01490"></a>01490 
<a name="l01491"></a>01491     [_headerView setTableView:nil];
<a name="l01492"></a>01492 
<a name="l01493"></a>01493     _headerView = aHeaderView;
<a name="l01494"></a>01494 
<a name="l01495"></a>01495     <span class="keywordflow">if</span> (_headerView)
<a name="l01496"></a>01496     {
<a name="l01497"></a>01497         [_headerView setTableView:self];
<a name="l01498"></a>01498         [_headerView setFrameSize:_CGSizeMake(_CGRectGetWidth([<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a6e37aa6c3ed5389e9a3bb7082b380cc5">frame</a>]), _CGRectGetHeight([_headerView frame]))];
<a name="l01499"></a>01499     }
<a name="l01500"></a>01500     <span class="keywordflow">else</span>
<a name="l01501"></a>01501     {
<a name="l01502"></a>01502         <span class="comment">// If there is no header view, there should be no corner view</span>
<a name="l01503"></a>01503         [_cornerView removeFromSuperview];
<a name="l01504"></a>01504         _cornerView = nil;
<a name="l01505"></a>01505     }
<a name="l01506"></a>01506 
<a name="l01507"></a>01507     var scrollView = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a9a888331b1834c12552ab08f80269f77">enclosingScrollView</a>];
<a name="l01508"></a>01508 
<a name="l01509"></a>01509     <span class="keywordflow">if</span> ([scrollView isKindOfClass:[<a class="code" href="interface_c_p_scroll_view.html">CPScrollView</a> <span class="keyword">class</span>]] &amp;&amp; [scrollView documentView] === <span class="keyword">self</span>)
<a name="l01510"></a>01510         [scrollView _updateCornerAndHeaderView];
<a name="l01511"></a>01511 }
<a name="l01512"></a>01512 
<a name="l01513"></a>01513 <span class="comment">// Complexity:</span>
<a name="l01514"></a>01514 <span class="comment">// O(Columns)</span>
<a name="l01518"></a>01518 <span class="comment"></span>- (void)_recalculateTableColumnRanges
<a name="l01519"></a>01519 {
<a name="l01520"></a>01520     <span class="keywordflow">if</span> (_dirtyTableColumnRangeIndex &lt; 0)
<a name="l01521"></a>01521         <span class="keywordflow">return</span>;
<a name="l01522"></a>01522 
<a name="l01523"></a>01523     _numberOfHiddenColumns = 0;
<a name="l01524"></a>01524 
<a name="l01525"></a>01525     var index = _dirtyTableColumnRangeIndex,
<a name="l01526"></a>01526         count = <a class="code" href="_c_p_table_view_8j.html#aa0c3e20940452d04b6708ec8b82b482b">NUMBER_OF_COLUMNS</a>(),
<a name="l01527"></a>01527         x = index === 0 ? 0.0 : <a class="code" href="group__foundation.html#ga9a9c6e53b2b0861cedbb77b5ab72e78f">CPMaxRange</a>(_tableColumnRanges[index - 1]);
<a name="l01528"></a>01528 
<a name="l01529"></a>01529     <span class="keywordflow">for</span> (; index &lt; count; ++index)
<a name="l01530"></a>01530     {
<a name="l01531"></a>01531         var tableColumn = _tableColumns[index];
<a name="l01532"></a>01532 
<a name="l01533"></a>01533         <span class="keywordflow">if</span> ([tableColumn isHidden])
<a name="l01534"></a>01534         {
<a name="l01535"></a>01535             _numberOfHiddenColumns += 1;
<a name="l01536"></a>01536             _tableColumnRanges[index] = <a class="code" href="group__foundation.html#ga377fec0972facd19d72b8abcffcdb362">CPMakeRange</a>(x, 0.0);
<a name="l01537"></a>01537         }
<a name="l01538"></a>01538         <span class="keywordflow">else</span>
<a name="l01539"></a>01539         {
<a name="l01540"></a>01540             var <a class="code" href="_c_g_geometry_8j.html#a52b64513cb182b63f0e848f53bddad9b">width</a> = [_tableColumns[index] width] + _intercellSpacing.width;
<a name="l01541"></a>01541 
<a name="l01542"></a>01542             _tableColumnRanges[index] = <a class="code" href="group__foundation.html#ga377fec0972facd19d72b8abcffcdb362">CPMakeRange</a>(x, width);
<a name="l01543"></a>01543 
<a name="l01544"></a>01544             x += width;
<a name="l01545"></a>01545         }
<a name="l01546"></a>01546     }
<a name="l01547"></a>01547 
<a name="l01548"></a>01548     _tableColumnRanges.length = count;
<a name="l01549"></a>01549     _dirtyTableColumnRangeIndex = <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l01550"></a>01550 }
<a name="l01551"></a>01551 
<a name="l01552"></a>01552 <span class="comment">// Complexity:</span>
<a name="l01553"></a>01553 <span class="comment">// O(1)</span>
<a name="l01560"></a><a class="code" href="interface_c_p_table_view.html#af86aacec5d36506c1fee17f1fab5803f">01560</a> <span class="comment"></span>- (CGRect)rectOfColumn:(CPInteger)aColumnIndex
<a name="l01561"></a>01561 {
<a name="l01562"></a>01562     aColumnIndex = +aColumnIndex;
<a name="l01563"></a>01563 
<a name="l01564"></a>01564     <span class="keywordflow">if</span> (aColumnIndex &lt; 0 || aColumnIndex &gt;= <a class="code" href="_c_p_table_view_8j.html#aa0c3e20940452d04b6708ec8b82b482b">NUMBER_OF_COLUMNS</a>())
<a name="l01565"></a>01565         <span class="keywordflow">return</span> _CGRectMakeZero();
<a name="l01566"></a>01566 
<a name="l01567"></a>01567     var column = [[<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#addef4fffbf36e02b399b1fad4425b71e">tableColumns</a>] <a class="code" href="interface_c_p_array.html#a5f4c80df5e0ce9c9c7c64c7c24d917eb">objectAtIndex</a>:aColumnIndex];
<a name="l01568"></a>01568 
<a name="l01569"></a>01569     <span class="keywordflow">if</span> ([column isHidden])
<a name="l01570"></a>01570         <span class="keywordflow">return</span> _CGRectMakeZero();
<a name="l01571"></a>01571 
<a name="l01572"></a>01572     <a class="code" href="_c_p_table_view_8j.html#a8d863ee1b9f1e447c7ee408af11b8f22">UPDATE_COLUMN_RANGES_IF_NECESSARY</a>();
<a name="l01573"></a>01573 
<a name="l01574"></a>01574     var range = _tableColumnRanges[aColumnIndex];
<a name="l01575"></a>01575 
<a name="l01576"></a>01576     <span class="keywordflow">return</span> _CGRectMake(range.location, 0.0, range.length, _CGRectGetHeight([<span class="keyword">self</span> bounds]));
<a name="l01577"></a>01577 }
<a name="l01578"></a>01578 
<a name="l01579"></a>01579 <span class="comment">// Complexity:</span>
<a name="l01580"></a>01580 <span class="comment">// O(1)</span>
<a name="l01588"></a>01588 <span class="comment"></span>- (CGRect)_rectOfRow:(CPInteger)aRowIndex checkRange:(BOOL)checkRange
<a name="l01589"></a>01589 {
<a name="l01590"></a>01590     var lastIndex = [<span class="keyword">self</span> numberOfRows] - 1;
<a name="l01591"></a>01591 
<a name="l01592"></a>01592     <span class="keywordflow">if</span> (checkRange &amp;&amp; (aRowIndex &gt; lastIndex || aRowIndex &lt; 0))
<a name="l01593"></a>01593         <span class="keywordflow">return</span> _CGRectMakeZero();
<a name="l01594"></a>01594 
<a name="l01595"></a>01595     <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#afd61c24dda7ceebc29da34fa3b5f4a3a">CPTableViewDelegate_tableView_heightOfRow_</a>)
<a name="l01596"></a>01596     {
<a name="l01597"></a>01597         var rowToLookUp = MIN(aRowIndex, lastIndex);
<a name="l01598"></a>01598 
<a name="l01599"></a>01599         <span class="comment">// if the row doesn&#39;t exist</span>
<a name="l01600"></a>01600         <span class="keywordflow">if</span> (rowToLookUp !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l01601"></a>01601         {
<a name="l01602"></a>01602             var <a class="code" href="_c_g_geometry_8j.html#afd280cbcc7083735f3a54b092e8cacd8">y</a> = _cachedRowHeights[rowToLookUp].heightAboveRow,
<a name="l01603"></a>01603                 height = _cachedRowHeights[rowToLookUp].height + _intercellSpacing.height,
<a name="l01604"></a>01604                 rowDelta = aRowIndex - rowToLookUp;
<a name="l01605"></a>01605         }
<a name="l01606"></a>01606         <span class="keywordflow">else</span>
<a name="l01607"></a>01607         {
<a name="l01608"></a>01608             <a class="code" href="_c_g_geometry_8j.html#afd280cbcc7083735f3a54b092e8cacd8">y</a> = aRowIndex * (_rowHeight + _intercellSpacing.height);
<a name="l01609"></a>01609             height = _rowHeight + _intercellSpacing.height;
<a name="l01610"></a>01610         }
<a name="l01611"></a>01611 
<a name="l01612"></a>01612         <span class="comment">// if we need the rect of a row past the last index</span>
<a name="l01613"></a>01613         <span class="keywordflow">if</span> (rowDelta &gt; 0)
<a name="l01614"></a>01614         {
<a name="l01615"></a>01615             <a class="code" href="_c_g_geometry_8j.html#afd280cbcc7083735f3a54b092e8cacd8">y</a> += rowDelta * (_rowHeight + _intercellSpacing.height);
<a name="l01616"></a>01616             height = _rowHeight + _intercellSpacing.height;
<a name="l01617"></a>01617         }
<a name="l01618"></a>01618     }
<a name="l01619"></a>01619     <span class="keywordflow">else</span>
<a name="l01620"></a>01620     {
<a name="l01621"></a>01621         var <a class="code" href="_c_g_geometry_8j.html#afd280cbcc7083735f3a54b092e8cacd8">y</a> = aRowIndex * (_rowHeight + _intercellSpacing.height),
<a name="l01622"></a>01622             height = _rowHeight + _intercellSpacing.height;
<a name="l01623"></a>01623     }
<a name="l01624"></a>01624 
<a name="l01625"></a>01625     <span class="keywordflow">return</span> _CGRectMake(0.0, <a class="code" href="_c_g_geometry_8j.html#afd280cbcc7083735f3a54b092e8cacd8">y</a>, _CGRectGetWidth([<span class="keyword">self</span> bounds]), height);
<a name="l01626"></a>01626 }
<a name="l01627"></a>01627 
<a name="l01633"></a><a class="code" href="interface_c_p_table_view.html#abdf1f5cc725acaf6d5734cc535bc8a22">01633</a> - (CGRect)rectOfRow:(CPInteger)aRowIndex
<a name="l01634"></a>01634 {
<a name="l01635"></a>01635     <span class="keywordflow">return</span> [<span class="keyword">self</span> _rectOfRow:aRowIndex checkRange:YES];
<a name="l01636"></a>01636 }
<a name="l01637"></a>01637 
<a name="l01638"></a>01638 <span class="comment">// Complexity:</span>
<a name="l01639"></a>01639 <span class="comment">// O(1)</span>
<a name="l01645"></a><a class="code" href="interface_c_p_table_view.html#a7d9128a2f32c6714364d5217894daa44">01645</a> <span class="comment"></span>- (CPRange)rowsInRect:(CGRect)aRect
<a name="l01646"></a>01646 {
<a name="l01647"></a>01647     <span class="comment">// If we have no rows, then we won&#39;t intersect anything.</span>
<a name="l01648"></a>01648     <span class="keywordflow">if</span> (_numberOfRows &lt;= 0)
<a name="l01649"></a>01649         <span class="keywordflow">return</span> <a class="code" href="group__foundation.html#ga377fec0972facd19d72b8abcffcdb362">CPMakeRange</a>(0, 0);
<a name="l01650"></a>01650 
<a name="l01651"></a>01651     var bounds = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#af0bd55e12e5ac7ea4b137eae5f1829af">bounds</a>];
<a name="l01652"></a>01652 
<a name="l01653"></a>01653     <span class="comment">// No rows if the rect doesn&#39;t even intersect us.</span>
<a name="l01654"></a>01654     <span class="keywordflow">if</span> (!<a class="code" href="group__appkit.html#ga77d150d6cf60ff142fa46dc079e8203a">CGRectIntersectsRect</a>(aRect, bounds))
<a name="l01655"></a>01655         <span class="keywordflow">return</span> <a class="code" href="group__foundation.html#ga377fec0972facd19d72b8abcffcdb362">CPMakeRange</a>(0, 0);
<a name="l01656"></a>01656 
<a name="l01657"></a>01657     var firstRow = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a6f1d4aad7598b4ca189e2a262d51cd08">rowAtPoint</a>:aRect.origin];
<a name="l01658"></a>01658 
<a name="l01659"></a>01659     <span class="comment">// first row has to be undershot, because if not we wouldn&#39;t be intersecting.</span>
<a name="l01660"></a>01660     <span class="keywordflow">if</span> (firstRow &lt; 0)
<a name="l01661"></a>01661         firstRow = 0;
<a name="l01662"></a>01662 
<a name="l01663"></a>01663     var lastRow = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a6f1d4aad7598b4ca189e2a262d51cd08">rowAtPoint</a>:_CGPointMake(0.0, _CGRectGetMaxY(aRect))];
<a name="l01664"></a>01664 
<a name="l01665"></a>01665     <span class="comment">// last row has to be overshot, because if not we wouldn&#39;t be intersecting.</span>
<a name="l01666"></a>01666     <span class="keywordflow">if</span> (lastRow &lt; 0)
<a name="l01667"></a>01667         lastRow = _numberOfRows - 1;
<a name="l01668"></a>01668 
<a name="l01669"></a>01669     <span class="keywordflow">return</span> <a class="code" href="group__foundation.html#ga377fec0972facd19d72b8abcffcdb362">CPMakeRange</a>(firstRow, lastRow - firstRow + 1);
<a name="l01670"></a>01670 }
<a name="l01671"></a>01671 
<a name="l01676"></a>01676 - (CPRange)_unboundedRowsInRect:(CGRect)aRect
<a name="l01677"></a>01677 {
<a name="l01678"></a>01678     var boundedRange = [<span class="keyword">self</span> rowsInRect:aRect],
<a name="l01679"></a>01679         lastRow = <a class="code" href="group__foundation.html#ga9a9c6e53b2b0861cedbb77b5ab72e78f">CPMaxRange</a>(boundedRange),
<a name="l01680"></a>01680         rectOfLastRow = [<span class="keyword">self</span> _rectOfRow:lastRow checkRange:NO],
<a name="l01681"></a>01681         bottom = _CGRectGetMaxY(aRect),
<a name="l01682"></a>01682         bottomOfBoundedRows = _CGRectGetMaxY(rectOfLastRow);
<a name="l01683"></a>01683 
<a name="l01684"></a>01684     <span class="comment">// we only have to worry about the rows below the last...</span>
<a name="l01685"></a>01685     <span class="keywordflow">if</span> (bottom &lt;= bottomOfBoundedRows)
<a name="l01686"></a>01686         <span class="keywordflow">return</span> boundedRange;
<a name="l01687"></a>01687 
<a name="l01688"></a>01688     var numberOfNewRows = CEIL(bottom -  bottomOfBoundedRows) / ([<span class="keyword">self</span> rowHeight] + _intercellSpacing.height);
<a name="l01689"></a>01689 
<a name="l01690"></a>01690     boundedRange.length += numberOfNewRows + 1;
<a name="l01691"></a>01691 
<a name="l01692"></a>01692     <span class="keywordflow">return</span> boundedRange;
<a name="l01693"></a>01693 }
<a name="l01694"></a>01694 
<a name="l01695"></a>01695 <span class="comment">// Complexity:</span>
<a name="l01696"></a>01696 <span class="comment">// O(lg Columns) if table view contains no hidden columns</span>
<a name="l01697"></a>01697 <span class="comment">// O(Columns) if table view contains hidden columns</span>
<a name="l01698"></a>01698 
<a name="l01704"></a><a class="code" href="interface_c_p_table_view.html#a1acdacf678fb91a541b692d378586289">01704</a> - (<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)columnIndexesInRect:(CGRect)aRect
<a name="l01705"></a>01705 {
<a name="l01706"></a>01706     var column = MAX(0, [<span class="keyword">self</span> columnAtPoint:_CGPointMake(aRect.origin.x, 0.0)]),
<a name="l01707"></a>01707         lastColumn = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aa5bce119e8c4b79e4ed0f9a10172996d">columnAtPoint</a>:_CGPointMake(_CGRectGetMaxX(aRect), 0.0)];
<a name="l01708"></a>01708 
<a name="l01709"></a>01709     <span class="keywordflow">if</span> (lastColumn === <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l01710"></a>01710         lastColumn = <a class="code" href="_c_p_table_view_8j.html#aa0c3e20940452d04b6708ec8b82b482b">NUMBER_OF_COLUMNS</a>() - 1;
<a name="l01711"></a>01711 
<a name="l01712"></a>01712     <span class="comment">// Don&#39;t bother doing the expensive removal of hidden indexes if we have no hidden columns.</span>
<a name="l01713"></a>01713     <span class="keywordflow">if</span> (_numberOfHiddenColumns &lt;= 0)
<a name="l01714"></a>01714         <span class="keywordflow">return</span> [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4c32a454bd5323253b9e8c4f81712ea5">indexSetWithIndexesInRange</a>:CPMakeRange(column, lastColumn - column + 1)];
<a name="l01715"></a>01715 
<a name="l01716"></a>01716     <span class="comment">//</span>
<a name="l01717"></a>01717     var indexSet = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l01718"></a>01718 
<a name="l01719"></a>01719     <span class="keywordflow">for</span> (; column &lt;= lastColumn; ++column)
<a name="l01720"></a>01720     {
<a name="l01721"></a>01721         var tableColumn = _tableColumns[column];
<a name="l01722"></a>01722 
<a name="l01723"></a>01723         <span class="keywordflow">if</span> (![tableColumn isHidden])
<a name="l01724"></a>01724             [indexSet addIndex:column];
<a name="l01725"></a>01725     }
<a name="l01726"></a>01726 
<a name="l01727"></a>01727     <span class="keywordflow">return</span> indexSet;
<a name="l01728"></a>01728 }
<a name="l01729"></a>01729 
<a name="l01730"></a>01730 <span class="comment">// Complexity:</span>
<a name="l01731"></a>01731 <span class="comment">// O(lg Columns) if table view contains now hidden columns</span>
<a name="l01732"></a>01732 <span class="comment">// O(Columns) if table view contains hidden columns</span>
<a name="l01738"></a><a class="code" href="interface_c_p_table_view.html#aa5bce119e8c4b79e4ed0f9a10172996d">01738</a> <span class="comment"></span>- (CPInteger)columnAtPoint:(CGPoint)aPoint
<a name="l01739"></a>01739 {
<a name="l01740"></a>01740     var bounds = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#af0bd55e12e5ac7ea4b137eae5f1829af">bounds</a>];
<a name="l01741"></a>01741 
<a name="l01742"></a>01742     <span class="keywordflow">if</span> (!_CGRectContainsPoint(bounds, aPoint))
<a name="l01743"></a>01743         <span class="keywordflow">return</span> <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l01744"></a>01744 
<a name="l01745"></a>01745     <a class="code" href="_c_p_table_view_8j.html#a8d863ee1b9f1e447c7ee408af11b8f22">UPDATE_COLUMN_RANGES_IF_NECESSARY</a>();
<a name="l01746"></a>01746 
<a name="l01747"></a>01747     var x = aPoint.x,
<a name="l01748"></a>01748         low = 0,
<a name="l01749"></a>01749         high = _tableColumnRanges.length - 1;
<a name="l01750"></a>01750 
<a name="l01751"></a>01751     <span class="keywordflow">while</span> (low &lt;= high)
<a name="l01752"></a>01752     {
<a name="l01753"></a>01753         var middle = FLOOR(low + (high - low) / 2),
<a name="l01754"></a>01754             range = _tableColumnRanges[middle];
<a name="l01755"></a>01755 
<a name="l01756"></a>01756         <span class="keywordflow">if</span> (x &lt; range.location)
<a name="l01757"></a>01757             high = middle - 1;
<a name="l01758"></a>01758 
<a name="l01759"></a>01759         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &gt;= <a class="code" href="group__foundation.html#ga9a9c6e53b2b0861cedbb77b5ab72e78f">CPMaxRange</a>(range))
<a name="l01760"></a>01760             low = middle + 1;
<a name="l01761"></a>01761 
<a name="l01762"></a>01762         <span class="keywordflow">else</span>
<a name="l01763"></a>01763         {
<a name="l01764"></a>01764             var numberOfColumns = _tableColumnRanges.length;
<a name="l01765"></a>01765 
<a name="l01766"></a>01766             <span class="keywordflow">while</span> (middle &lt; numberOfColumns &amp;&amp; [_tableColumns[middle] isHidden])
<a name="l01767"></a>01767                 ++middle;
<a name="l01768"></a>01768 
<a name="l01769"></a>01769             <span class="keywordflow">if</span> (middle &lt; numberOfColumns)
<a name="l01770"></a>01770                 <span class="keywordflow">return</span> middle;
<a name="l01771"></a>01771 
<a name="l01772"></a>01772             <span class="keywordflow">return</span> <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l01773"></a>01773         }
<a name="l01774"></a>01774    }
<a name="l01775"></a>01775 
<a name="l01776"></a>01776    <span class="keywordflow">return</span> <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l01777"></a>01777 }
<a name="l01778"></a>01778 
<a name="l01779"></a>01779 <span class="comment">//Complexity</span>
<a name="l01780"></a>01780 <span class="comment">// O(1) for static row height</span>
<a name="l01781"></a>01781 <span class="comment">// 0(lg Rows) for variable row heights</span>
<a name="l01787"></a><a class="code" href="interface_c_p_table_view.html#a6f1d4aad7598b4ca189e2a262d51cd08">01787</a> <span class="comment"></span>- (CPInteger)rowAtPoint:(CGPoint)aPoint
<a name="l01788"></a>01788 {
<a name="l01789"></a>01789     <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#afd61c24dda7ceebc29da34fa3b5f4a3a">CPTableViewDelegate_tableView_heightOfRow_</a>)
<a name="l01790"></a>01790     {
<a name="l01791"></a>01791             <span class="keywordflow">return</span> idx = [_cachedRowHeights indexOfObject:aPoint
<a name="l01792"></a>01792                                             inSortedRange:nil
<a name="l01793"></a>01793                                                   options:0
<a name="l01794"></a>01794                                           usingComparator:function(aPoint, rowCache)
<a name="l01795"></a>01795                     {
<a name="l01796"></a>01796                           var upperBound = rowCache.heightAboveRow;
<a name="l01797"></a>01797 
<a name="l01798"></a>01798                           if (aPoint.y &lt; upperBound)
<a name="l01799"></a>01799                               return CPOrderedAscending;
<a name="l01800"></a>01800 
<a name="l01801"></a>01801                           if (aPoint.y &gt; upperBound + rowCache.height + _intercellSpacing.height)
<a name="l01802"></a>01802                               return CPOrderedDescending;
<a name="l01803"></a>01803 
<a name="l01804"></a>01804                           return CPOrderedSame;
<a name="l01805"></a>01805                     }];
<a name="l01806"></a>01806     }
<a name="l01807"></a>01807 
<a name="l01808"></a>01808     var <a class="code" href="_c_g_geometry_8j.html#afd280cbcc7083735f3a54b092e8cacd8">y</a> = aPoint.y,
<a name="l01809"></a>01809         row = FLOOR(y / (_rowHeight + _intercellSpacing.height));
<a name="l01810"></a>01810 
<a name="l01811"></a>01811     <span class="keywordflow">if</span> (row &gt;= _numberOfRows)
<a name="l01812"></a>01812         <span class="keywordflow">return</span> <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l01813"></a>01813 
<a name="l01814"></a>01814     <span class="keywordflow">return</span> row;
<a name="l01815"></a>01815 }
<a name="l01816"></a>01816 
<a name="l01824"></a><a class="code" href="interface_c_p_table_view.html#afa878164caef6b4c75e2ef5328cc3612">01824</a> - (CGRect)frameOfDataViewAtColumn:(CPInteger)aColumn row:(CPInteger)aRow
<a name="l01825"></a>01825 {
<a name="l01826"></a>01826     <a class="code" href="_c_p_table_view_8j.html#a8d863ee1b9f1e447c7ee408af11b8f22">UPDATE_COLUMN_RANGES_IF_NECESSARY</a>();
<a name="l01827"></a>01827 
<a name="l01828"></a>01828     <span class="keywordflow">if</span> (aColumn &gt; [<span class="keyword">self</span> numberOfColumns] || aRow &gt; [<span class="keyword">self</span> numberOfRows])
<a name="l01829"></a>01829         <span class="keywordflow">return</span> _CGRectMakeZero();
<a name="l01830"></a>01830 
<a name="l01831"></a>01831     var tableColumnRange = _tableColumnRanges[aColumn],
<a name="l01832"></a>01832         rectOfRow = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#abdf1f5cc725acaf6d5734cc535bc8a22">rectOfRow</a>:aRow],
<a name="l01833"></a>01833         leftInset = FLOOR(_intercellSpacing.width / 2.0),
<a name="l01834"></a>01834         topInset = FLOOR(_intercellSpacing.height / 2.0);
<a name="l01835"></a>01835 
<a name="l01836"></a>01836     <span class="keywordflow">return</span> _CGRectMake(tableColumnRange.location + leftInset, _CGRectGetMinY(rectOfRow) + topInset, tableColumnRange.length - _intercellSpacing.width, _CGRectGetHeight(rectOfRow) - _intercellSpacing.height);
<a name="l01837"></a>01837 }
<a name="l01838"></a>01838 
<a name="l01842"></a><a class="code" href="interface_c_p_table_view.html#a644c13b12bccbd4ff2995058bf0f5b36">01842</a> - (void)resizeWithOldSuperviewSize:(CGSize)aSize
<a name="l01843"></a>01843 {
<a name="l01844"></a>01844     [<span class="keyword">super</span> <a class="code" href="interface_c_p_view.html#a87dc2891354aebd1ce694c11ed12001c">resizeWithOldSuperviewSize</a>:aSize];
<a name="l01845"></a>01845 
<a name="l01846"></a>01846     <span class="keywordflow">if</span> (_disableAutomaticResizing)
<a name="l01847"></a>01847         <span class="keywordflow">return</span>;
<a name="l01848"></a>01848 
<a name="l01849"></a>01849     var mask = _columnAutoResizingStyle;
<a name="l01850"></a>01850 
<a name="l01851"></a>01851     <span class="comment">// should we actually do some resizing?</span>
<a name="l01852"></a>01852     <span class="keywordflow">if</span> (!_lastColumnShouldSnap)
<a name="l01853"></a>01853     {
<a name="l01854"></a>01854         <span class="comment">// did the clip view intersect the old tablesize?</span>
<a name="l01855"></a>01855         var superview = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ae7fe2569d290f7eaabdebf5d48cb2745">superview</a>];
<a name="l01856"></a>01856 
<a name="l01857"></a>01857         <span class="keywordflow">if</span> (!superview || ![superview isKindOfClass:[<a class="code" href="interface_c_p_clip_view.html">CPClipView</a> <span class="keyword">class</span>]])
<a name="l01858"></a>01858             <span class="keywordflow">return</span>;
<a name="l01859"></a>01859 
<a name="l01860"></a>01860         var superviewWidth = [superview bounds].size.width,
<a name="l01861"></a>01861             lastColumnMaxX = _CGRectGetMaxX([<span class="keyword">self</span> rectOfColumn:[<span class="keyword">self</span> numberOfColumns] -1]);
<a name="l01862"></a>01862 
<a name="l01863"></a>01863         <span class="comment">// Fix me: this fires on the table setup at times</span>
<a name="l01864"></a>01864         <span class="keywordflow">if</span> (lastColumnMaxX &gt;= superviewWidth &amp;&amp; lastColumnMaxX &lt;= aSize.width || lastColumnMaxX &lt;= superviewWidth &amp;&amp; lastColumnMaxX &gt;= aSize.width)
<a name="l01865"></a>01865             _lastColumnShouldSnap = YES;
<a name="l01866"></a>01866         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mask === <a class="code" href="_c_p_table_view_8j.html#a8f4ff5bd6c8f021a249d46098015f486">CPTableViewUniformColumnAutoresizingStyle</a>)
<a name="l01867"></a>01867             <span class="keywordflow">return</span>;
<a name="l01868"></a>01868     }
<a name="l01869"></a>01869 
<a name="l01870"></a>01870     <span class="keywordflow">if</span> (mask === <a class="code" href="_c_p_table_view_8j.html#a8f4ff5bd6c8f021a249d46098015f486">CPTableViewUniformColumnAutoresizingStyle</a>)
<a name="l01871"></a>01871        [<span class="keyword">self</span> _resizeAllColumnUniformlyWithOldSize:aSize];
<a name="l01872"></a>01872     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mask === <a class="code" href="_c_p_table_view_8j.html#a0f472ac2d7a9f96e5ad5ec35e8d4af3f">CPTableViewLastColumnOnlyAutoresizingStyle</a>)
<a name="l01873"></a>01873         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a0e5f2712415987cf5453e6799ca157ab">sizeLastColumnToFit</a>];
<a name="l01874"></a>01874     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mask === <a class="code" href="_c_p_table_view_8j.html#a2817258659933aa465a18e1798822134">CPTableViewFirstColumnOnlyAutoresizingStyle</a>)
<a name="l01875"></a>01875         [<span class="keyword">self</span> _autoResizeFirstColumn];
<a name="l01876"></a>01876 }
<a name="l01877"></a>01877 
<a name="l01881"></a>01881 - (void)_autoResizeFirstColumn
<a name="l01882"></a>01882 {
<a name="l01883"></a>01883     var superview = [<span class="keyword">self</span> superview];
<a name="l01884"></a>01884 
<a name="l01885"></a>01885     <span class="keywordflow">if</span> (!superview)
<a name="l01886"></a>01886         <span class="keywordflow">return</span>;
<a name="l01887"></a>01887 
<a name="l01888"></a>01888     <a class="code" href="_c_p_table_view_8j.html#a8d863ee1b9f1e447c7ee408af11b8f22">UPDATE_COLUMN_RANGES_IF_NECESSARY</a>();
<a name="l01889"></a>01889 
<a name="l01890"></a>01890     var count = <a class="code" href="_c_p_table_view_8j.html#aa0c3e20940452d04b6708ec8b82b482b">NUMBER_OF_COLUMNS</a>(),
<a name="l01891"></a>01891         columnToResize = nil,
<a name="l01892"></a>01892         totalWidth = 0,
<a name="l01893"></a>01893         i = 0;
<a name="l01894"></a>01894 
<a name="l01895"></a>01895     <span class="keywordflow">for</span> (; i &lt; count; i++)
<a name="l01896"></a>01896     {
<a name="l01897"></a>01897         var column = _tableColumns[i];
<a name="l01898"></a>01898 
<a name="l01899"></a>01899         <span class="keywordflow">if</span> (![column isHidden])
<a name="l01900"></a>01900         {
<a name="l01901"></a>01901             <span class="keywordflow">if</span> (!columnToResize)
<a name="l01902"></a>01902                 columnToResize = column;
<a name="l01903"></a>01903             totalWidth += [column <a class="code" href="_c_g_geometry_8j.html#a52b64513cb182b63f0e848f53bddad9b">width</a>] + _intercellSpacing.<a class="code" href="_c_g_geometry_8j.html#a52b64513cb182b63f0e848f53bddad9b">width</a>;
<a name="l01904"></a>01904         }
<a name="l01905"></a>01905     }
<a name="l01906"></a>01906 
<a name="l01907"></a>01907     <span class="comment">// If there is a visible column</span>
<a name="l01908"></a>01908     <span class="keywordflow">if</span> (columnToResize)
<a name="l01909"></a>01909     {
<a name="l01910"></a>01910         var superviewSize = [superview bounds].size,
<a name="l01911"></a>01911             newWidth = superviewSize.width - totalWidth;
<a name="l01912"></a>01912 
<a name="l01913"></a>01913         newWidth += [columnToResize <a class="code" href="_c_g_geometry_8j.html#a52b64513cb182b63f0e848f53bddad9b">width</a>];
<a name="l01914"></a>01914         [columnToResize _tryToResizeToWidth:newWidth];
<a name="l01915"></a>01915     }
<a name="l01916"></a>01916 
<a name="l01917"></a>01917     [<span class="keyword">self</span> setNeedsLayout];
<a name="l01918"></a>01918 }
<a name="l01919"></a>01919 
<a name="l01920"></a>01920 
<a name="l01925"></a>01925 - (void)_resizeAllColumnUniformlyWithOldSize:(CGSize)oldSize
<a name="l01926"></a>01926 {
<a name="l01927"></a>01927     <span class="comment">// what we care about is the superview clip rect</span>
<a name="l01928"></a>01928     <span class="comment">// FIX ME: if it&#39;s not in a scrollview this doesn&#39;t really work</span>
<a name="l01929"></a>01929     var superview = [<span class="keyword">self</span> superview];
<a name="l01930"></a>01930 
<a name="l01931"></a>01931     <span class="keywordflow">if</span> (!superview || ![superview isKindOfClass:[<a class="code" href="interface_c_p_clip_view.html">CPClipView</a> <span class="keyword">class</span>]])
<a name="l01932"></a>01932         <span class="keywordflow">return</span>;
<a name="l01933"></a>01933 
<a name="l01934"></a>01934     <a class="code" href="_c_p_table_view_8j.html#a8d863ee1b9f1e447c7ee408af11b8f22">UPDATE_COLUMN_RANGES_IF_NECESSARY</a>();
<a name="l01935"></a>01935 
<a name="l01936"></a>01936     var superviewWidth = [superview bounds].size.width,
<a name="l01937"></a>01937         count = <a class="code" href="_c_p_table_view_8j.html#aa0c3e20940452d04b6708ec8b82b482b">NUMBER_OF_COLUMNS</a>(),
<a name="l01938"></a>01938         resizableColumns = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>],
<a name="l01939"></a>01939         remainingSpace = 0.0,
<a name="l01940"></a>01940         i = 0;
<a name="l01941"></a>01941 
<a name="l01942"></a>01942     <span class="comment">// find resizable columns</span>
<a name="l01943"></a>01943     <span class="comment">// FIX ME: we could cache resizableColumns after this loop and reuse it during the resize</span>
<a name="l01944"></a>01944     <span class="keywordflow">for</span> (; i &lt; count; i++)
<a name="l01945"></a>01945     {
<a name="l01946"></a>01946         var tableColumn = _tableColumns[i];
<a name="l01947"></a>01947         <span class="keywordflow">if</span> (![tableColumn isHidden] &amp;&amp; ([tableColumn resizingMask] &amp; <a class="code" href="_c_p_table_column_8j.html#a35f6628b9e962856163170d460cb1623">CPTableColumnAutoresizingMask</a>))
<a name="l01948"></a>01948             [resizableColumns addIndex:i];
<a name="l01949"></a>01949     }
<a name="l01950"></a>01950 
<a name="l01951"></a>01951     var maxXofColumns = _CGRectGetMaxX([<span class="keyword">self</span> rectOfColumn:[resizableColumns lastIndex]]),
<a name="l01952"></a>01952         remainingSpace = superviewWidth - maxXofColumns,
<a name="l01953"></a>01953         resizeableColumnsCount = [resizableColumns count],
<a name="l01954"></a>01954         proportionate = 0;
<a name="l01955"></a>01955 
<a name="l01956"></a>01956     <span class="keywordflow">while</span> (remainingSpace &amp;&amp; resizeableColumnsCount)
<a name="l01957"></a>01957     {
<a name="l01958"></a>01958         <span class="comment">// Divy out the space.</span>
<a name="l01959"></a>01959         proportionate += remainingSpace / resizeableColumnsCount;
<a name="l01960"></a>01960 
<a name="l01961"></a>01961         <span class="comment">// Reset the remaining space to 0</span>
<a name="l01962"></a>01962         remainingSpace = 0.0;
<a name="l01963"></a>01963 
<a name="l01964"></a>01964         var index = <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l01965"></a>01965 
<a name="l01966"></a>01966         <span class="keywordflow">while</span> ((index = [resizableColumns indexGreaterThanIndex:index]) !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l01967"></a>01967         {
<a name="l01968"></a>01968             var item = _tableColumns[index],
<a name="l01969"></a>01969                 proposedWidth = [item width] + proportionate,
<a name="l01970"></a>01970                 resizeLeftovers = [item _tryToResizeToWidth:proposedWidth];
<a name="l01971"></a>01971 
<a name="l01972"></a>01972             <span class="keywordflow">if</span> (resizeLeftovers)
<a name="l01973"></a>01973             {
<a name="l01974"></a>01974                 [resizableColumns removeIndex:index];
<a name="l01975"></a>01975 
<a name="l01976"></a>01976                 remainingSpace += resizeLeftovers;
<a name="l01977"></a>01977             }
<a name="l01978"></a>01978         }
<a name="l01979"></a>01979     }
<a name="l01980"></a>01980 
<a name="l01981"></a>01981     <span class="comment">// now that we&#39;ve reached the end we know there are likely rounding errors</span>
<a name="l01982"></a>01982     <span class="comment">// so we should size the last resized to fit</span>
<a name="l01983"></a>01983 
<a name="l01984"></a>01984     <span class="comment">// find the last visisble column</span>
<a name="l01985"></a>01985     <span class="keywordflow">while</span> (count-- &amp;&amp; [_tableColumns[count] isHidden]);
<a name="l01986"></a>01986 
<a name="l01987"></a>01987     <span class="comment">// find the max x, but subtract a single pixel since the spacing isn&#39;t applicable here.</span>
<a name="l01988"></a>01988     var delta = superviewWidth - _CGRectGetMaxX([self rectOfColumn:count]) - ([self intercellSpacing].<a class="code" href="_c_g_geometry_8j.html#a52b64513cb182b63f0e848f53bddad9b">width</a> || 1),
<a name="l01989"></a>01989         newSize = [item width] + delta;
<a name="l01990"></a>01990 
<a name="l01991"></a>01991     [item _tryToResizeToWidth:newSize];
<a name="l01992"></a>01992 }
<a name="l01993"></a>01993 
<a name="l02005"></a><a class="code" href="interface_c_p_table_view.html#af55c0e265866be064bcd80e80a4d78dc">02005</a> - (void)setColumnAutoresizingStyle:(<span class="keywordtype">unsigned</span>)style
<a name="l02006"></a>02006 {
<a name="l02007"></a>02007     <span class="comment">//FIX ME: CPTableViewSequentialColumnAutoresizingStyle and CPTableViewReverseSequentialColumnAutoresizingStyle are not yet implemented</span>
<a name="l02008"></a>02008     _columnAutoResizingStyle = style;
<a name="l02009"></a>02009 }
<a name="l02010"></a>02010 
<a name="l02014"></a><a class="code" href="interface_c_p_table_view.html#a64904071265deae401474834ea7c6dda">02014</a> - (unsigned)columnAutoresizingStyle
<a name="l02015"></a>02015 {
<a name="l02016"></a>02016     <span class="keywordflow">return</span> _columnAutoResizingStyle;
<a name="l02017"></a>02017 }
<a name="l02018"></a>02018 
<a name="l02022"></a><a class="code" href="interface_c_p_table_view.html#a0e5f2712415987cf5453e6799ca157ab">02022</a> - (void)sizeLastColumnToFit
<a name="l02023"></a>02023 {
<a name="l02024"></a>02024     _lastColumnShouldSnap = YES;
<a name="l02025"></a>02025 
<a name="l02026"></a>02026     var superview = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ae7fe2569d290f7eaabdebf5d48cb2745">superview</a>];
<a name="l02027"></a>02027 
<a name="l02028"></a>02028     <span class="keywordflow">if</span> (!superview)
<a name="l02029"></a>02029         <span class="keywordflow">return</span>;
<a name="l02030"></a>02030 
<a name="l02031"></a>02031     var superviewSize = [superview bounds].size;
<a name="l02032"></a>02032 
<a name="l02033"></a>02033     <a class="code" href="_c_p_table_view_8j.html#a8d863ee1b9f1e447c7ee408af11b8f22">UPDATE_COLUMN_RANGES_IF_NECESSARY</a>();
<a name="l02034"></a>02034 
<a name="l02035"></a>02035     var count = <a class="code" href="_c_p_table_view_8j.html#aa0c3e20940452d04b6708ec8b82b482b">NUMBER_OF_COLUMNS</a>();
<a name="l02036"></a>02036 
<a name="l02037"></a>02037     <span class="comment">// Decrement the counter until we get to the last column that&#39;s not hidden</span>
<a name="l02038"></a>02038     <span class="keywordflow">while</span> (count-- &amp;&amp; [_tableColumns[count] isHidden]);
<a name="l02039"></a>02039 
<a name="l02040"></a>02040     <span class="comment">// If the last column exists</span>
<a name="l02041"></a>02041     <span class="keywordflow">if</span> (count &gt;= 0)
<a name="l02042"></a>02042     {
<a name="l02043"></a>02043         var columnToResize = _tableColumns[count],
<a name="l02044"></a>02044             newSize = MAX(0.0, superviewSize.width - CGRectGetMinX([<span class="keyword">self</span> rectOfColumn:count]) - _intercellSpacing.width);
<a name="l02045"></a>02045 
<a name="l02046"></a>02046         [columnToResize _tryToResizeToWidth:newSize];
<a name="l02047"></a>02047     }
<a name="l02048"></a>02048 
<a name="l02049"></a>02049     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a39431c7a00864c9ddfe57c191fd82ccf">setNeedsLayout</a>];
<a name="l02050"></a>02050 }
<a name="l02051"></a>02051 
<a name="l02055"></a><a class="code" href="interface_c_p_table_view.html#aa1b1194b660a264c3c330892e4f4ffe4">02055</a> - (void)noteNumberOfRowsChanged
<a name="l02056"></a>02056 {
<a name="l02057"></a>02057     var oldNumberOfRows = _numberOfRows;
<a name="l02058"></a>02058 
<a name="l02059"></a>02059     _numberOfRows = nil;
<a name="l02060"></a>02060     _cachedRowHeights = [];
<a name="l02061"></a>02061 
<a name="l02062"></a>02062     <span class="comment">// this line serves two purposes</span>
<a name="l02063"></a>02063     <span class="comment">// 1. it updates the _numberOfRows cache with the -numberOfRows call</span>
<a name="l02064"></a>02064     <span class="comment">// 2. it updates the row height cache if needed</span>
<a name="l02065"></a>02065     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a7cee85fa22beb09e72fad9bf80d5689c">noteHeightOfRowsWithIndexesChanged</a>:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4c32a454bd5323253b9e8c4f81712ea5">indexSetWithIndexesInRange</a>:CPMakeRange(0, [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#ab93d1883609b8aaca737188ee9667c17">numberOfRows</a>])]];
<a name="l02066"></a>02066 
<a name="l02067"></a>02067     <span class="comment">// remove row indexes from the selection if they no longer exist</span>
<a name="l02068"></a>02068     var hangingSelections = oldNumberOfRows - _numberOfRows;
<a name="l02069"></a>02069 
<a name="l02070"></a>02070     <span class="keywordflow">if</span> (hangingSelections &gt; 0)
<a name="l02071"></a>02071     {
<a name="l02072"></a>02072 
<a name="l02073"></a>02073         var previousSelectionCount = [_selectedRowIndexes count];
<a name="l02074"></a>02074         [_selectedRowIndexes removeIndexesInRange:CPMakeRange(_numberOfRows, hangingSelections)];
<a name="l02075"></a>02075 
<a name="l02076"></a>02076         <span class="keywordflow">if</span> (![_selectedRowIndexes containsIndex:[<span class="keyword">self</span> selectedRow]])
<a name="l02077"></a>02077             _lastSelectedRow = <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;
<a name="l02078"></a>02078 
<a name="l02079"></a>02079         <span class="comment">// For optimal performance, only send a notification if indices were actually removed.</span>
<a name="l02080"></a>02080         <span class="keywordflow">if</span> (previousSelectionCount &gt; [_selectedRowIndexes count])
<a name="l02081"></a>02081             [<span class="keyword">self</span> _noteSelectionDidChange];
<a name="l02082"></a>02082     }
<a name="l02083"></a>02083 
<a name="l02084"></a>02084     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#af2af4f3cd8a4020f17c25c64548051ea">tile</a>];
<a name="l02085"></a>02085 }
<a name="l02086"></a>02086 
<a name="l02087"></a>02087 
<a name="l02093"></a><a class="code" href="interface_c_p_table_view.html#a7cee85fa22beb09e72fad9bf80d5689c">02093</a> - (void)noteHeightOfRowsWithIndexesChanged:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)anIndexSet
<a name="l02094"></a>02094 {
<a name="l02095"></a>02095     <span class="keywordflow">if</span> (!(_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#afd61c24dda7ceebc29da34fa3b5f4a3a">CPTableViewDelegate_tableView_heightOfRow_</a>))
<a name="l02096"></a>02096         <span class="keywordflow">return</span>;
<a name="l02097"></a>02097 
<a name="l02098"></a>02098     <span class="comment">// this method will update the height of those rows, but since the cached array also contains</span>
<a name="l02099"></a>02099     <span class="comment">// the height above the row it needs to recalculate for the rows below it too</span>
<a name="l02100"></a>02100     var i = [anIndexSet <a class="code" href="class_c_p_index_set.html#abc895f4b5df7bdaf090161db6b234b73">firstIndex</a>],
<a name="l02101"></a>02101         count = _numberOfRows - i,
<a name="l02102"></a>02102         heightAbove = (i &gt; 0) ? _cachedRowHeights[i - 1].height + _cachedRowHeights[i - 1].heightAboveRow + _intercellSpacing.height : 0;
<a name="l02103"></a>02103 
<a name="l02104"></a>02104     for (; i &lt; count; i++)
<a name="l02105"></a>02105     {
<a name="l02106"></a>02106         <span class="comment">// update the cache if the user told us to</span>
<a name="l02107"></a>02107         <span class="keywordflow">if</span> ([anIndexSet containsIndex:i])
<a name="l02108"></a>02108             var height = [_delegate tableView:self heightOfRow:i];
<a name="l02109"></a>02109 
<a name="l02110"></a>02110             _cachedRowHeights[i] = {<span class="stringliteral">&quot;height&quot;</span>:height, <span class="stringliteral">&quot;heightAboveRow&quot;</span>:heightAbove};
<a name="l02111"></a>02111 
<a name="l02112"></a>02112         heightAbove += height + _intercellSpacing.height;
<a name="l02113"></a>02113     }
<a name="l02114"></a>02114 }
<a name="l02115"></a>02115 
<a name="l02119"></a><a class="code" href="interface_c_p_table_view.html#af2af4f3cd8a4020f17c25c64548051ea">02119</a> - (void)tile
<a name="l02120"></a>02120 {
<a name="l02121"></a>02121     <a class="code" href="_c_p_table_view_8j.html#a8d863ee1b9f1e447c7ee408af11b8f22">UPDATE_COLUMN_RANGES_IF_NECESSARY</a>();
<a name="l02122"></a>02122 
<a name="l02123"></a>02123     var <a class="code" href="_c_g_geometry_8j.html#a52b64513cb182b63f0e848f53bddad9b">width</a> = _tableColumnRanges.length &gt; 0 ? <a class="code" href="group__foundation.html#ga9a9c6e53b2b0861cedbb77b5ab72e78f">CPMaxRange</a>([_tableColumnRanges lastObject]) : 0.0,
<a name="l02124"></a>02124         superview = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ae7fe2569d290f7eaabdebf5d48cb2745">superview</a>];
<a name="l02125"></a>02125 
<a name="l02126"></a>02126     <span class="keywordflow">if</span> (!(_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#afd61c24dda7ceebc29da34fa3b5f4a3a">CPTableViewDelegate_tableView_heightOfRow_</a>))
<a name="l02127"></a>02127         var height =  (_rowHeight + _intercellSpacing.height) * _numberOfRows;
<a name="l02128"></a>02128     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ([<span class="keyword">self</span> numberOfRows] === 0)
<a name="l02129"></a>02129         var height = 0;
<a name="l02130"></a>02130     <span class="keywordflow">else</span>
<a name="l02131"></a>02131     {
<a name="l02132"></a>02132         <span class="comment">// if this is the fist run we need to populate the cache</span>
<a name="l02133"></a>02133         <span class="keywordflow">if</span> ([<span class="keyword">self</span> numberOfRows] !== _cachedRowHeights.length)
<a name="l02134"></a>02134             [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a7cee85fa22beb09e72fad9bf80d5689c">noteHeightOfRowsWithIndexesChanged</a>:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4c32a454bd5323253b9e8c4f81712ea5">indexSetWithIndexesInRange</a>:CPMakeRange(0, [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#ab93d1883609b8aaca737188ee9667c17">numberOfRows</a>])]];
<a name="l02135"></a>02135 
<a name="l02136"></a>02136         var heightObject = _cachedRowHeights[_cachedRowHeights.length - 1],
<a name="l02137"></a>02137             height = heightObject.heightAboveRow + heightObject.height + _intercellSpacing.height;
<a name="l02138"></a>02138 
<a name="l02139"></a>02139     }
<a name="l02140"></a>02140 
<a name="l02141"></a>02141 
<a name="l02142"></a>02142     <span class="keywordflow">if</span> ([superview isKindOfClass:[CPClipView <span class="keyword">class</span>]])
<a name="l02143"></a>02143     {
<a name="l02144"></a>02144         var superviewSize = [superview bounds].size;
<a name="l02145"></a>02145 
<a name="l02146"></a>02146         width = MAX(superviewSize.width, width);
<a name="l02147"></a>02147         height = MAX(superviewSize.height, height);
<a name="l02148"></a>02148     }
<a name="l02149"></a>02149 
<a name="l02150"></a>02150     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a2f8731a826f57388dba260fa2ccc64eb">setFrameSize</a>:_CGSizeMake(width, height)];
<a name="l02151"></a>02151 
<a name="l02152"></a>02152     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a39431c7a00864c9ddfe57c191fd82ccf">setNeedsLayout</a>];
<a name="l02153"></a>02153     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a31af19dc321476a95414cd5e5da60ef0">setNeedsDisplay</a>:YES];
<a name="l02154"></a>02154 }
<a name="l02155"></a>02155 
<a name="l02156"></a>02156 
<a name="l02162"></a><a class="code" href="interface_c_p_table_view.html#aac2521d3f258b8a58f3357756a5b830f">02162</a> - (void)scrollRowToVisible:(<span class="keywordtype">int</span>)rowIndex
<a name="l02163"></a>02163 {
<a name="l02164"></a>02164     var visible = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a3db250b9d8cd9a1d4b244e104fcd589e">visibleRect</a>],
<a name="l02165"></a>02165         rowRect = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#abdf1f5cc725acaf6d5734cc535bc8a22">rectOfRow</a>:rowIndex];
<a name="l02166"></a>02166 
<a name="l02167"></a>02167     visible.origin.y = rowRect.origin.y;
<a name="l02168"></a>02168     visible.size.height = rowRect.size.height;
<a name="l02169"></a>02169 
<a name="l02170"></a>02170     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a606811544e89614227b2e39735aa5937">scrollRectToVisible</a>:visible];
<a name="l02171"></a>02171 }
<a name="l02172"></a>02172 
<a name="l02178"></a><a class="code" href="interface_c_p_table_view.html#a2ffae1b91fadd2aa6055af8b2be802d8">02178</a> - (void)scrollColumnToVisible:(<span class="keywordtype">int</span>)columnIndex
<a name="l02179"></a>02179 {
<a name="l02180"></a>02180     var visible = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a3db250b9d8cd9a1d4b244e104fcd589e">visibleRect</a>],
<a name="l02181"></a>02181         colRect = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#af86aacec5d36506c1fee17f1fab5803f">rectOfColumn</a>:columnIndex];
<a name="l02182"></a>02182 
<a name="l02183"></a>02183     visible.origin.x = colRect.origin.x;
<a name="l02184"></a>02184     visible.size.width = colRect.size.width;
<a name="l02185"></a>02185 
<a name="l02186"></a>02186     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a606811544e89614227b2e39735aa5937">scrollRectToVisible</a>:visible];
<a name="l02187"></a>02187     [_headerView scrollRectToVisible:colRect];
<a name="l02188"></a>02188 }
<a name="l02189"></a>02189 
<a name="l02196"></a><a class="code" href="interface_c_p_table_view.html#a13be1e95519d062c419a1e8e321bc81e">02196</a> - (void)setAutosaveName:(<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)theAutosaveName
<a name="l02197"></a>02197 {
<a name="l02198"></a>02198     <span class="keywordflow">if</span> (_autosaveName === theAutosaveName)
<a name="l02199"></a>02199         <span class="keywordflow">return</span>;
<a name="l02200"></a>02200 
<a name="l02201"></a>02201     _autosaveName = theAutosaveName;
<a name="l02202"></a>02202 
<a name="l02203"></a>02203     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a3c7ef0682e178b6b27e544140f8fe893">setAutosaveTableColumns</a>:!!theAutosaveName];
<a name="l02204"></a>02204     [<span class="keyword">self</span> _restoreFromAutosave];
<a name="l02205"></a>02205 }
<a name="l02206"></a>02206 
<a name="l02210"></a><a class="code" href="interface_c_p_table_view.html#a58a74c4a749e5cadbf74f6b9bdeed06c">02210</a> - (<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)autosaveName
<a name="l02211"></a>02211 {
<a name="l02212"></a>02212     <span class="keywordflow">return</span> _autosaveName;
<a name="l02213"></a>02213 }
<a name="l02214"></a>02214 
<a name="l02221"></a><a class="code" href="interface_c_p_table_view.html#a3c7ef0682e178b6b27e544140f8fe893">02221</a> - (void)setAutosaveTableColumns:(BOOL)shouldAutosave
<a name="l02222"></a>02222 {
<a name="l02223"></a>02223     _autosaveTableColumns = shouldAutosave;
<a name="l02224"></a>02224 }
<a name="l02225"></a>02225 
<a name="l02229"></a><a class="code" href="interface_c_p_table_view.html#aef9d0bb4008c7445f4f34221c81234ff">02229</a> - (BOOL)autosaveTableColumns
<a name="l02230"></a>02230 {
<a name="l02231"></a>02231     <span class="keywordflow">return</span> _autosaveTableColumns;
<a name="l02232"></a>02232 }
<a name="l02233"></a>02233 
<a name="l02237"></a>02237 - (<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)_columnsKeyForAutosaveName:(<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)theAutosaveName
<a name="l02238"></a>02238 {
<a name="l02239"></a>02239     <span class="keywordflow">return</span> <span class="stringliteral">@&quot;CPTableView Columns &quot;</span> + theAutosaveName;
<a name="l02240"></a>02240 }
<a name="l02241"></a>02241 
<a name="l02245"></a>02245 - (BOOL)_autosaveEnabled
<a name="l02246"></a>02246 {
<a name="l02247"></a>02247     <span class="keywordflow">return</span> [<span class="keyword">self</span> autosaveName] &amp;&amp; [<span class="keyword">self</span> autosaveTableColumns];
<a name="l02248"></a>02248 }
<a name="l02249"></a>02249 
<a name="l02256"></a>02256 - (void)_autosave
<a name="l02257"></a>02257 {
<a name="l02258"></a>02258     <span class="keywordflow">if</span> (![<span class="keyword">self</span> _autosaveEnabled])
<a name="l02259"></a>02259         <span class="keywordflow">return</span>;
<a name="l02260"></a>02260 
<a name="l02261"></a>02261     var userDefaults = [<a class="code" href="interface_c_p_user_defaults.html">CPUserDefaults</a> <a class="code" href="interface_c_p_user_defaults.html#ad45201f6dc324ebebf4c59fab27c89fc">standardUserDefaults</a>],
<a name="l02262"></a>02262         autosaveName = [<span class="keyword">self</span> autosaveName];
<a name="l02263"></a>02263 
<a name="l02264"></a>02264     var columns = [<span class="keyword">self</span> tableColumns],
<a name="l02265"></a>02265         columnsSetup = [];
<a name="l02266"></a>02266 
<a name="l02267"></a>02267     <span class="keywordflow">for</span> (var i = 0; i &lt; [columns count]; i++)
<a name="l02268"></a>02268     {
<a name="l02269"></a>02269         var column = [columns objectAtIndex:i],
<a name="l02270"></a>02270             metaData = [<a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection.">CPDictionary</a> <a class="code" href="interface_c_p_dictionary.html#af3f965a2558cda2103166cf623a40527">dictionaryWithJSObject</a>:{
<a name="l02271"></a>02271             @&quot;identifier&quot;: [column identifier],
<a name="l02272"></a>02272             @&quot;width&quot;: [column width]
<a name="l02273"></a>02273             }];
<a name="l02274"></a>02274 
<a name="l02275"></a>02275         [columnsSetup addObject:metaData];
<a name="l02276"></a>02276     }
<a name="l02277"></a>02277 
<a name="l02278"></a>02278     [userDefaults setObject:columnsSetup forKey:[<span class="keyword">self</span> _columnsKeyForAutosaveName:autosaveName]];
<a name="l02279"></a>02279 }
<a name="l02280"></a>02280 
<a name="l02284"></a>02284 - (void)_restoreFromAutosave
<a name="l02285"></a>02285 {
<a name="l02286"></a>02286     <span class="keywordflow">if</span> (![<span class="keyword">self</span> _autosaveEnabled])
<a name="l02287"></a>02287         <span class="keywordflow">return</span>;
<a name="l02288"></a>02288 
<a name="l02289"></a>02289     var userDefaults = [<a class="code" href="interface_c_p_user_defaults.html">CPUserDefaults</a> <a class="code" href="interface_c_p_user_defaults.html#ad45201f6dc324ebebf4c59fab27c89fc">standardUserDefaults</a>],
<a name="l02290"></a>02290         autosaveName = [<span class="keyword">self</span> autosaveName],
<a name="l02291"></a>02291         tableColumns = [userDefaults objectForKey:[<span class="keyword">self</span> _columnsKeyForAutosaveName:autosaveName]];
<a name="l02292"></a>02292 
<a name="l02293"></a>02293     <span class="keywordflow">for</span> (var i = 0; i &lt; [tableColumns count]; i++)
<a name="l02294"></a>02294     {
<a name="l02295"></a>02295         var metaData = [tableColumns objectAtIndex:i],
<a name="l02296"></a>02296             columnIdentifier = [metaData objectForKey:@&quot;identifier&quot;],
<a name="l02297"></a>02297             column = [<span class="keyword">self</span> columnWithIdentifier:columnIdentifier],
<a name="l02298"></a>02298             tableColumn = [<span class="keyword">self</span> tableColumnWithIdentifier:columnIdentifier];
<a name="l02299"></a>02299 
<a name="l02300"></a>02300         [<span class="keyword">self</span> _moveColumn:column toColumn:i];
<a name="l02301"></a>02301         [tableColumn setWidth:[metaData objectForKey:@&quot;width&quot;]];
<a name="l02302"></a>02302     }
<a name="l02303"></a>02303 }
<a name="l02304"></a>02304 
<a name="l02305"></a>02305 
<a name="l02443"></a><a class="code" href="interface_c_p_table_view.html#ad35bac24324e17ec66afbafce1a6e597">02443</a> - (void)setDelegate:(<span class="keywordtype">id</span>)aDelegate
<a name="l02444"></a>02444 {
<a name="l02445"></a>02445     <span class="keywordflow">if</span> (_delegate === aDelegate)
<a name="l02446"></a>02446         <span class="keywordflow">return</span>;
<a name="l02447"></a>02447 
<a name="l02448"></a>02448     var defaultCenter = [<a class="code" href="interface_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="interface_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>];
<a name="l02449"></a>02449 
<a name="l02450"></a>02450     <span class="keywordflow">if</span> (_delegate)
<a name="l02451"></a>02451     {
<a name="l02452"></a>02452         <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(tableViewColumnDidMove:)])
<a name="l02453"></a>02453             [defaultCenter
<a name="l02454"></a>02454                 removeObserver:_delegate
<a name="l02455"></a>02455                           name:<a class="code" href="_c_p_table_view_8j.html#a6db94aeda7d0b1f024686ab91d7a9fbd">CPTableViewColumnDidMoveNotification</a>
<a name="l02456"></a>02456                         <span class="keywordtype">object</span>:<span class="keyword">self</span>];
<a name="l02457"></a>02457 
<a name="l02458"></a>02458         <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(tableViewColumnDidResize:)])
<a name="l02459"></a>02459             [defaultCenter
<a name="l02460"></a>02460                 removeObserver:_delegate
<a name="l02461"></a>02461                           name:<a class="code" href="_c_p_table_view_8j.html#ad35f7c5fbd420b1766b470df7df236ed">CPTableViewColumnDidResizeNotification</a>
<a name="l02462"></a>02462                         <span class="keywordtype">object</span>:<span class="keyword">self</span>];
<a name="l02463"></a>02463 
<a name="l02464"></a>02464         <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(tableViewSelectionDidChange:)])
<a name="l02465"></a>02465             [defaultCenter
<a name="l02466"></a>02466                 removeObserver:_delegate
<a name="l02467"></a>02467                           name:<a class="code" href="_c_p_table_view_8j.html#a51f328a6630fa3c37dd97e3ebcd47bad">CPTableViewSelectionDidChangeNotification</a>
<a name="l02468"></a>02468                         <span class="keywordtype">object</span>:<span class="keyword">self</span>];
<a name="l02469"></a>02469 
<a name="l02470"></a>02470         <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(tableViewSelectionIsChanging:)])
<a name="l02471"></a>02471             [defaultCenter
<a name="l02472"></a>02472                 removeObserver:_delegate
<a name="l02473"></a>02473                           name:<a class="code" href="_c_p_table_view_8j.html#a05ad281074c809f38e75ada2b2ac510f">CPTableViewSelectionIsChangingNotification</a>
<a name="l02474"></a>02474                         <span class="keywordtype">object</span>:<span class="keyword">self</span>];
<a name="l02475"></a>02475     }
<a name="l02476"></a>02476 
<a name="l02477"></a>02477     _delegate = aDelegate;
<a name="l02478"></a>02478     _implementedDelegateMethods = 0;
<a name="l02479"></a>02479 
<a name="l02480"></a>02480     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(selectionShouldChangeInTableView:)])
<a name="l02481"></a>02481         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a17dd3c2f77d47e02db83a2643962e03f">CPTableViewDelegate_selectionShouldChangeInTableView_</a>;
<a name="l02482"></a>02482 
<a name="l02483"></a>02483     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:dataViewForTableColumn:row:)])
<a name="l02484"></a>02484         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a50ccc5dbd574a129aca4b61924308813">CPTableViewDelegate_tableView_dataViewForTableColumn_row_</a>;
<a name="l02485"></a>02485 
<a name="l02486"></a>02486     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:didClickTableColumn:)])
<a name="l02487"></a>02487         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a11302327c1511f3a71d93e494794c655">CPTableViewDelegate_tableView_didClickTableColumn_</a>;
<a name="l02488"></a>02488 
<a name="l02489"></a>02489     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:didDragTableColumn:)])
<a name="l02490"></a>02490         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#ac6764797b21b0862c8ea1223c05626c2">CPTableViewDelegate_tableView_didDragTableColumn_</a>;
<a name="l02491"></a>02491 
<a name="l02492"></a>02492     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:heightOfRow:)])
<a name="l02493"></a>02493         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#afd61c24dda7ceebc29da34fa3b5f4a3a">CPTableViewDelegate_tableView_heightOfRow_</a>;
<a name="l02494"></a>02494 
<a name="l02495"></a>02495     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:isGroupRow:)])
<a name="l02496"></a>02496         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a1b2d38c75129c936b93b4163a5a32889">CPTableViewDelegate_tableView_isGroupRow_</a>;
<a name="l02497"></a>02497 
<a name="l02498"></a>02498     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:mouseDownInHeaderOfTableColumn:)])
<a name="l02499"></a>02499         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a53db520f3c6c396184ef32c5a586b027">CPTableViewDelegate_tableView_mouseDownInHeaderOfTableColumn_</a>;
<a name="l02500"></a>02500 
<a name="l02501"></a>02501     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:nextTypeSelectMatchFromRow:toRow:forString:)])
<a name="l02502"></a>02502         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#abf8671c1652c48238dc5c04fc9550a62">CPTableViewDelegate_tableView_nextTypeSelectMatchFromRow_toRow_forString_</a>;
<a name="l02503"></a>02503 
<a name="l02504"></a>02504     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:selectionIndexesForProposedSelection:)])
<a name="l02505"></a>02505         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a87a639d266ecdd1db204b2b3e3d0e97d">CPTableViewDelegate_tableView_selectionIndexesForProposedSelection_</a>;
<a name="l02506"></a>02506 
<a name="l02507"></a>02507     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:shouldEditTableColumn:row:)])
<a name="l02508"></a>02508         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a13a5d77ea463b7ee16d106bdf440baef">CPTableViewDelegate_tableView_shouldEditTableColumn_row_</a>;
<a name="l02509"></a>02509 
<a name="l02510"></a>02510     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:shouldSelectRow:)])
<a name="l02511"></a>02511         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#aaea951ab19dc11a096a69b28cc216e38">CPTableViewDelegate_tableView_shouldSelectRow_</a>;
<a name="l02512"></a>02512 
<a name="l02513"></a>02513     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:shouldSelectTableColumn:)])
<a name="l02514"></a>02514         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a40e46e56c68f00ce2e3fe0c2dce75577">CPTableViewDelegate_tableView_shouldSelectTableColumn_</a>;
<a name="l02515"></a>02515 
<a name="l02516"></a>02516     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:shouldShowViewExpansionForTableColumn:row:)])
<a name="l02517"></a>02517         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a47c3d5fa0d018996943ef98b80ffd3ed">CPTableViewDelegate_tableView_shouldShowViewExpansionForTableColumn_row_</a>;
<a name="l02518"></a>02518 
<a name="l02519"></a>02519     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:shouldTrackView:forTableColumn:row:)])
<a name="l02520"></a>02520         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a84373538a8878335c8efedfc6a73dfda">CPTableViewDelegate_tableView_shouldTrackView_forTableColumn_row_</a>;
<a name="l02521"></a>02521 
<a name="l02522"></a>02522     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:shouldTypeSelectForEvent:withCurrentSearchString:)])
<a name="l02523"></a>02523         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a90bdeeee16a3591df2596384e4f627e3">CPTableViewDelegate_tableView_shouldTypeSelectForEvent_withCurrentSearchString_</a>;
<a name="l02524"></a>02524 
<a name="l02525"></a>02525     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:toolTipForView:rect:tableColumn:row:mouseLocation:)])
<a name="l02526"></a>02526         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a106983f227bb2afdff8e05449a4ea33a">CPTableViewDelegate_tableView_toolTipForView_rect_tableColumn_row_mouseLocation_</a>;
<a name="l02527"></a>02527 
<a name="l02528"></a>02528     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:typeSelectStringForTableColumn:row:)])
<a name="l02529"></a>02529         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#a8a84faf4826019c8a187588890360704">CPTableViewDelegate_tableView_typeSelectStringForTableColumn_row_</a>;
<a name="l02530"></a>02530 
<a name="l02531"></a>02531     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:willDisplayView:forTableColumn:row:)])
<a name="l02532"></a>02532         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#ad543a1b68132942313c20a9414cb508c">CPTableViewDelegate_tableView_willDisplayView_forTableColumn_row_</a>;
<a name="l02533"></a>02533 
<a name="l02534"></a>02534     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:menuForTableColumn:row:)])
<a name="l02535"></a>02535         _implementedDelegateMethods |= <a class="code" href="_c_p_table_view_8j.html#aa51e2e3e077c35d99ca7b87d83e2eb01">CPTableViewDelegate_tableViewMenuForTableColumn_Row_</a>;
<a name="l02536"></a>02536 
<a name="l02537"></a>02537     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(tableViewColumnDidMove:)])
<a name="l02538"></a>02538         [defaultCenter
<a name="l02539"></a>02539             addObserver:_delegate
<a name="l02540"></a>02540             selector:<span class="keyword">@selector</span>(tableViewColumnDidMove:)
<a name="l02541"></a>02541             name:<a class="code" href="_c_p_table_view_8j.html#a6db94aeda7d0b1f024686ab91d7a9fbd">CPTableViewColumnDidMoveNotification</a>
<a name="l02542"></a>02542             <span class="keywordtype">object</span>:<span class="keyword">self</span>];
<a name="l02543"></a>02543 
<a name="l02544"></a>02544     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(tableViewColumnDidResize:)])
<a name="l02545"></a>02545         [defaultCenter
<a name="l02546"></a>02546             addObserver:_delegate
<a name="l02547"></a>02547             selector:<span class="keyword">@selector</span>(tableViewColumnDidResize:)
<a name="l02548"></a>02548             name:<a class="code" href="_c_p_table_view_8j.html#ad35f7c5fbd420b1766b470df7df236ed">CPTableViewColumnDidResizeNotification</a>
<a name="l02549"></a>02549             <span class="keywordtype">object</span>:<span class="keyword">self</span>];
<a name="l02550"></a>02550 
<a name="l02551"></a>02551     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(tableViewSelectionDidChange:)])
<a name="l02552"></a>02552         [defaultCenter
<a name="l02553"></a>02553             addObserver:_delegate
<a name="l02554"></a>02554             selector:<span class="keyword">@selector</span>(tableViewSelectionDidChange:)
<a name="l02555"></a>02555             name:<a class="code" href="_c_p_table_view_8j.html#a51f328a6630fa3c37dd97e3ebcd47bad">CPTableViewSelectionDidChangeNotification</a>
<a name="l02556"></a>02556             <span class="keywordtype">object</span>:<span class="keyword">self</span>];
<a name="l02557"></a>02557 
<a name="l02558"></a>02558     <span class="keywordflow">if</span> ([_delegate respondsToSelector:<span class="keyword">@selector</span>(tableViewSelectionIsChanging:)])
<a name="l02559"></a>02559         [defaultCenter
<a name="l02560"></a>02560             addObserver:_delegate
<a name="l02561"></a>02561             selector:<span class="keyword">@selector</span>(tableViewSelectionIsChanging:)
<a name="l02562"></a>02562             name:<a class="code" href="_c_p_table_view_8j.html#a05ad281074c809f38e75ada2b2ac510f">CPTableViewSelectionIsChangingNotification</a>
<a name="l02563"></a>02563             <span class="keywordtype">object</span>:<span class="keyword">self</span>];
<a name="l02564"></a>02564 }
<a name="l02565"></a>02565 
<a name="l02569"></a><a class="code" href="interface_c_p_table_view.html#a2d965d92f1eadcfbd2d98bc750c32c92">02569</a> - (id)delegate
<a name="l02570"></a>02570 {
<a name="l02571"></a>02571     <span class="keywordflow">return</span> _delegate;
<a name="l02572"></a>02572 }
<a name="l02573"></a>02573 
<a name="l02577"></a>02577 - (void)_sendDelegateDidClickColumn:(<span class="keywordtype">int</span>)column
<a name="l02578"></a>02578 {
<a name="l02579"></a>02579     <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a11302327c1511f3a71d93e494794c655">CPTableViewDelegate_tableView_didClickTableColumn_</a>)
<a name="l02580"></a>02580             [_delegate <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:<span class="keyword">self</span> didClickTableColumn:_tableColumns[column]];
<a name="l02581"></a>02581 }
<a name="l02582"></a>02582 
<a name="l02586"></a>02586 - (void)_sendDelegateDidDragColumn:(<span class="keywordtype">int</span>)column
<a name="l02587"></a>02587 {
<a name="l02588"></a>02588     <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#ac6764797b21b0862c8ea1223c05626c2">CPTableViewDelegate_tableView_didDragTableColumn_</a>)
<a name="l02589"></a>02589             [_delegate <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:<span class="keyword">self</span> didDragTableColumn:_tableColumns[column]];
<a name="l02590"></a>02590 }
<a name="l02591"></a>02591 
<a name="l02592"></a>02592 - (void)_sendDelegateDidMouseDownInHeader:(<span class="keywordtype">int</span>)column
<a name="l02593"></a>02593 {
<a name="l02594"></a>02594     <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a53db520f3c6c396184ef32c5a586b027">CPTableViewDelegate_tableView_mouseDownInHeaderOfTableColumn_</a>)
<a name="l02595"></a>02595             [_delegate <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:<span class="keyword">self</span> mouseDownInHeaderOfTableColumn:_tableColumns[column]];
<a name="l02596"></a>02596 }
<a name="l02597"></a>02597 
<a name="l02598"></a>02598 <span class="comment">/*</span>
<a name="l02599"></a>02599 <span class="comment">    @ignore</span>
<a name="l02600"></a>02600 <span class="comment">*/</span>
<a name="l02601"></a>02601 - (BOOL)_sendDelegateDeleteKeyPressed
<a name="l02602"></a>02602 {
<a name="l02603"></a>02603     <span class="keywordflow">if</span> ([_delegate respondsToSelector: <span class="keyword">@selector</span>(tableViewDeleteKeyPressed:)])
<a name="l02604"></a>02604     {
<a name="l02605"></a>02605         [_delegate tableViewDeleteKeyPressed:self];
<a name="l02606"></a>02606         <span class="keywordflow">return</span> YES;
<a name="l02607"></a>02607     }
<a name="l02608"></a>02608 
<a name="l02609"></a>02609     <span class="keywordflow">return</span> NO;
<a name="l02610"></a>02610 }
<a name="l02611"></a>02611 
<a name="l02612"></a>02612 
<a name="l02616"></a>02616 - (void)_sendDataSourceSortDescriptorsDidChange:(<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>)oldDescriptors
<a name="l02617"></a>02617 {
<a name="l02618"></a>02618     <span class="keywordflow">if</span> (_implementedDataSourceMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a3270c812883a130ed7efbc0f119a8ec7">CPTableViewDataSource_tableView_sortDescriptorsDidChange_</a>)
<a name="l02619"></a>02619         [_dataSource <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:<span class="keyword">self</span> sortDescriptorsDidChange:oldDescriptors];
<a name="l02620"></a>02620 }
<a name="l02621"></a>02621 
<a name="l02622"></a>02622 
<a name="l02626"></a>02626 - (void)_didClickTableColumn:(<span class="keywordtype">int</span>)clickedColumn modifierFlags:(<span class="keywordtype">unsigned</span>)modifierFlags
<a name="l02627"></a>02627 {
<a name="l02628"></a>02628     [<span class="keyword">self</span> _sendDelegateDidClickColumn:clickedColumn];
<a name="l02629"></a>02629 
<a name="l02630"></a>02630     <span class="keywordflow">if</span> (_allowsColumnSelection)
<a name="l02631"></a>02631     {
<a name="l02632"></a>02632         [<span class="keyword">self</span> _noteSelectionIsChanging];
<a name="l02633"></a>02633         <span class="keywordflow">if</span> (modifierFlags &amp; <a class="code" href="_c_p_event_8j.html#a675a3ab6cfc14dd4ad6702d7c682c7fe">CPCommandKeyMask</a>)
<a name="l02634"></a>02634         {
<a name="l02635"></a>02635             <span class="keywordflow">if</span> ([<span class="keyword">self</span> isColumnSelected:clickedColumn])
<a name="l02636"></a>02636                 [<span class="keyword">self</span> deselectColumn:clickedColumn];
<a name="l02637"></a>02637             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ([<span class="keyword">self</span> allowsMultipleSelection] == YES)
<a name="l02638"></a>02638                 [<span class="keyword">self</span> selectColumnIndexes:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> indexSetWithIndex:clickedColumn] byExtendingSelection:YES];
<a name="l02639"></a>02639 
<a name="l02640"></a>02640             <span class="keywordflow">return</span>;
<a name="l02641"></a>02641         }
<a name="l02642"></a>02642         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (modifierFlags &amp; <a class="code" href="_c_p_event_8j.html#a2343191b34b38dc1952bb44d83fa30d6">CPShiftKeyMask</a>)
<a name="l02643"></a>02643         {
<a name="l02644"></a>02644         <span class="comment">// should be from clickedColumn to lastClickedColum with extending:(direction == previous selection)</span>
<a name="l02645"></a>02645             var startColumn = MIN(clickedColumn, [_selectedColumnIndexes lastIndex]),
<a name="l02646"></a>02646                 endColumn = MAX(clickedColumn, [_selectedColumnIndexes firstIndex]);
<a name="l02647"></a>02647 
<a name="l02648"></a>02648             [<span class="keyword">self</span> selectColumnIndexes:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4c32a454bd5323253b9e8c4f81712ea5">indexSetWithIndexesInRange</a>:CPMakeRange(startColumn, endColumn - startColumn + 1)]
<a name="l02649"></a>02649                  <a class="code" href="interface_c_p_table_view.html#aea838609fe453ae9ed670d98c3c4ff04">byExtendingSelection</a>:YES];
<a name="l02650"></a>02650 
<a name="l02651"></a>02651             <span class="keywordflow">return</span>;
<a name="l02652"></a>02652         }
<a name="l02653"></a>02653         <span class="keywordflow">else</span>
<a name="l02654"></a>02654             [<span class="keyword">self</span> selectColumnIndexes:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:clickedColumn] <a class="code" href="interface_c_p_table_view.html#aea838609fe453ae9ed670d98c3c4ff04">byExtendingSelection</a>:NO];
<a name="l02655"></a>02655     }
<a name="l02656"></a>02656 
<a name="l02657"></a>02657     [<span class="keyword">self</span> _changeSortDescriptorsForClickOnColumn:clickedColumn];
<a name="l02658"></a>02658 }
<a name="l02659"></a>02659 
<a name="l02660"></a>02660 <span class="comment">// From GNUSTEP</span>
<a name="l02664"></a>02664 <span class="comment"></span>- (void)_changeSortDescriptorsForClickOnColumn:(<span class="keywordtype">int</span>)column
<a name="l02665"></a>02665 {
<a name="l02666"></a>02666     var tableColumn = [_tableColumns objectAtIndex:column],
<a name="l02667"></a>02667         newMainSortDescriptor = [tableColumn sortDescriptorPrototype];
<a name="l02668"></a>02668 
<a name="l02669"></a>02669     <span class="keywordflow">if</span> (!newMainSortDescriptor)
<a name="l02670"></a>02670        <span class="keywordflow">return</span>;
<a name="l02671"></a>02671 
<a name="l02672"></a>02672     var oldMainSortDescriptor = nil,
<a name="l02673"></a>02673         oldSortDescriptors = [<span class="keyword">self</span> sortDescriptors],
<a name="l02674"></a>02674         newSortDescriptors = [<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a> <a class="code" href="interface_c_p_array.html#a4811e54ee87ec16819a86d24523308db">arrayWithArray</a>:oldSortDescriptors],
<a name="l02675"></a>02675 
<a name="l02676"></a>02676         e = [newSortDescriptors objectEnumerator],
<a name="l02677"></a>02677         descriptor = nil,
<a name="l02678"></a>02678         outdatedDescriptors = [<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a> <a class="code" href="interface_c_p_array.html#aafeaf98dd280821940da2ec8be05b776">array</a>];
<a name="l02679"></a>02679 
<a name="l02680"></a>02680     <span class="keywordflow">if</span> ([_sortDescriptors count] &gt; 0)
<a name="l02681"></a>02681         oldMainSortDescriptor = [[<span class="keyword">self</span> sortDescriptors] objectAtIndex: 0];
<a name="l02682"></a>02682 
<a name="l02683"></a>02683     <span class="comment">// Remove every main descriptor equivalents (normally only one)</span>
<a name="l02684"></a>02684     <span class="keywordflow">while</span> ((descriptor = [e nextObject]) != nil)
<a name="l02685"></a>02685     {
<a name="l02686"></a>02686         <span class="keywordflow">if</span> ([[descriptor key] isEqual: [newMainSortDescriptor key]])
<a name="l02687"></a>02687             [outdatedDescriptors addObject:descriptor];
<a name="l02688"></a>02688     }
<a name="l02689"></a>02689 
<a name="l02690"></a>02690     <span class="comment">// Invert the sort direction when the same column header is clicked twice</span>
<a name="l02691"></a>02691     <span class="keywordflow">if</span> ([[newMainSortDescriptor key] isEqual:[oldMainSortDescriptor key]])
<a name="l02692"></a>02692         newMainSortDescriptor = [oldMainSortDescriptor reversedSortDescriptor];
<a name="l02693"></a>02693 
<a name="l02694"></a>02694     [newSortDescriptors removeObjectsInArray:outdatedDescriptors];
<a name="l02695"></a>02695     [newSortDescriptors insertObject:newMainSortDescriptor atIndex:0];
<a name="l02696"></a>02696 
<a name="l02697"></a>02697     [<span class="keyword">self</span> setHighlightedTableColumn:tableColumn];
<a name="l02698"></a>02698     [<span class="keyword">self</span> setSortDescriptors:newSortDescriptors];
<a name="l02699"></a>02699 }
<a name="l02700"></a>02700 
<a name="l02709"></a><a class="code" href="interface_c_p_table_view.html#af9691a3301ba43ac53f9e8f2333476a4">02709</a> - (void)setIndicatorImage:(<a class="code" href="interface_c_p_image.html">CPImage</a>)anImage inTableColumn:(<a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>)aTableColumn
<a name="l02710"></a>02710 {
<a name="l02711"></a>02711     <span class="keywordflow">if</span> (aTableColumn)
<a name="l02712"></a>02712     {
<a name="l02713"></a>02713         var headerView = [aTableColumn <a class="code" href="interface_c_p_table_column.html#a9a346d4582962843f5915f54b06d9831">headerView</a>];
<a name="l02714"></a>02714         <span class="keywordflow">if</span> ([headerView respondsToSelector:<span class="keyword">@selector</span>(_setIndicatorImage:)])
<a name="l02715"></a>02715             [headerView _setIndicatorImage:anImage];
<a name="l02716"></a>02716     }
<a name="l02717"></a>02717 }
<a name="l02718"></a>02718 
<a name="l02722"></a>02722 - (<a class="code" href="interface_c_p_image.html">CPImage</a>)_tableHeaderSortImage
<a name="l02723"></a>02723 {
<a name="l02724"></a>02724     <span class="keywordflow">return</span> [<span class="keyword">self</span> currentValueForThemeAttribute:&quot;sort-image&quot;];
<a name="l02725"></a>02725 }
<a name="l02726"></a>02726 
<a name="l02730"></a>02730 - (<a class="code" href="interface_c_p_image.html">CPImage</a>)_tableHeaderReverseSortImage
<a name="l02731"></a>02731 {
<a name="l02732"></a>02732     <span class="keywordflow">return</span> [<span class="keyword">self</span> currentValueForThemeAttribute:&quot;sort-image-reversed&quot;];
<a name="l02733"></a>02733 }
<a name="l02734"></a>02734 
<a name="l02738"></a><a class="code" href="interface_c_p_table_view.html#a0b737f53481551002ffae1b1e157b024">02738</a> - (<a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>)highlightedTableColumn
<a name="l02739"></a>02739 {
<a name="l02740"></a>02740     <span class="keywordflow">return</span> _currentHighlightedTableColumn;
<a name="l02741"></a>02741 }
<a name="l02742"></a>02742 
<a name="l02746"></a><a class="code" href="interface_c_p_table_view.html#a61c59db7ff22843b3469036cce667412">02746</a> - (void)setHighlightedTableColumn:(<a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>)aTableColumn
<a name="l02747"></a>02747 {
<a name="l02748"></a>02748     <span class="keywordflow">if</span> (_currentHighlightedTableColumn == aTableColumn)
<a name="l02749"></a>02749         <span class="keywordflow">return</span>;
<a name="l02750"></a>02750 
<a name="l02751"></a>02751     <span class="keywordflow">if</span> (_headerView)
<a name="l02752"></a>02752     {
<a name="l02753"></a>02753         <span class="keywordflow">if</span> (_currentHighlightedTableColumn != nil)
<a name="l02754"></a>02754             [[_currentHighlightedTableColumn headerView] unsetThemeState:CPThemeStateSelected];
<a name="l02755"></a>02755 
<a name="l02756"></a>02756         <span class="keywordflow">if</span> (aTableColumn != nil)
<a name="l02757"></a>02757             [[aTableColumn <a class="code" href="interface_c_p_table_column.html#a9a346d4582962843f5915f54b06d9831">headerView</a>] <a class="code" href="interface_c_p_view.html#a5c01c6b93db984674be4b2d41bf29fb4">setThemeState</a>:CPThemeStateSelected];
<a name="l02758"></a>02758     }
<a name="l02759"></a>02759 
<a name="l02760"></a>02760     _currentHighlightedTableColumn = aTableColumn;
<a name="l02761"></a>02761 }
<a name="l02762"></a>02762 
<a name="l02769"></a><a class="code" href="interface_c_p_table_view.html#a36bbab18fe3008a1ccdc7de1a58e3089">02769</a> - (BOOL)canDragRowsWithIndexes:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)rowIndexes atPoint:(CGPoint)mouseDownPoint
<a name="l02770"></a>02770 {
<a name="l02771"></a>02771     <span class="keywordflow">return</span> [rowIndexes <a class="code" href="class_c_p_index_set.html#a837688ed946ca09c66595dfa30345d03">count</a>] &gt; 0 &amp;&amp; [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#ab93d1883609b8aaca737188ee9667c17">numberOfRows</a>] &gt; 0;
<a name="l02772"></a>02772 }
<a name="l02773"></a>02773 
<a name="l02784"></a><a class="code" href="interface_c_p_table_view.html#a62fac1ba2cdd4209fc686134972885b6">02784</a> - (<a class="code" href="interface_c_p_image.html">CPImage</a>)dragImageForRowsWithIndexes:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)dragRows tableColumns:(<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>)theTableColumns event:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)dragEvent offset:(CGPoint)dragImageOffset
<a name="l02785"></a>02785 {
<a name="l02786"></a>02786     <span class="keywordflow">return</span> [[<a class="code" href="interface_c_p_image.html">CPImage</a> alloc] initWithContentsOfFile:@&quot;Frameworks/AppKit/Resources/GenericFile.png&quot; size:CGSizeMake(32,32)];
<a name="l02787"></a>02787 }
<a name="l02788"></a>02788 
<a name="l02801"></a><a class="code" href="interface_c_p_table_view.html#a094bbe4cb452c6c540b46ad612fb66f9">02801</a> - (<a class="code" href="interface_c_p_view.html">CPView</a>)dragViewForRowsWithIndexes:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)theDraggedRows tableColumns:(<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>)theTableColumns event:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)theDragEvent offset:(CGPoint)dragViewOffset
<a name="l02802"></a>02802 {
<a name="l02803"></a>02803     var bounds = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#af0bd55e12e5ac7ea4b137eae5f1829af">bounds</a>],
<a name="l02804"></a>02804         view = [[<a class="code" href="interface_c_p_view.html">CPView</a> alloc] initWithFrame:bounds];
<a name="l02805"></a>02805 
<a name="l02806"></a>02806     [view setAlphaValue:0.7];
<a name="l02807"></a>02807 
<a name="l02808"></a>02808     <span class="comment">// We have to fetch all the data views for the selected rows and columns</span>
<a name="l02809"></a>02809     <span class="comment">// After that we can copy these add them to a transparent drag view and use that drag view</span>
<a name="l02810"></a>02810     <span class="comment">// to make it appear we are dragging images of those rows (as you would do in regular Cocoa)</span>
<a name="l02811"></a>02811     var columnIndex = [theTableColumns <a class="code" href="interface_c_p_array.html#ae8abed7c67002d9a883005aa40e4fb55">count</a>];
<a name="l02812"></a>02812     <span class="keywordflow">while</span> (columnIndex--)
<a name="l02813"></a>02813     {
<a name="l02814"></a>02814         var tableColumn = [theTableColumns <a class="code" href="interface_c_p_array.html#a5f4c80df5e0ce9c9c7c64c7c24d917eb">objectAtIndex</a>:columnIndex],
<a name="l02815"></a>02815             row = [theDraggedRows <a class="code" href="class_c_p_index_set.html#abc895f4b5df7bdaf090161db6b234b73">firstIndex</a>];
<a name="l02816"></a>02816 
<a name="l02817"></a>02817         <span class="keywordflow">while</span> (row !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l02818"></a>02818         {
<a name="l02819"></a>02819             var dataView = [<span class="keyword">self</span> _newDataViewForRow:row tableColumn:tableColumn];
<a name="l02820"></a>02820 
<a name="l02821"></a>02821             [dataView setFrame:[<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#afa878164caef6b4c75e2ef5328cc3612">frameOfDataViewAtColumn</a>:columnIndex <a class="code" href="interface_c_p_table_view.html#afa878164caef6b4c75e2ef5328cc3612">row</a>:row]];
<a name="l02822"></a>02822             [dataView setObjectValue:[<span class="keyword">self</span> _objectValueForTableColumn:tableColumn row:row]];
<a name="l02823"></a>02823 
<a name="l02824"></a>02824             <span class="comment">// If the column uses content bindings, allow them to override the objectValueForTableColumn.</span>
<a name="l02825"></a>02825             [tableColumn _prepareDataView:dataView forRow:row];
<a name="l02826"></a>02826 
<a name="l02827"></a>02827             [view addSubview:dataView];
<a name="l02828"></a>02828 
<a name="l02829"></a>02829             row = [theDraggedRows <a class="code" href="class_c_p_index_set.html#a3f66583eea02c42c2b14e53daf697559">indexGreaterThanIndex</a>:row];
<a name="l02830"></a>02830         }
<a name="l02831"></a>02831     }
<a name="l02832"></a>02832 
<a name="l02833"></a>02833     var dragPoint = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ae2bfa5f8caa8e73b81f97180c50cd80f">convertPoint</a>:[theDragEvent <a class="code" href="interface_c_p_event.html#a5a57f4fa909de5d83e5402a8d8af4b94">locationInWindow</a>] <a class="code" href="interface_c_p_view.html#ae2bfa5f8caa8e73b81f97180c50cd80f">fromView</a>:nil];
<a name="l02834"></a>02834     dragViewOffset.x = _CGRectGetWidth(bounds) / 2 - dragPoint.x;
<a name="l02835"></a>02835     dragViewOffset.y = _CGRectGetHeight(bounds) / 2 - dragPoint.y;
<a name="l02836"></a>02836 
<a name="l02837"></a>02837     <span class="keywordflow">return</span> view;
<a name="l02838"></a>02838 }
<a name="l02839"></a>02839 
<a name="l02846"></a>02846 - (<a class="code" href="interface_c_p_view.html">CPView</a>)_dragViewForColumn:(<span class="keywordtype">int</span>)theColumnIndex event:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)theDragEvent offset:(CPPointPointer)theDragViewOffset
<a name="l02847"></a>02847 {
<a name="l02848"></a>02848     var dragView = [[_CPColumnDragView alloc] initWithLineColor:[<span class="keyword">self</span> gridColor]],
<a name="l02849"></a>02849         tableColumn = [[<span class="keyword">self</span> tableColumns] objectAtIndex:theColumnIndex],
<a name="l02850"></a>02850         bounds = _CGRectMake(0.0, 0.0, [tableColumn <a class="code" href="_c_g_geometry_8j.html#a52b64513cb182b63f0e848f53bddad9b">width</a>], _CGRectGetHeight([<span class="keyword">self</span> exposedRect]) + 23.0),
<a name="l02851"></a>02851         columnRect = [<span class="keyword">self</span> rectOfColumn:theColumnIndex],
<a name="l02852"></a>02852         headerView = [tableColumn headerView],
<a name="l02853"></a>02853         row = [_exposedRows firstIndex];
<a name="l02854"></a>02854 
<a name="l02855"></a>02855     <span class="keywordflow">while</span> (row !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l02856"></a>02856     {
<a name="l02857"></a>02857         var dataView = [<span class="keyword">self</span> _newDataViewForRow:row tableColumn:tableColumn],
<a name="l02858"></a>02858             dataViewFrame = [<span class="keyword">self</span> frameOfDataViewAtColumn:theColumnIndex row:row];
<a name="l02859"></a>02859 
<a name="l02860"></a>02860         <span class="comment">// Only one column is ever dragged so we just place the view at</span>
<a name="l02861"></a>02861         dataViewFrame.origin.x = 0.0;
<a name="l02862"></a>02862 
<a name="l02863"></a>02863         <span class="comment">// Offset by table header height - scroll position</span>
<a name="l02864"></a>02864         dataViewFrame.origin.y = ( _CGRectGetMinY(dataViewFrame) - _CGRectGetMinY([self exposedRect]) ) + 23.0;
<a name="l02865"></a>02865         [dataView setFrame:dataViewFrame];
<a name="l02866"></a>02866 
<a name="l02867"></a>02867         [dataView setObjectValue:[<span class="keyword">self</span> _objectValueForTableColumn:tableColumn row:row]];
<a name="l02868"></a>02868         [dragView addSubview:dataView];
<a name="l02869"></a>02869 
<a name="l02870"></a>02870         row = [_exposedRows indexGreaterThanIndex:row];
<a name="l02871"></a>02871     }
<a name="l02872"></a>02872 
<a name="l02873"></a>02873     <span class="comment">// Add the column header view</span>
<a name="l02874"></a>02874     var headerFrame = [headerView frame];
<a name="l02875"></a>02875     headerFrame.origin = _CGPointMakeZero();
<a name="l02876"></a>02876 
<a name="l02877"></a>02877     var columnHeaderView = [[_CPTableColumnHeaderView alloc] initWithFrame:headerFrame];
<a name="l02878"></a>02878     [columnHeaderView setStringValue:[headerView stringValue]];
<a name="l02879"></a>02879     [columnHeaderView setThemeState:[headerView themeState]];
<a name="l02880"></a>02880     [dragView addSubview:columnHeaderView];
<a name="l02881"></a>02881 
<a name="l02882"></a>02882     [dragView setBackgroundColor:[<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#a713287464015f76e4359aeedc0110dc5">whiteColor</a>]];
<a name="l02883"></a>02883     [dragView setAlphaValue:0.7];
<a name="l02884"></a>02884     [dragView setFrame:bounds];
<a name="l02885"></a>02885 
<a name="l02886"></a>02886     <span class="keywordflow">return</span> dragView;
<a name="l02887"></a>02887 }
<a name="l02888"></a>02888 
<a name="l02893"></a><a class="code" href="interface_c_p_table_view.html#a2950280f57f4aae1189e143fe23d0b2e">02893</a> - (void)setDraggingSourceOperationMask:(CPDragOperation)mask forLocal:(BOOL)isLocal
<a name="l02894"></a>02894 {
<a name="l02895"></a>02895     <span class="comment">//ignore local for the time being since only one capp app can run at a time...</span>
<a name="l02896"></a>02896     _dragOperationDefaultMask = mask;
<a name="l02897"></a>02897 }
<a name="l02898"></a>02898 
<a name="l02904"></a><a class="code" href="interface_c_p_table_view.html#a6d0d013a22f3acb18da993ea3c310e6e">02904</a> - (void)setDropRow:(CPInteger)row dropOperation:(CPTableViewDropOperation)operation
<a name="l02905"></a>02905 {
<a name="l02906"></a>02906     <span class="keywordflow">if</span> (row &gt; [<span class="keyword">self</span> numberOfRows] &amp;&amp; operation === <a class="code" href="_c_p_table_view_8j.html#a279093eafa50075a94c202e0dd51861a">CPTableViewDropOn</a>)
<a name="l02907"></a>02907     {
<a name="l02908"></a>02908         var numberOfRows = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#ab93d1883609b8aaca737188ee9667c17">numberOfRows</a>] + 1,
<a name="l02909"></a>02909             reason = <span class="stringliteral">@&quot;Attempt to set dropRow=&quot;</span> + row +
<a name="l02910"></a>02910                      <span class="stringliteral">&quot; dropOperation=CPTableViewDropOn when [0 - &quot;</span> + numberOfRows + <span class="stringliteral">&quot;] is valid range of rows.&quot;</span>;
<a name="l02911"></a>02911 
<a name="l02912"></a>02912         [[<a class="code" href="interface_c_p_exception.html" title="Used to implement exception handling (creating &amp; raising).">CPException</a> <a class="code" href="interface_c_p_exception.html#a44c9e2d9ffa44471351ac8086093f542">exceptionWithName</a>:@&quot;Error&quot; <a class="code" href="interface_c_p_exception.html#a44c9e2d9ffa44471351ac8086093f542">reason</a>:reason <a class="code" href="interface_c_p_exception.html#a44c9e2d9ffa44471351ac8086093f542">userInfo</a>:nil] <a class="code" href="interface_c_p_exception.html#a1428cc4e84f1d200dea624a85d6c9336">raise</a>];
<a name="l02913"></a>02913     }
<a name="l02914"></a>02914 
<a name="l02915"></a>02915 
<a name="l02916"></a>02916     _retargetedDropRow = row;
<a name="l02917"></a>02917     _retargetedDropOperation = operation;
<a name="l02918"></a>02918 }
<a name="l02919"></a>02919 
<a name="l02931"></a><a class="code" href="interface_c_p_table_view.html#ac3b64dfb51786e6eabb88333b160abd1">02931</a> - (void)setDraggingDestinationFeedbackStyle:(CPTableViewDraggingDestinationFeedbackStyle)aStyle
<a name="l02932"></a>02932 {
<a name="l02933"></a>02933     <span class="comment">//FIX ME: this should vary up the highlight color, currently nothing is being done with it</span>
<a name="l02934"></a>02934     _destinationDragStyle = aStyle;
<a name="l02935"></a>02935 }
<a name="l02936"></a>02936 
<a name="l02947"></a><a class="code" href="interface_c_p_table_view.html#a5dc6ce6bc6c517f59a4a6ee9f6f11043">02947</a> - (CPTableViewDraggingDestinationFeedbackStyle)draggingDestinationFeedbackStyle
<a name="l02948"></a>02948 {
<a name="l02949"></a>02949     <span class="keywordflow">return</span> _destinationDragStyle;
<a name="l02950"></a>02950 }
<a name="l02951"></a>02951 
<a name="l02957"></a><a class="code" href="interface_c_p_table_view.html#af8ef2e471bdae5db5e21d05177e9e1ff">02957</a> - (void)setVerticalMotionCanBeginDrag:(BOOL)aFlag
<a name="l02958"></a>02958 {
<a name="l02959"></a>02959     _verticalMotionCanDrag = aFlag;
<a name="l02960"></a>02960 }
<a name="l02961"></a>02961 
<a name="l02965"></a><a class="code" href="interface_c_p_table_view.html#a92dba28832bd617d81dbd5b8e64dda6d">02965</a> - (BOOL)verticalMotionCanBeginDrag
<a name="l02966"></a>02966 {
<a name="l02967"></a>02967     <span class="keywordflow">return</span> _verticalMotionCanDrag;
<a name="l02968"></a>02968 }
<a name="l02969"></a>02969 
<a name="l02970"></a>02970 - (<a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>)_tableColumnForSortDescriptor:(<a class="code" href="interface_c_p_sort_descriptor.html" title="Holds attributes necessary to describe how to sort a set of objects.">CPSortDescriptor</a>)theSortDescriptor
<a name="l02971"></a>02971 {
<a name="l02972"></a>02972     var tableColumns = [<span class="keyword">self</span> tableColumns];
<a name="l02973"></a>02973 
<a name="l02974"></a>02974     <span class="keywordflow">for</span> (var i = 0; i &lt; [tableColumns count]; i++)
<a name="l02975"></a>02975     {
<a name="l02976"></a>02976         var tableColumn = [tableColumns objectAtIndex:i],
<a name="l02977"></a>02977             sortDescriptorPrototype = [tableColumn sortDescriptorPrototype];
<a name="l02978"></a>02978 
<a name="l02979"></a>02979         <span class="keywordflow">if</span> (!sortDescriptorPrototype)
<a name="l02980"></a>02980             <span class="keywordflow">continue</span>;
<a name="l02981"></a>02981 
<a name="l02982"></a>02982         <span class="keywordflow">if</span> ([sortDescriptorPrototype key] === [theSortDescriptor key]
<a name="l02983"></a>02983             &amp;&amp; [sortDescriptorPrototype selector] === [theSortDescriptor selector])
<a name="l02984"></a>02984         {
<a name="l02985"></a>02985             <span class="keywordflow">return</span> tableColumn;
<a name="l02986"></a>02986         }
<a name="l02987"></a>02987     }
<a name="l02988"></a>02988 
<a name="l02989"></a>02989     <span class="keywordflow">return</span> nil;
<a name="l02990"></a>02990 }
<a name="l02991"></a>02991 
<a name="l02997"></a><a class="code" href="interface_c_p_table_view.html#af19f29e4eaeaa84964399fb46bca36f5">02997</a> - (void)setSortDescriptors:(<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>)sortDescriptors
<a name="l02998"></a>02998 {
<a name="l02999"></a>02999     var oldSortDescriptors = [[<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#ad471440f19239990d1947a3a2f026f2a">sortDescriptors</a>] <a class="code" href="interface_c_p_array.html#a42447f9f646fd3ccf93c4fe864bcbd81">copy</a>],
<a name="l03000"></a>03000         newSortDescriptors = nil;
<a name="l03001"></a>03001 
<a name="l03002"></a>03002     <span class="keywordflow">if</span> (sortDescriptors == nil)
<a name="l03003"></a>03003         newSortDescriptors = [<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a> array];
<a name="l03004"></a>03004     <span class="keywordflow">else</span>
<a name="l03005"></a>03005         newSortDescriptors = [<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a> <a class="code" href="interface_c_p_array.html#a4811e54ee87ec16819a86d24523308db">arrayWithArray</a>:sortDescriptors];
<a name="l03006"></a>03006 
<a name="l03007"></a>03007     <span class="keywordflow">if</span> ([newSortDescriptors isEqual:oldSortDescriptors])
<a name="l03008"></a>03008         <span class="keywordflow">return</span>;
<a name="l03009"></a>03009 
<a name="l03010"></a>03010     _sortDescriptors = newSortDescriptors;
<a name="l03011"></a>03011 
<a name="l03012"></a>03012     var oldColumn = nil,
<a name="l03013"></a>03013         newColumn = nil;
<a name="l03014"></a>03014 
<a name="l03015"></a>03015     <span class="keywordflow">if</span> ([newSortDescriptors count] &gt; 0)
<a name="l03016"></a>03016     {
<a name="l03017"></a>03017         var newMainSortDescriptor = [newSortDescriptors objectAtIndex:0];
<a name="l03018"></a>03018         newColumn = [<span class="keyword">self</span> _tableColumnForSortDescriptor:newMainSortDescriptor];
<a name="l03019"></a>03019     }
<a name="l03020"></a>03020 
<a name="l03021"></a>03021     <span class="keywordflow">if</span> ([oldSortDescriptors count] &gt; 0)
<a name="l03022"></a>03022     {
<a name="l03023"></a>03023         var oldMainSortDescriptor = [oldSortDescriptors objectAtIndex:0];
<a name="l03024"></a>03024         oldColumn = [<span class="keyword">self</span> _tableColumnForSortDescriptor:oldMainSortDescriptor];
<a name="l03025"></a>03025     }
<a name="l03026"></a>03026 
<a name="l03027"></a>03027     var image = [newMainSortDescriptor ascending] ? [<span class="keyword">self</span> _tableHeaderSortImage] : [<span class="keyword">self</span> _tableHeaderReverseSortImage];
<a name="l03028"></a>03028     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#af9691a3301ba43ac53f9e8f2333476a4">setIndicatorImage</a>:nil <a class="code" href="interface_c_p_table_view.html#af9691a3301ba43ac53f9e8f2333476a4">inTableColumn</a>:oldColumn];
<a name="l03029"></a>03029     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#af9691a3301ba43ac53f9e8f2333476a4">setIndicatorImage</a>:image <a class="code" href="interface_c_p_table_view.html#af9691a3301ba43ac53f9e8f2333476a4">inTableColumn</a>:newColumn];
<a name="l03030"></a>03030 
<a name="l03031"></a>03031     [<span class="keyword">self</span> _sendDataSourceSortDescriptorsDidChange:oldSortDescriptors];
<a name="l03032"></a>03032 
<a name="l03033"></a>03033     var binderClass = [[<span class="keyword">self</span> class] _binderClassForBinding:@&quot;sortDescriptors&quot;];
<a name="l03034"></a>03034     [[binderClass getBinding:@&quot;sortDescriptors&quot; forObject:self] reverseSetValueFor:@&quot;sortDescriptors&quot;];
<a name="l03035"></a>03035 }
<a name="l03036"></a>03036 
<a name="l03040"></a><a class="code" href="interface_c_p_table_view.html#ad471440f19239990d1947a3a2f026f2a">03040</a> - (<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>)sortDescriptors
<a name="l03041"></a>03041 {
<a name="l03042"></a>03042     <span class="keywordflow">return</span> _sortDescriptors;
<a name="l03043"></a>03043 }
<a name="l03044"></a>03044 
<a name="l03045"></a>03045 
<a name="l03049"></a>03049 - (id)_objectValueForTableColumn:(<a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>)aTableColumn row:(CPInteger)aRowIndex
<a name="l03050"></a>03050 {
<a name="l03051"></a>03051     var tableColumnUID = [aTableColumn UID],
<a name="l03052"></a>03052         tableColumnObjectValues = _objectValues[tableColumnUID];
<a name="l03053"></a>03053 
<a name="l03054"></a>03054     <span class="keywordflow">if</span> (!tableColumnObjectValues)
<a name="l03055"></a>03055     {
<a name="l03056"></a>03056         tableColumnObjectValues = [];
<a name="l03057"></a>03057         _objectValues[tableColumnUID] = tableColumnObjectValues;
<a name="l03058"></a>03058     }
<a name="l03059"></a>03059 
<a name="l03060"></a>03060     var objectValue = tableColumnObjectValues[aRowIndex];
<a name="l03061"></a>03061 
<a name="l03062"></a>03062     <span class="comment">// tableView:objectValueForTableColumn:row: is optional if content bindings are in place.</span>
<a name="l03063"></a>03063     <span class="keywordflow">if</span> (objectValue === undefined)
<a name="l03064"></a>03064     {
<a name="l03065"></a>03065         <span class="keywordflow">if</span> (_implementedDataSourceMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a23288f0ff7ed53d22d474f4248c733b1">CPTableViewDataSource_tableView_objectValueForTableColumn_row_</a>)
<a name="l03066"></a>03066         {
<a name="l03067"></a>03067             objectValue = [_dataSource tableView:self objectValueForTableColumn:aTableColumn row:aRowIndex];
<a name="l03068"></a>03068             tableColumnObjectValues[aRowIndex] = objectValue;
<a name="l03069"></a>03069         }
<a name="l03070"></a>03070         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (![<span class="keyword">self</span> infoForBinding:<span class="stringliteral">@&quot;content&quot;</span>])
<a name="l03071"></a>03071         {
<a name="l03072"></a>03072             CPLog(<span class="stringliteral">@&quot;no content binding established and data source &quot;</span> + [_dataSource description] + <span class="stringliteral">&quot; does not implement tableView:objectValueForTableColumn:row:&quot;</span>);
<a name="l03073"></a>03073         }
<a name="l03074"></a>03074     }
<a name="l03075"></a>03075 
<a name="l03076"></a>03076     <span class="keywordflow">return</span> objectValue;
<a name="l03077"></a>03077 }
<a name="l03078"></a>03078 
<a name="l03079"></a>03079 
<a name="l03083"></a><a class="code" href="interface_c_p_table_view.html#aafe2e8782dc906770b1dbfcbf97023a2">03083</a> - (CGRect)exposedRect
<a name="l03084"></a>03084 {
<a name="l03085"></a>03085     <span class="keywordflow">if</span> (!_exposedRect)
<a name="l03086"></a>03086     {
<a name="l03087"></a>03087         var superview = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ae7fe2569d290f7eaabdebf5d48cb2745">superview</a>];
<a name="l03088"></a>03088 
<a name="l03089"></a>03089         <span class="comment">// FIXME: Should we be rect intersecting in case</span>
<a name="l03090"></a>03090         <span class="comment">// there are multiple views in the clip view?</span>
<a name="l03091"></a>03091         <span class="keywordflow">if</span> ([superview isKindOfClass:[<a class="code" href="interface_c_p_clip_view.html">CPClipView</a> <span class="keyword">class</span>]])
<a name="l03092"></a>03092             _exposedRect = [superview bounds];
<a name="l03093"></a>03093 
<a name="l03094"></a>03094         <span class="keywordflow">else</span>
<a name="l03095"></a>03095             _exposedRect = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#af0bd55e12e5ac7ea4b137eae5f1829af">bounds</a>];
<a name="l03096"></a>03096     }
<a name="l03097"></a>03097 
<a name="l03098"></a>03098     <span class="keywordflow">return</span> _exposedRect;
<a name="l03099"></a>03099 }
<a name="l03100"></a>03100 
<a name="l03104"></a><a class="code" href="interface_c_p_table_view.html#a7dc6ff16b80a132f5bb7aa3dbaa16e50">03104</a> - (void)load
<a name="l03105"></a>03105 {
<a name="l03106"></a>03106     <span class="keywordflow">if</span> (_reloadAllRows)
<a name="l03107"></a>03107     {
<a name="l03108"></a>03108         [<span class="keyword">self</span> _unloadDataViewsInRows:_exposedRows columns:_exposedColumns];
<a name="l03109"></a>03109 
<a name="l03110"></a>03110         _exposedRows = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l03111"></a>03111         _exposedColumns = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l03112"></a>03112 
<a name="l03113"></a>03113         _reloadAllRows = NO;
<a name="l03114"></a>03114     }
<a name="l03115"></a>03115 
<a name="l03116"></a>03116     var exposedRect = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aafe2e8782dc906770b1dbfcbf97023a2">exposedRect</a>],
<a name="l03117"></a>03117         exposedRows = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4c32a454bd5323253b9e8c4f81712ea5">indexSetWithIndexesInRange</a>:[<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a7d9128a2f32c6714364d5217894daa44">rowsInRect</a>:exposedRect]],
<a name="l03118"></a>03118         exposedColumns = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a1acdacf678fb91a541b692d378586289">columnIndexesInRect</a>:exposedRect],
<a name="l03119"></a>03119         obscuredRows = [_exposedRows copy],
<a name="l03120"></a>03120         obscuredColumns = [_exposedColumns copy];
<a name="l03121"></a>03121 
<a name="l03122"></a>03122     [obscuredRows removeIndexes:exposedRows];
<a name="l03123"></a>03123     [obscuredColumns removeIndexes:exposedColumns];
<a name="l03124"></a>03124 
<a name="l03125"></a>03125     var newlyExposedRows = [exposedRows copy],
<a name="l03126"></a>03126         newlyExposedColumns = [exposedColumns copy];
<a name="l03127"></a>03127 
<a name="l03128"></a>03128     [newlyExposedRows removeIndexes:_exposedRows];
<a name="l03129"></a>03129     [newlyExposedColumns removeIndexes:_exposedColumns];
<a name="l03130"></a>03130 
<a name="l03131"></a>03131     var previouslyExposedRows = [exposedRows copy],
<a name="l03132"></a>03132         previouslyExposedColumns = [exposedColumns copy];
<a name="l03133"></a>03133 
<a name="l03134"></a>03134     [previouslyExposedRows removeIndexes:newlyExposedRows];
<a name="l03135"></a>03135     [previouslyExposedColumns removeIndexes:newlyExposedColumns];
<a name="l03136"></a>03136 
<a name="l03137"></a>03137     [<span class="keyword">self</span> _unloadDataViewsInRows:previouslyExposedRows columns:obscuredColumns];
<a name="l03138"></a>03138     [<span class="keyword">self</span> _unloadDataViewsInRows:obscuredRows columns:previouslyExposedColumns];
<a name="l03139"></a>03139     [<span class="keyword">self</span> _unloadDataViewsInRows:obscuredRows columns:obscuredColumns];
<a name="l03140"></a>03140     [<span class="keyword">self</span> _unloadDataViewsInRows:newlyExposedRows columns:newlyExposedColumns];
<a name="l03141"></a>03141 
<a name="l03142"></a>03142     [<span class="keyword">self</span> _loadDataViewsInRows:previouslyExposedRows columns:newlyExposedColumns];
<a name="l03143"></a>03143     [<span class="keyword">self</span> _loadDataViewsInRows:newlyExposedRows columns:previouslyExposedColumns];
<a name="l03144"></a>03144     [<span class="keyword">self</span> _loadDataViewsInRows:newlyExposedRows columns:newlyExposedColumns];
<a name="l03145"></a>03145 
<a name="l03146"></a>03146     _exposedRows = exposedRows;
<a name="l03147"></a>03147     _exposedColumns = exposedColumns;
<a name="l03148"></a>03148 
<a name="l03149"></a>03149     [_tableDrawView setFrame:exposedRect];
<a name="l03150"></a>03150 
<a name="l03151"></a>03151     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a31af19dc321476a95414cd5e5da60ef0">setNeedsDisplay</a>:YES];
<a name="l03152"></a>03152 
<a name="l03153"></a>03153     <span class="comment">// Now clear all the leftovers</span>
<a name="l03154"></a>03154     <span class="comment">// FIXME: this could be faster!</span>
<a name="l03155"></a>03155     <span class="keywordflow">for</span> (var identifier in _cachedDataViews)
<a name="l03156"></a>03156     {
<a name="l03157"></a>03157         var dataViews = _cachedDataViews[identifier],
<a name="l03158"></a>03158             count = dataViews.length;
<a name="l03159"></a>03159 
<a name="l03160"></a>03160         <span class="keywordflow">while</span> (count--)
<a name="l03161"></a>03161             [dataViews[count] removeFromSuperview];
<a name="l03162"></a>03162     }
<a name="l03163"></a>03163 
<a name="l03164"></a>03164     <span class="comment">// if we have any columns to remove do that here</span>
<a name="l03165"></a>03165     <span class="keywordflow">if</span> ([_differedColumnDataToRemove count])
<a name="l03166"></a>03166     {
<a name="l03167"></a>03167         <span class="keywordflow">for</span> (var i = 0; i &lt; _differedColumnDataToRemove.length; i++)
<a name="l03168"></a>03168         {
<a name="l03169"></a>03169             var data = _differedColumnDataToRemove[i],
<a name="l03170"></a>03170                 column = data.column;
<a name="l03171"></a>03171 
<a name="l03172"></a>03172             [column setHidden:data.shouldBeHidden];
<a name="l03173"></a>03173             [_tableColumns removeObject:column];
<a name="l03174"></a>03174         }
<a name="l03175"></a>03175         [_differedColumnDataToRemove removeAllObjects];
<a name="l03176"></a>03176     }
<a name="l03177"></a>03177 
<a name="l03178"></a>03178 }
<a name="l03179"></a>03179 
<a name="l03183"></a>03183 - (void)_unloadDataViewsInRows:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)rows columns:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)columns
<a name="l03184"></a>03184 {
<a name="l03185"></a>03185     <span class="keywordflow">if</span> (![rows count] || ![columns count])
<a name="l03186"></a>03186         <span class="keywordflow">return</span>;
<a name="l03187"></a>03187 
<a name="l03188"></a>03188     var rowArray = [],
<a name="l03189"></a>03189         columnArray = [];
<a name="l03190"></a>03190 
<a name="l03191"></a>03191     [rows <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">getIndexes</a>:rowArray <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">maxCount</a>:-1 <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">inIndexRange</a>:nil];
<a name="l03192"></a>03192     [columns <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">getIndexes</a>:columnArray <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">maxCount</a>:-1 <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">inIndexRange</a>:nil];
<a name="l03193"></a>03193 
<a name="l03194"></a>03194     var columnIndex = 0,
<a name="l03195"></a>03195         columnsCount = columnArray.length;
<a name="l03196"></a>03196 
<a name="l03197"></a>03197     <span class="keywordflow">for</span> (; columnIndex &lt; columnsCount; ++columnIndex)
<a name="l03198"></a>03198     {
<a name="l03199"></a>03199         var column = columnArray[columnIndex],
<a name="l03200"></a>03200             tableColumn = _tableColumns[column],
<a name="l03201"></a>03201             tableColumnUID = [tableColumn UID],
<a name="l03202"></a>03202             rowIndex = 0,
<a name="l03203"></a>03203             rowsCount = rowArray.length;
<a name="l03204"></a>03204 
<a name="l03205"></a>03205         <span class="keywordflow">for</span> (; rowIndex &lt; rowsCount; ++rowIndex)
<a name="l03206"></a>03206         {
<a name="l03207"></a>03207             var row = rowArray[rowIndex],
<a name="l03208"></a>03208                 dataViews = _dataViewsForTableColumns[tableColumnUID];
<a name="l03209"></a>03209 
<a name="l03210"></a>03210             <span class="keywordflow">if</span> (!dataViews || row &gt;= dataViews.length)
<a name="l03211"></a>03211                 <span class="keywordflow">continue</span>;
<a name="l03212"></a>03212 
<a name="l03213"></a>03213             var dataView = [dataViews objectAtIndex:row];
<a name="l03214"></a>03214 
<a name="l03215"></a>03215             [dataViews replaceObjectAtIndex:row withObject:nil];
<a name="l03216"></a>03216 
<a name="l03217"></a>03217             [<span class="keyword">self</span> _enqueueReusableDataView:dataView];
<a name="l03218"></a>03218         }
<a name="l03219"></a>03219     }
<a name="l03220"></a>03220 }
<a name="l03221"></a>03221 
<a name="l03225"></a>03225 - (void)_loadDataViewsInRows:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)rows columns:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)columns
<a name="l03226"></a>03226 {
<a name="l03227"></a>03227     <span class="keywordflow">if</span> (![rows count] || ![columns count])
<a name="l03228"></a>03228         <span class="keywordflow">return</span>;
<a name="l03229"></a>03229 
<a name="l03230"></a>03230     var rowArray = [],
<a name="l03231"></a>03231         rowRects = [],
<a name="l03232"></a>03232         columnArray = [];
<a name="l03233"></a>03233 
<a name="l03234"></a>03234     [rows <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">getIndexes</a>:rowArray <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">maxCount</a>:-1 <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">inIndexRange</a>:nil];
<a name="l03235"></a>03235     [columns <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">getIndexes</a>:columnArray <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">maxCount</a>:-1 <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">inIndexRange</a>:nil];
<a name="l03236"></a>03236 
<a name="l03237"></a>03237     <a class="code" href="_c_p_table_view_8j.html#a8d863ee1b9f1e447c7ee408af11b8f22">UPDATE_COLUMN_RANGES_IF_NECESSARY</a>();
<a name="l03238"></a>03238 
<a name="l03239"></a>03239     var columnIndex = 0,
<a name="l03240"></a>03240         columnsCount = columnArray.length;
<a name="l03241"></a>03241 
<a name="l03242"></a>03242     <span class="keywordflow">for</span> (; columnIndex &lt; columnsCount; ++columnIndex)
<a name="l03243"></a>03243     {
<a name="l03244"></a>03244         var column = columnArray[columnIndex],
<a name="l03245"></a>03245             tableColumn = _tableColumns[column];
<a name="l03246"></a>03246 
<a name="l03247"></a>03247         <span class="keywordflow">if</span> ([tableColumn isHidden] || tableColumn === _draggedColumn)
<a name="l03248"></a>03248             <span class="keywordflow">continue</span>;
<a name="l03249"></a>03249 
<a name="l03250"></a>03250         var tableColumnUID = [tableColumn UID];
<a name="l03251"></a>03251 
<a name="l03252"></a>03252         <span class="keywordflow">if</span> (!_dataViewsForTableColumns[tableColumnUID])
<a name="l03253"></a>03253             _dataViewsForTableColumns[tableColumnUID] = [];
<a name="l03254"></a>03254 
<a name="l03255"></a>03255         var rowIndex = 0,
<a name="l03256"></a>03256             rowsCount = rowArray.length,
<a name="l03257"></a>03257             isColumnSelected = [_selectedColumnIndexes containsIndex:column];
<a name="l03258"></a>03258 
<a name="l03259"></a>03259         <span class="keywordflow">for</span> (; rowIndex &lt; rowsCount; ++rowIndex)
<a name="l03260"></a>03260         {
<a name="l03261"></a>03261             var row = rowArray[rowIndex],
<a name="l03262"></a>03262                 dataView = [<span class="keyword">self</span> _newDataViewForRow:row tableColumn:tableColumn],
<a name="l03263"></a>03263                 isButton = [dataView isKindOfClass:[<a class="code" href="interface_c_p_button.html">CPButton</a> class]],
<a name="l03264"></a>03264                 isTextField = [dataView isKindOfClass:[<a class="code" href="interface_c_p_text_field.html">CPTextField</a> class]];
<a name="l03265"></a>03265 
<a name="l03266"></a>03266             [dataView setFrame:[<span class="keyword">self</span> frameOfDataViewAtColumn:column row:row]];
<a name="l03267"></a>03267             [dataView setObjectValue:[<span class="keyword">self</span> _objectValueForTableColumn:tableColumn row:row]];
<a name="l03268"></a>03268 
<a name="l03269"></a>03269             <span class="comment">// This gives the table column an opportunity to apply its bindings.</span>
<a name="l03270"></a>03270             <span class="comment">// It will override the value set above if there is a binding.</span>
<a name="l03271"></a>03271             [tableColumn _prepareDataView:dataView forRow:row];
<a name="l03272"></a>03272 
<a name="l03273"></a>03273             <span class="keywordflow">if</span> (isColumnSelected || [<span class="keyword">self</span> isRowSelected:row])
<a name="l03274"></a>03274                 [dataView setThemeState:<a class="code" href="_c_p_theme_8j.html#a71be4e23aaa9f399720025342f68ac6c">CPThemeStateSelectedDataView</a>];
<a name="l03275"></a>03275             <span class="keywordflow">else</span>
<a name="l03276"></a>03276                 [dataView unsetThemeState:CPThemeStateSelectedDataView];
<a name="l03277"></a>03277 
<a name="l03278"></a>03278             <span class="comment">// FIX ME: for performance reasons we might consider diverging from cocoa and moving this to the reloadData method</span>
<a name="l03279"></a>03279             <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a1b2d38c75129c936b93b4163a5a32889">CPTableViewDelegate_tableView_isGroupRow_</a>)
<a name="l03280"></a>03280             {
<a name="l03281"></a>03281                 <span class="keywordflow">if</span> ([_delegate <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:<span class="keyword">self</span> isGroupRow:row])
<a name="l03282"></a>03282                 {
<a name="l03283"></a>03283                     [_groupRows addIndex:row];
<a name="l03284"></a>03284                     [dataView setThemeState:CPThemeStateGroupRow];
<a name="l03285"></a>03285                 }
<a name="l03286"></a>03286                 <span class="keywordflow">else</span>
<a name="l03287"></a>03287                 {
<a name="l03288"></a>03288                     [_groupRows removeIndexesInRange:CPMakeRange(row, 1)];
<a name="l03289"></a>03289                     [dataView unsetThemeState:CPThemeStateGroupRow];
<a name="l03290"></a>03290                 }
<a name="l03291"></a>03291 
<a name="l03292"></a>03292                 [<span class="keyword">self</span> setNeedsDisplay:YES]
<a name="l03293"></a>03293             }
<a name="l03294"></a>03294 
<a name="l03295"></a>03295             <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#ad543a1b68132942313c20a9414cb508c">CPTableViewDelegate_tableView_willDisplayView_forTableColumn_row_</a>)
<a name="l03296"></a>03296                 [_delegate <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:<span class="keyword">self</span> willDisplayView:dataView forTableColumn:tableColumn row:row];
<a name="l03297"></a>03297 
<a name="l03298"></a>03298             <span class="keywordflow">if</span> ([dataView superview] !== <span class="keyword">self</span>)
<a name="l03299"></a>03299                 [<span class="keyword">self</span> addSubview:dataView];
<a name="l03300"></a>03300 
<a name="l03301"></a>03301             _dataViewsForTableColumns[tableColumnUID][row] = dataView;
<a name="l03302"></a>03302 
<a name="l03303"></a>03303             <span class="keywordflow">if</span> (isButton || (_editingCellIndex &amp;&amp; _editingCellIndex.x === column &amp;&amp; _editingCellIndex.y === row))
<a name="l03304"></a>03304             {
<a name="l03305"></a>03305                 <a class="code" href="_c_a_backing_store_8j.html#ad2b049b1f6911d2ffffc0769dfe601e4">if</a> (isTextField)
<a name="l03306"></a>03306                 {
<a name="l03307"></a>03307                     [dataView setEditable:YES];
<a name="l03308"></a>03308                     [dataView setSendsActionOnEndEditing:YES];
<a name="l03309"></a>03309                     [dataView setSelectable:YES];
<a name="l03310"></a>03310                     [dataView selectText:nil];
<a name="l03311"></a>03311                     [dataView setBezeled:YES];
<a name="l03312"></a>03312                     [dataView setDelegate:self];
<a name="l03313"></a>03313                 }
<a name="l03314"></a>03314 
<a name="l03315"></a>03315                 [dataView setTarget:self];
<a name="l03316"></a>03316                 [dataView setAction:@selector(_commitDataViewObjectValue:)];
<a name="l03317"></a>03317                 dataView.tableViewEditedColumnObj = tableColumn;
<a name="l03318"></a>03318                 dataView.tableViewEditedRowIndex = row;
<a name="l03319"></a>03319             }
<a name="l03320"></a>03320             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isTextField)
<a name="l03321"></a>03321             {
<a name="l03322"></a>03322                 [dataView setEditable:NO];
<a name="l03323"></a>03323                 [dataView setSelectable:NO];
<a name="l03324"></a>03324             }
<a name="l03325"></a>03325         }
<a name="l03326"></a>03326     }
<a name="l03327"></a>03327 }
<a name="l03328"></a>03328 
<a name="l03332"></a>03332 - (void)_layoutDataViewsInRows:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)rows columns:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)columns
<a name="l03333"></a>03333 {
<a name="l03334"></a>03334     var rowArray = [],
<a name="l03335"></a>03335         columnArray = [];
<a name="l03336"></a>03336 
<a name="l03337"></a>03337     [rows <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">getIndexes</a>:rowArray <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">maxCount</a>:-1 <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">inIndexRange</a>:nil];
<a name="l03338"></a>03338     [columns <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">getIndexes</a>:columnArray <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">maxCount</a>:-1 <a class="code" href="class_c_p_index_set.html#a4395208575d525f1d18a737681e35a9a">inIndexRange</a>:nil];
<a name="l03339"></a>03339 
<a name="l03340"></a>03340     var columnIndex = 0,
<a name="l03341"></a>03341         columnsCount = columnArray.length;
<a name="l03342"></a>03342 
<a name="l03343"></a>03343     <span class="keywordflow">for</span> (; columnIndex &lt; columnsCount; ++columnIndex)
<a name="l03344"></a>03344     {
<a name="l03345"></a>03345         var column = columnArray[columnIndex],
<a name="l03346"></a>03346             tableColumn = _tableColumns[column],
<a name="l03347"></a>03347             tableColumnUID = [tableColumn UID],
<a name="l03348"></a>03348             dataViewsForTableColumn = _dataViewsForTableColumns[tableColumnUID],
<a name="l03349"></a>03349             rowIndex = 0,
<a name="l03350"></a>03350             rowsCount = rowArray.length;
<a name="l03351"></a>03351 
<a name="l03352"></a>03352         <span class="keywordflow">for</span> (; rowIndex &lt; rowsCount; ++rowIndex)
<a name="l03353"></a>03353         {
<a name="l03354"></a>03354             var row = rowArray[rowIndex],
<a name="l03355"></a>03355                 dataView = dataViewsForTableColumn[row];
<a name="l03356"></a>03356 
<a name="l03357"></a>03357             [dataView setFrame:[<span class="keyword">self</span> frameOfDataViewAtColumn:column row:row]];
<a name="l03358"></a>03358         }
<a name="l03359"></a>03359     }
<a name="l03360"></a>03360 }
<a name="l03361"></a>03361 
<a name="l03367"></a>03367 - (void)_commitDataViewObjectValue:(<span class="keywordtype">id</span>)sender
<a name="l03368"></a>03368 {
<a name="l03369"></a>03369     _editingCellIndex = nil;
<a name="l03370"></a>03370 
<a name="l03371"></a>03371     <span class="keywordflow">if</span> (_implementedDataSourceMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a9f25c28df39dca590ad108beb6b4b48b">CPTableViewDataSource_tableView_setObjectValue_forTableColumn_row_</a>)
<a name="l03372"></a>03372         [_dataSource <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:<span class="keyword">self</span> setObjectValue:[sender objectValue] forTableColumn:sender.tableViewEditedColumnObj row:sender.tableViewEditedRowIndex];
<a name="l03373"></a>03373 
<a name="l03374"></a>03374     <span class="comment">// Allow the column binding to do a reverse set. Note that we do this even if the data source method above</span>
<a name="l03375"></a>03375     <span class="comment">// is implemented.</span>
<a name="l03376"></a>03376     [sender.tableViewEditedColumnObj _reverseSetDataView:sender forRow:sender.tableViewEditedRowIndex];
<a name="l03377"></a>03377 
<a name="l03378"></a>03378     <a class="code" href="_c_a_backing_store_8j.html#ad2b049b1f6911d2ffffc0769dfe601e4">if</a> ([sender respondsToSelector:<span class="keyword">@selector</span>(setEditable:)])
<a name="l03379"></a>03379         [sender setEditable:NO];
<a name="l03380"></a>03380 
<a name="l03381"></a>03381     <span class="keywordflow">if</span> ([sender respondsToSelector:<span class="keyword">@selector</span>(setSelectable:)])
<a name="l03382"></a>03382         [sender setSelectable:NO];
<a name="l03383"></a>03383 
<a name="l03384"></a>03384     <span class="keywordflow">if</span> ([sender isKindOfClass:[<a class="code" href="interface_c_p_text_field.html">CPTextField</a> <span class="keyword">class</span>]])
<a name="l03385"></a>03385         [sender setBezeled:NO];
<a name="l03386"></a>03386 
<a name="l03387"></a>03387     [<span class="keyword">self</span> reloadDataForRowIndexes:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:sender.tableViewEditedRowIndex]
<a name="l03388"></a>03388                     <a class="code" href="interface_c_p_table_view.html#a69ae01655437f565b3f51bd2805fe68a">columnIndexes</a>:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:[_tableColumns indexOfObject:sender.tableViewEditedColumnObj]]];
<a name="l03389"></a>03389 
<a name="l03390"></a>03390     [[<span class="keyword">self</span> window] makeFirstResponder:self];
<a name="l03391"></a>03391 
<a name="l03392"></a>03392 }
<a name="l03393"></a>03393 
<a name="l03399"></a><a class="code" href="interface_c_p_table_view.html#a47d3aaf5c324ae1f49e1b0a7e809c39b">03399</a> - (void)controlTextDidBlur:(<a class="code" href="interface_c_p_notification.html" title="A notification that can be posted to a CPNotificationCenter.">CPNotification</a>)theNotification
<a name="l03400"></a>03400 {
<a name="l03401"></a>03401     var dataView = [theNotification <a class="code" href="interface_c_p_notification.html#a0a912e9648acf5e7f669aed339474158">object</a>];
<a name="l03402"></a>03402 
<a name="l03403"></a>03403     <span class="keywordflow">if</span> ([dataView respondsToSelector:<span class="keyword">@selector</span>(setEditable:)])
<a name="l03404"></a>03404         [dataView setEditable:NO];
<a name="l03405"></a>03405 
<a name="l03406"></a>03406     <span class="keywordflow">if</span> ([dataView respondsToSelector:<span class="keyword">@selector</span>(setSelectable:)])
<a name="l03407"></a>03407         [dataView setSelectable:NO];
<a name="l03408"></a>03408 
<a name="l03409"></a>03409     <span class="keywordflow">if</span> ([dataView isKindOfClass:[<a class="code" href="interface_c_p_text_field.html">CPTextField</a> <span class="keyword">class</span>]])
<a name="l03410"></a>03410         [dataView setBezeled:NO];
<a name="l03411"></a>03411 
<a name="l03412"></a>03412     _editingCellIndex = nil;
<a name="l03413"></a>03413 }
<a name="l03414"></a>03414 
<a name="l03418"></a>03418 - (<a class="code" href="interface_c_p_view.html">CPView</a>)_newDataViewForRow:(CPInteger)aRow tableColumn:(<a class="code" href="interface_c_p_table_column.html">CPTableColumn</a>)aTableColumn
<a name="l03419"></a>03419 {
<a name="l03420"></a>03420     <span class="keywordflow">if</span> ((_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a50ccc5dbd574a129aca4b61924308813">CPTableViewDelegate_tableView_dataViewForTableColumn_row_</a>))
<a name="l03421"></a>03421     {
<a name="l03422"></a>03422         var dataView = [_delegate tableView:self dataViewForTableColumn:aTableColumn row:aRow];
<a name="l03423"></a>03423         [aTableColumn <a class="code" href="interface_c_p_table_column.html#a6c381d452fb43c861b21ac1d3c609253">setDataView</a>:dataView];
<a name="l03424"></a>03424     }
<a name="l03425"></a>03425 
<a name="l03426"></a>03426 
<a name="l03427"></a>03427     <span class="keywordflow">return</span> [aTableColumn _newDataViewForRow:aRow];
<a name="l03428"></a>03428 }
<a name="l03429"></a>03429 
<a name="l03433"></a>03433 - (void)_enqueueReusableDataView:(<a class="code" href="interface_c_p_view.html">CPView</a>)aDataView
<a name="l03434"></a>03434 {
<a name="l03435"></a>03435     <span class="keywordflow">if</span> (!aDataView)
<a name="l03436"></a>03436         <span class="keywordflow">return</span>;
<a name="l03437"></a>03437 
<a name="l03438"></a>03438     <span class="comment">// FIXME: yuck!</span>
<a name="l03439"></a>03439     var identifier = aDataView.identifier;
<a name="l03440"></a>03440 
<a name="l03441"></a>03441     <span class="keywordflow">if</span> (!_cachedDataViews[identifier])
<a name="l03442"></a>03442         _cachedDataViews[identifier] = [aDataView];
<a name="l03443"></a>03443     <span class="keywordflow">else</span>
<a name="l03444"></a>03444         _cachedDataViews[identifier].push(aDataView);
<a name="l03445"></a>03445 }
<a name="l03446"></a>03446 
<a name="l03451"></a><a class="code" href="interface_c_p_table_view.html#a2f8731a826f57388dba260fa2ccc64eb">03451</a> - (void)setFrameSize:(CGSize)aSize
<a name="l03452"></a>03452 {
<a name="l03453"></a>03453     [<span class="keyword">super</span> <a class="code" href="interface_c_p_view.html#a8237df9b00fb6c4f84f6c2bef131293a">setFrameSize</a>:aSize];
<a name="l03454"></a>03454 
<a name="l03455"></a>03455     <span class="keywordflow">if</span> (_headerView)
<a name="l03456"></a>03456         [_headerView setFrameSize:_CGSizeMake(_CGRectGetWidth([<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a6e37aa6c3ed5389e9a3bb7082b380cc5">frame</a>]), _CGRectGetHeight([_headerView frame]))];
<a name="l03457"></a>03457 
<a name="l03458"></a>03458     _exposedRect = nil;
<a name="l03459"></a>03459 }
<a name="l03460"></a>03460 
<a name="l03464"></a><a class="code" href="interface_c_p_table_view.html#aea04ea195d5b8cbfb7b533345ca39a5f">03464</a> - (void)setFrameOrigin:(CGPoint)aPoint
<a name="l03465"></a>03465 {
<a name="l03466"></a>03466     [<span class="keyword">super</span> <a class="code" href="interface_c_p_view.html#aa92b1dee9a783907b5f025cc9d5c7dd1">setFrameOrigin</a>:aPoint];
<a name="l03467"></a>03467 
<a name="l03468"></a>03468     _exposedRect = nil;
<a name="l03469"></a>03469 }
<a name="l03470"></a>03470 
<a name="l03474"></a><a class="code" href="interface_c_p_table_view.html#ac6650f10c37e049ab647423792b3f846">03474</a> - (void)setBoundsOrigin:(CGPoint)aPoint
<a name="l03475"></a>03475 {
<a name="l03476"></a>03476     [<span class="keyword">super</span> <a class="code" href="interface_c_p_view.html#a7a706a662fcf8c719122cbe823d023b1">setBoundsOrigin</a>:aPoint];
<a name="l03477"></a>03477 
<a name="l03478"></a>03478     _exposedRect = nil;
<a name="l03479"></a>03479 }
<a name="l03480"></a>03480 
<a name="l03484"></a><a class="code" href="interface_c_p_table_view.html#acb9aa4c6bf71797cb9b013d6e4c90e4b">03484</a> - (void)setBoundsSize:(CGSize)aSize
<a name="l03485"></a>03485 {
<a name="l03486"></a>03486     [<span class="keyword">super</span> <a class="code" href="interface_c_p_view.html#a0ff77c3301b6c0d4f3dcb06198bd4ba4">setBoundsSize</a>:aSize];
<a name="l03487"></a>03487 
<a name="l03488"></a>03488     _exposedRect = nil;
<a name="l03489"></a>03489 }
<a name="l03490"></a>03490 
<a name="l03494"></a><a class="code" href="interface_c_p_table_view.html#a31af19dc321476a95414cd5e5da60ef0">03494</a> - (void)setNeedsDisplay:(BOOL)aFlag
<a name="l03495"></a>03495 {
<a name="l03496"></a>03496     [<span class="keyword">super</span> <a class="code" href="interface_c_p_view.html#a695368bc818096a7ae173f955fa1bd2c">setNeedsDisplay</a>:aFlag];
<a name="l03497"></a>03497     [_tableDrawView setNeedsDisplay:aFlag];
<a name="l03498"></a>03498 }
<a name="l03499"></a>03499 
<a name="l03503"></a>03503 - (void)_drawRect:(CGRect)aRect
<a name="l03504"></a>03504 {
<a name="l03505"></a>03505     <span class="comment">// FIX ME: All three of these methods will likely need to be rewritten for 1.0</span>
<a name="l03506"></a>03506     <span class="comment">// We&#39;ve got grid drawing in highlightSelection and crap everywhere.</span>
<a name="l03507"></a>03507 
<a name="l03508"></a>03508     var exposedRect = [<span class="keyword">self</span> exposedRect];
<a name="l03509"></a>03509 
<a name="l03510"></a>03510     [<span class="keyword">self</span> drawBackgroundInClipRect:exposedRect];
<a name="l03511"></a>03511     [<span class="keyword">self</span> highlightSelectionInClipRect:exposedRect];
<a name="l03512"></a>03512     [<span class="keyword">self</span> drawGridInClipRect:exposedRect];
<a name="l03513"></a>03513 
<a name="l03514"></a>03514     <span class="keywordflow">if</span> (_implementsCustomDrawRow)
<a name="l03515"></a>03515         [<span class="keyword">self</span> _drawRows:_exposedRows clipRect:exposedRect];
<a name="l03516"></a>03516 }
<a name="l03517"></a>03517 
<a name="l03523"></a><a class="code" href="interface_c_p_table_view.html#a41afac4cdd07690faf2500f0b3cd123b">03523</a> - (void)drawBackgroundInClipRect:(CGRect)aRect
<a name="l03524"></a>03524 {
<a name="l03525"></a>03525     <span class="keywordflow">if</span> (!_usesAlternatingRowBackgroundColors)
<a name="l03526"></a>03526         <span class="keywordflow">return</span>;
<a name="l03527"></a>03527 
<a name="l03528"></a>03528     var rowColors = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aa31301940f52f185b7905f89a17e9bc1">alternatingRowBackgroundColors</a>],
<a name="l03529"></a>03529         colorCount = [rowColors count];
<a name="l03530"></a>03530 
<a name="l03531"></a>03531     <span class="keywordflow">if</span> (colorCount === 0)
<a name="l03532"></a>03532         <span class="keywordflow">return</span>;
<a name="l03533"></a>03533 
<a name="l03534"></a>03534     var context = [[<a class="code" href="interface_c_p_graphics_context.html">CPGraphicsContext</a> <a class="code" href="interface_c_p_graphics_context.html#a378dafc8fb951053dd6877fb45e87f61">currentContext</a>] <a class="code" href="interface_c_p_graphics_context.html#a92895bd939c04da463d02425bec83f0b">graphicsPort</a>];
<a name="l03535"></a>03535 
<a name="l03536"></a>03536     <span class="keywordflow">if</span> (colorCount === 1)
<a name="l03537"></a>03537     {
<a name="l03538"></a>03538         <a class="code" href="group__coregraphics.html#ga800a3e5b0c46359d28b091376630bb0e">CGContextSetFillColor</a>(context, rowColors[0]);
<a name="l03539"></a>03539         <a class="code" href="group__coregraphics.html#ga74c13e165c00cc434a54bb8c2148e1ba">CGContextFillRect</a>(context, aRect);
<a name="l03540"></a>03540 
<a name="l03541"></a>03541         <span class="keywordflow">return</span>;
<a name="l03542"></a>03542     }
<a name="l03543"></a>03543 
<a name="l03544"></a>03544     var exposedRows = [<span class="keyword">self</span> _unboundedRowsInRect:aRect],
<a name="l03545"></a>03545         firstRow = FLOOR(exposedRows.location / colorCount) * colorCount,
<a name="l03546"></a>03546         lastRow = <a class="code" href="group__foundation.html#ga9a9c6e53b2b0861cedbb77b5ab72e78f">CPMaxRange</a>(exposedRows),
<a name="l03547"></a>03547         colorIndex = 0,
<a name="l03548"></a>03548         groupRowRects = [];
<a name="l03549"></a>03549 
<a name="l03550"></a>03550     <span class="comment">//loop through each color so we only draw once for each color</span>
<a name="l03551"></a>03551     <span class="keywordflow">while</span> (colorIndex &lt; colorCount)
<a name="l03552"></a>03552     {
<a name="l03553"></a>03553         <a class="code" href="group__coregraphics.html#ga02cca9368e5aacc0bef423d724635376">CGContextBeginPath</a>(context);
<a name="l03554"></a>03554         <span class="keywordflow">for</span> (var row = firstRow + colorIndex; row &lt;= lastRow; row += colorCount)
<a name="l03555"></a>03555         {
<a name="l03556"></a>03556             <span class="comment">// if it&#39;s not a group row draw it otherwise we draw it later</span>
<a name="l03557"></a>03557             <span class="keywordflow">if</span> (![_groupRows containsIndex:row])
<a name="l03558"></a>03558                 <a class="code" href="group__coregraphics.html#ga63142912cf5a80c8c72c29d55cd7f730">CGContextAddRect</a>(context, <a class="code" href="group__appkit.html#gaa7d357ddb0a9100773cb092dd14a243f">CGRectIntersection</a>(aRect, [<span class="keyword">self</span> _rectOfRow:row checkRange:NO]));
<a name="l03559"></a>03559             <span class="keywordflow">else</span>
<a name="l03560"></a>03560                 groupRowRects.push(<a class="code" href="group__appkit.html#gaa7d357ddb0a9100773cb092dd14a243f">CGRectIntersection</a>(aRect, [<span class="keyword">self</span> _rectOfRow:row checkRange:NO]));
<a name="l03561"></a>03561         }
<a name="l03562"></a>03562         <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l03563"></a>03563 
<a name="l03564"></a>03564         <a class="code" href="group__coregraphics.html#ga800a3e5b0c46359d28b091376630bb0e">CGContextSetFillColor</a>(context, rowColors[colorIndex]);
<a name="l03565"></a>03565         <a class="code" href="group__coregraphics.html#ga5619db65db539d72c1ab275d1d5f54a1">CGContextFillPath</a>(context);
<a name="l03566"></a>03566 
<a name="l03567"></a>03567         colorIndex++;
<a name="l03568"></a>03568     }
<a name="l03569"></a>03569 
<a name="l03570"></a>03570     [<span class="keyword">self</span> _drawGroupRowsForRects:groupRowRects];
<a name="l03571"></a>03571 }
<a name="l03572"></a>03572 
<a name="l03577"></a><a class="code" href="interface_c_p_table_view.html#adf388c00db8e69dee3bb1e60e2df0203">03577</a> - (void)drawGridInClipRect:(CGRect)aRect
<a name="l03578"></a>03578 {
<a name="l03579"></a>03579     var context = [[<a class="code" href="interface_c_p_graphics_context.html">CPGraphicsContext</a> <a class="code" href="interface_c_p_graphics_context.html#a378dafc8fb951053dd6877fb45e87f61">currentContext</a>] <a class="code" href="interface_c_p_graphics_context.html#a92895bd939c04da463d02425bec83f0b">graphicsPort</a>],
<a name="l03580"></a>03580         gridStyleMask = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a9b133d62d7aba9a887f38e686627e160">gridStyleMask</a>];
<a name="l03581"></a>03581 
<a name="l03582"></a>03582     <span class="keywordflow">if</span> (!(gridStyleMask &amp; (<a class="code" href="_c_p_table_view_8j.html#acc262027919f5d8fa9961299c57e4887">CPTableViewSolidHorizontalGridLineMask</a> | <a class="code" href="_c_p_table_view_8j.html#af147002e8b12fcaf12a2df975edb95b5">CPTableViewSolidVerticalGridLineMask</a>)))
<a name="l03583"></a>03583         <span class="keywordflow">return</span>;
<a name="l03584"></a>03584 
<a name="l03585"></a>03585     <a class="code" href="group__coregraphics.html#ga02cca9368e5aacc0bef423d724635376">CGContextBeginPath</a>(context);
<a name="l03586"></a>03586 
<a name="l03587"></a>03587     <span class="keywordflow">if</span> (gridStyleMask &amp; <a class="code" href="_c_p_table_view_8j.html#acc262027919f5d8fa9961299c57e4887">CPTableViewSolidHorizontalGridLineMask</a>)
<a name="l03588"></a>03588     {
<a name="l03589"></a>03589         var exposedRows = [<span class="keyword">self</span> _unboundedRowsInRect:aRect],
<a name="l03590"></a>03590             row = exposedRows.location,
<a name="l03591"></a>03591             lastRow = <a class="code" href="group__foundation.html#ga9a9c6e53b2b0861cedbb77b5ab72e78f">CPMaxRange</a>(exposedRows) - 1,
<a name="l03592"></a>03592             rowY = -0.5,
<a name="l03593"></a>03593             minX = _CGRectGetMinX(aRect),
<a name="l03594"></a>03594             maxX = _CGRectGetMaxX(aRect);
<a name="l03595"></a>03595 
<a name="l03596"></a>03596         <span class="keywordflow">for</span> (; row &lt;= lastRow; ++row)
<a name="l03597"></a>03597         {
<a name="l03598"></a>03598             <span class="comment">// grab each row rect and add the top and bottom lines</span>
<a name="l03599"></a>03599             var rowRect = [<span class="keyword">self</span> _rectOfRow:row checkRange:NO],
<a name="l03600"></a>03600                 rowY = _CGRectGetMaxY(rowRect) - 0.5;
<a name="l03601"></a>03601 
<a name="l03602"></a>03602             <a class="code" href="group__coregraphics.html#ga44dc04bb1efb98ff834308c997d10dc5">CGContextMoveToPoint</a>(context, minX, rowY);
<a name="l03603"></a>03603             <a class="code" href="group__coregraphics.html#ga834b9d5848989453730d162f251a29c3">CGContextAddLineToPoint</a>(context, maxX, rowY);
<a name="l03604"></a>03604         }
<a name="l03605"></a>03605 
<a name="l03606"></a>03606         <span class="keywordflow">if</span> (_rowHeight &gt; 0.0)
<a name="l03607"></a>03607         {
<a name="l03608"></a>03608             var rowHeight = _rowHeight + _intercellSpacing.height,
<a name="l03609"></a>03609                 totalHeight = _CGRectGetMaxY(aRect);
<a name="l03610"></a>03610 
<a name="l03611"></a>03611             <span class="keywordflow">while</span> (rowY &lt; totalHeight)
<a name="l03612"></a>03612             {
<a name="l03613"></a>03613                 rowY += rowHeight;
<a name="l03614"></a>03614 
<a name="l03615"></a>03615                 <a class="code" href="group__coregraphics.html#ga44dc04bb1efb98ff834308c997d10dc5">CGContextMoveToPoint</a>(context, minX, rowY);
<a name="l03616"></a>03616                 <a class="code" href="group__coregraphics.html#ga834b9d5848989453730d162f251a29c3">CGContextAddLineToPoint</a>(context, maxX, rowY);
<a name="l03617"></a>03617             }
<a name="l03618"></a>03618         }
<a name="l03619"></a>03619     }
<a name="l03620"></a>03620 
<a name="l03621"></a>03621     <span class="keywordflow">if</span> (gridStyleMask &amp; <a class="code" href="_c_p_table_view_8j.html#af147002e8b12fcaf12a2df975edb95b5">CPTableViewSolidVerticalGridLineMask</a>)
<a name="l03622"></a>03622     {
<a name="l03623"></a>03623         var exposedColumnIndexes = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a1acdacf678fb91a541b692d378586289">columnIndexesInRect</a>:aRect],
<a name="l03624"></a>03624             columnsArray = [];
<a name="l03625"></a>03625 
<a name="l03626"></a>03626         [exposedColumnIndexes getIndexes:columnsArray maxCount:-1 inIndexRange:nil];
<a name="l03627"></a>03627 
<a name="l03628"></a>03628         var columnArrayIndex = 0,
<a name="l03629"></a>03629             columnArrayCount = columnsArray.length,
<a name="l03630"></a>03630             minY = _CGRectGetMinY(aRect),
<a name="l03631"></a>03631             maxY = _CGRectGetMaxY(aRect);
<a name="l03632"></a>03632 
<a name="l03633"></a>03633         <span class="keywordflow">for</span> (; columnArrayIndex &lt; columnArrayCount; ++columnArrayIndex)
<a name="l03634"></a>03634         {
<a name="l03635"></a>03635             var columnRect = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#af86aacec5d36506c1fee17f1fab5803f">rectOfColumn</a>:columnsArray[columnArrayIndex]],
<a name="l03636"></a>03636                 columnX = _CGRectGetMaxX(columnRect) - 0.5;
<a name="l03637"></a>03637 
<a name="l03638"></a>03638             <a class="code" href="group__coregraphics.html#ga44dc04bb1efb98ff834308c997d10dc5">CGContextMoveToPoint</a>(context, columnX, minY);
<a name="l03639"></a>03639             <a class="code" href="group__coregraphics.html#ga834b9d5848989453730d162f251a29c3">CGContextAddLineToPoint</a>(context, columnX, maxY);
<a name="l03640"></a>03640         }
<a name="l03641"></a>03641     }
<a name="l03642"></a>03642 
<a name="l03643"></a>03643     <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l03644"></a>03644     <a class="code" href="group__coregraphics.html#gac13f17a8bed76d16b9e5252106d196e0">CGContextSetStrokeColor</a>(context, [<span class="keyword">self</span> gridColor]);
<a name="l03645"></a>03645     <a class="code" href="group__coregraphics.html#ga03bda4b6dc1763d22d122d565e027012">CGContextStrokePath</a>(context);
<a name="l03646"></a>03646 }
<a name="l03647"></a>03647 
<a name="l03653"></a><a class="code" href="interface_c_p_table_view.html#a0c0337c6cc26dff4a0f656e889f21fae">03653</a> - (void)highlightSelectionInClipRect:(CGRect)aRect
<a name="l03654"></a>03654 {
<a name="l03655"></a>03655     <span class="keywordflow">if</span> (_selectionHighlightStyle === <a class="code" href="_c_p_table_view_8j.html#a01cb9ff2b6562f83a7f4073abf81f7ce">CPTableViewSelectionHighlightStyleNone</a>)
<a name="l03656"></a>03656         <span class="keywordflow">return</span>;
<a name="l03657"></a>03657 
<a name="l03658"></a>03658     var context = [[<a class="code" href="interface_c_p_graphics_context.html">CPGraphicsContext</a> <a class="code" href="interface_c_p_graphics_context.html#a378dafc8fb951053dd6877fb45e87f61">currentContext</a>] <a class="code" href="interface_c_p_graphics_context.html#a92895bd939c04da463d02425bec83f0b">graphicsPort</a>],
<a name="l03659"></a>03659         indexes = [],
<a name="l03660"></a>03660         rectSelector = <span class="keyword">@selector</span>(rectOfRow:);
<a name="l03661"></a>03661 
<a name="l03662"></a>03662     <span class="keywordflow">if</span> ([_selectedRowIndexes count] &gt;= 1)
<a name="l03663"></a>03663     {
<a name="l03664"></a>03664         var exposedRows = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4c32a454bd5323253b9e8c4f81712ea5">indexSetWithIndexesInRange</a>:[<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a7d9128a2f32c6714364d5217894daa44">rowsInRect</a>:aRect]],
<a name="l03665"></a>03665             firstRow = [exposedRows firstIndex],
<a name="l03666"></a>03666             exposedRange = <a class="code" href="group__foundation.html#ga377fec0972facd19d72b8abcffcdb362">CPMakeRange</a>(firstRow, [exposedRows lastIndex] - firstRow + 1);
<a name="l03667"></a>03667 
<a name="l03668"></a>03668         [_selectedRowIndexes getIndexes:indexes maxCount:-1 inIndexRange:exposedRange];
<a name="l03669"></a>03669     }
<a name="l03670"></a>03670     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ([_selectedColumnIndexes count] &gt;= 1)
<a name="l03671"></a>03671     {
<a name="l03672"></a>03672         rectSelector = <span class="keyword">@selector</span>(rectOfColumn:);
<a name="l03673"></a>03673 
<a name="l03674"></a>03674         var exposedColumns = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a1acdacf678fb91a541b692d378586289">columnIndexesInRect</a>:aRect],
<a name="l03675"></a>03675             firstColumn = [exposedColumns firstIndex],
<a name="l03676"></a>03676             exposedRange = <a class="code" href="group__foundation.html#ga377fec0972facd19d72b8abcffcdb362">CPMakeRange</a>(firstColumn, [exposedColumns lastIndex] - firstColumn + 1);
<a name="l03677"></a>03677 
<a name="l03678"></a>03678         [_selectedColumnIndexes getIndexes:indexes maxCount:-1 inIndexRange:exposedRange];
<a name="l03679"></a>03679     }
<a name="l03680"></a>03680 
<a name="l03681"></a>03681     var count = count2 = [indexes count];
<a name="l03682"></a>03682 
<a name="l03683"></a>03683     <span class="keywordflow">if</span> (!count)
<a name="l03684"></a>03684         <span class="keywordflow">return</span>;
<a name="l03685"></a>03685 
<a name="l03686"></a>03686     var drawGradient = (_selectionHighlightStyle === <a class="code" href="_c_p_table_view_8j.html#a9b1494c16eb023b6a546dc0fb584fce7">CPTableViewSelectionHighlightStyleSourceList</a> &amp;&amp; [_selectedRowIndexes count] &gt;= 1),
<a name="l03687"></a>03687         deltaHeight = 0.5 * (_gridStyleMask &amp; <a class="code" href="_c_p_table_view_8j.html#acc262027919f5d8fa9961299c57e4887">CPTableViewSolidHorizontalGridLineMask</a>);
<a name="l03688"></a>03688 
<a name="l03689"></a>03689     <a class="code" href="group__coregraphics.html#ga02cca9368e5aacc0bef423d724635376">CGContextBeginPath</a>(context);
<a name="l03690"></a>03690 
<a name="l03691"></a>03691     <span class="keywordflow">if</span> (drawGradient)
<a name="l03692"></a>03692     {
<a name="l03693"></a>03693         var gradientCache = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a6a923296245546e44a0c25f7709a1285">selectionGradientColors</a>],
<a name="l03694"></a>03694             topLineColor = [gradientCache objectForKey:CPSourceListTopLineColor],
<a name="l03695"></a>03695             bottomLineColor = [gradientCache objectForKey:CPSourceListBottomLineColor],
<a name="l03696"></a>03696             gradientColor = [gradientCache objectForKey:CPSourceListGradient];
<a name="l03697"></a>03697     }
<a name="l03698"></a>03698 
<a name="l03699"></a>03699     var normalSelectionHighlightColor = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#ad7269481be5a77cb295ec2328d8576df">selectionHighlightColor</a>];
<a name="l03700"></a>03700 
<a name="l03701"></a>03701     <span class="comment">// don&#39;t do these lookups if there are no group rows</span>
<a name="l03702"></a>03702     <span class="keywordflow">if</span> ([_groupRows count])
<a name="l03703"></a>03703     {
<a name="l03704"></a>03704         var topGroupLineColor = [<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#aa833ca4d353c6a9854c2386f13a17680">colorWithCalibratedWhite</a>:212.0 / 255.0 <a class="code" href="interface_c_p_color.html#aa833ca4d353c6a9854c2386f13a17680">alpha</a>:1.0],
<a name="l03705"></a>03705             bottomGroupLineColor = [<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#aa833ca4d353c6a9854c2386f13a17680">colorWithCalibratedWhite</a>:185.0 / 255.0 <a class="code" href="interface_c_p_color.html#aa833ca4d353c6a9854c2386f13a17680">alpha</a>:1.0],
<a name="l03706"></a>03706             gradientGroupColor = <a class="code" href="_c_g_gradient_8j.html#ad8d31cbcc471f671205098ba416bfc84">CGGradientCreateWithColorComponents</a>(<a class="code" href="_c_g_color_space_8j.html#a775e411191b3539566c438fb961b62df">CGColorSpaceCreateDeviceRGB</a>(), [212.0 / 255.0, 212.0 / 255.0, 212.0 / 255.0,1.0, 197.0 / 255.0, 197.0 / 255.0, 197.0 / 255.0,1.0], [0,1], 2);
<a name="l03707"></a>03707     }
<a name="l03708"></a>03708 
<a name="l03709"></a>03709     <span class="keywordflow">while</span> (count--)
<a name="l03710"></a>03710     {
<a name="l03711"></a>03711         var currentIndex = indexes[count],
<a name="l03712"></a>03712             rowRect = <a class="code" href="group__appkit.html#gaa7d357ddb0a9100773cb092dd14a243f">CGRectIntersection</a>(objj_msgSend(<span class="keyword">self</span>, rectSelector, currentIndex), aRect);
<a name="l03713"></a>03713 
<a name="l03714"></a>03714         <span class="comment">// group rows get the same highlight style as other rows if they&#39;re source list...</span>
<a name="l03715"></a>03715         <span class="keywordflow">if</span> (!drawGradient)
<a name="l03716"></a>03716             var shouldUseGroupGradient = [_groupRows containsIndex:currentIndex];
<a name="l03717"></a>03717 
<a name="l03718"></a>03718         <span class="keywordflow">if</span> (drawGradient || shouldUseGroupGradient)
<a name="l03719"></a>03719         {
<a name="l03720"></a>03720             var minX = _CGRectGetMinX(rowRect),
<a name="l03721"></a>03721                 minY = _CGRectGetMinY(rowRect),
<a name="l03722"></a>03722                 maxX = _CGRectGetMaxX(rowRect),
<a name="l03723"></a>03723                 maxY = _CGRectGetMaxY(rowRect) - deltaHeight;
<a name="l03724"></a>03724 
<a name="l03725"></a>03725             <span class="keywordflow">if</span> (!drawGradient)
<a name="l03726"></a>03726             {
<a name="l03727"></a>03727                 <span class="comment">//If there is no source list gradient we need to close the selection path and fill it now</span>
<a name="l03728"></a>03728                 [normalSelectionHighlightColor setFill];
<a name="l03729"></a>03729                 <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l03730"></a>03730                 <a class="code" href="group__coregraphics.html#ga5619db65db539d72c1ab275d1d5f54a1">CGContextFillPath</a>(context);
<a name="l03731"></a>03731                 <a class="code" href="group__coregraphics.html#ga02cca9368e5aacc0bef423d724635376">CGContextBeginPath</a>(context);
<a name="l03732"></a>03732             }
<a name="l03733"></a>03733             <a class="code" href="group__coregraphics.html#ga63142912cf5a80c8c72c29d55cd7f730">CGContextAddRect</a>(context, rowRect);
<a name="l03734"></a>03734 
<a name="l03735"></a>03735             <a class="code" href="_c_g_context_v_m_l_8j.html#ad5aab9a4c77342b828db694cea80e128">CGContextDrawLinearGradient</a>(context, (shouldUseGroupGradient) ? gradientGroupColor : gradientColor, rowRect.origin, _CGPointMake(minX, maxY), 0);
<a name="l03736"></a>03736             <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l03737"></a>03737 
<a name="l03738"></a>03738             <a class="code" href="group__coregraphics.html#ga02cca9368e5aacc0bef423d724635376">CGContextBeginPath</a>(context);
<a name="l03739"></a>03739             <a class="code" href="group__coregraphics.html#ga44dc04bb1efb98ff834308c997d10dc5">CGContextMoveToPoint</a>(context, minX, minY + .5);
<a name="l03740"></a>03740             <a class="code" href="group__coregraphics.html#ga834b9d5848989453730d162f251a29c3">CGContextAddLineToPoint</a>(context, maxX, minY + .5);
<a name="l03741"></a>03741             <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l03742"></a>03742             <a class="code" href="group__coregraphics.html#gac13f17a8bed76d16b9e5252106d196e0">CGContextSetStrokeColor</a>(context, (shouldUseGroupGradient) ? topGroupLineColor : topLineColor);
<a name="l03743"></a>03743             <a class="code" href="group__coregraphics.html#ga03bda4b6dc1763d22d122d565e027012">CGContextStrokePath</a>(context);
<a name="l03744"></a>03744 
<a name="l03745"></a>03745             <a class="code" href="group__coregraphics.html#ga02cca9368e5aacc0bef423d724635376">CGContextBeginPath</a>(context);
<a name="l03746"></a>03746             <a class="code" href="group__coregraphics.html#ga44dc04bb1efb98ff834308c997d10dc5">CGContextMoveToPoint</a>(context, minX, maxY - .5);
<a name="l03747"></a>03747             <a class="code" href="group__coregraphics.html#ga834b9d5848989453730d162f251a29c3">CGContextAddLineToPoint</a>(context, maxX, maxY - .5);
<a name="l03748"></a>03748             <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l03749"></a>03749             <a class="code" href="group__coregraphics.html#gac13f17a8bed76d16b9e5252106d196e0">CGContextSetStrokeColor</a>(context, (shouldUseGroupGradient) ? bottomGroupLineColor : bottomLineColor);
<a name="l03750"></a>03750             <a class="code" href="group__coregraphics.html#ga03bda4b6dc1763d22d122d565e027012">CGContextStrokePath</a>(context);
<a name="l03751"></a>03751         }
<a name="l03752"></a>03752         <span class="keywordflow">else</span>
<a name="l03753"></a>03753             <a class="code" href="group__coregraphics.html#ga63142912cf5a80c8c72c29d55cd7f730">CGContextAddRect</a>(context, rowRect);
<a name="l03754"></a>03754     }
<a name="l03755"></a>03755 
<a name="l03756"></a>03756     <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l03757"></a>03757 
<a name="l03758"></a>03758     <span class="keywordflow">if</span> (!drawGradient)
<a name="l03759"></a>03759     {
<a name="l03760"></a>03760         [normalSelectionHighlightColor setFill];
<a name="l03761"></a>03761         <a class="code" href="group__coregraphics.html#ga5619db65db539d72c1ab275d1d5f54a1">CGContextFillPath</a>(context);
<a name="l03762"></a>03762     }
<a name="l03763"></a>03763 
<a name="l03764"></a>03764     <a class="code" href="group__coregraphics.html#ga02cca9368e5aacc0bef423d724635376">CGContextBeginPath</a>(context);
<a name="l03765"></a>03765     var gridStyleMask = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a9b133d62d7aba9a887f38e686627e160">gridStyleMask</a>];
<a name="l03766"></a>03766     <span class="keywordflow">for</span> (var i = 0; i &lt; count2; i++)
<a name="l03767"></a>03767     {
<a name="l03768"></a>03768          var rect = objj_msgSend(<span class="keyword">self</span>, rectSelector, indexes[i]),
<a name="l03769"></a>03769              minX = _CGRectGetMinX(rect) - 0.5,
<a name="l03770"></a>03770              maxX = _CGRectGetMaxX(rect) - 0.5,
<a name="l03771"></a>03771              minY = _CGRectGetMinY(rect) - 0.5,
<a name="l03772"></a>03772              maxY = _CGRectGetMaxY(rect) - 0.5;
<a name="l03773"></a>03773 
<a name="l03774"></a>03774         <span class="keywordflow">if</span> ([_selectedRowIndexes count] &gt;= 1 &amp;&amp; gridStyleMask &amp; <a class="code" href="_c_p_table_view_8j.html#af147002e8b12fcaf12a2df975edb95b5">CPTableViewSolidVerticalGridLineMask</a>)
<a name="l03775"></a>03775         {
<a name="l03776"></a>03776             var exposedColumns = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a1acdacf678fb91a541b692d378586289">columnIndexesInRect</a>:aRect],
<a name="l03777"></a>03777                 exposedColumnIndexes = [],
<a name="l03778"></a>03778                 firstExposedColumn = [exposedColumns firstIndex],
<a name="l03779"></a>03779                 exposedRange = <a class="code" href="group__foundation.html#ga377fec0972facd19d72b8abcffcdb362">CPMakeRange</a>(firstExposedColumn, [exposedColumns lastIndex] - firstExposedColumn + 1);
<a name="l03780"></a>03780             [exposedColumns getIndexes:exposedColumnIndexes maxCount:-1 inIndexRange:exposedRange];
<a name="l03781"></a>03781             var exposedColumnCount = [exposedColumnIndexes count];
<a name="l03782"></a>03782 
<a name="l03783"></a>03783             <span class="keywordflow">for</span> (var c = firstExposedColumn; c &lt; exposedColumnCount; c++)
<a name="l03784"></a>03784             {
<a name="l03785"></a>03785                 var colRect = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#af86aacec5d36506c1fee17f1fab5803f">rectOfColumn</a>:exposedColumnIndexes[c]],
<a name="l03786"></a>03786                     colX = _CGRectGetMaxX(colRect) + 0.5;
<a name="l03787"></a>03787 
<a name="l03788"></a>03788                 <a class="code" href="group__coregraphics.html#ga44dc04bb1efb98ff834308c997d10dc5">CGContextMoveToPoint</a>(context, colX, minY);
<a name="l03789"></a>03789                 <a class="code" href="group__coregraphics.html#ga834b9d5848989453730d162f251a29c3">CGContextAddLineToPoint</a>(context, colX, maxY);
<a name="l03790"></a>03790             }
<a name="l03791"></a>03791         }
<a name="l03792"></a>03792 
<a name="l03793"></a>03793         <span class="comment">//if the row after the current row is not selected then there is no need to draw the bottom grid line white.</span>
<a name="l03794"></a>03794         <span class="keywordflow">if</span> ([indexes containsObject:indexes[i] + 1])
<a name="l03795"></a>03795         {
<a name="l03796"></a>03796             <a class="code" href="group__coregraphics.html#ga44dc04bb1efb98ff834308c997d10dc5">CGContextMoveToPoint</a>(context, minX, maxY);
<a name="l03797"></a>03797             <a class="code" href="group__coregraphics.html#ga834b9d5848989453730d162f251a29c3">CGContextAddLineToPoint</a>(context, maxX, maxY);
<a name="l03798"></a>03798         }
<a name="l03799"></a>03799     }
<a name="l03800"></a>03800 
<a name="l03801"></a>03801     <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l03802"></a>03802     <a class="code" href="group__coregraphics.html#gac13f17a8bed76d16b9e5252106d196e0">CGContextSetStrokeColor</a>(context, [<span class="keyword">self</span> currentValueForThemeAttribute:<span class="stringliteral">&quot;highlighted-grid-color&quot;</span>]);
<a name="l03803"></a>03803     <a class="code" href="group__coregraphics.html#ga03bda4b6dc1763d22d122d565e027012">CGContextStrokePath</a>(context);
<a name="l03804"></a>03804 }
<a name="l03805"></a>03805 
<a name="l03811"></a>03811 - (void)_drawGroupRowsForRects:(<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>)rects
<a name="l03812"></a>03812 {
<a name="l03813"></a>03813     <span class="keywordflow">if</span> (_selectionHighlightStyle === <a class="code" href="_c_p_table_view_8j.html#a9b1494c16eb023b6a546dc0fb584fce7">CPTableViewSelectionHighlightStyleSourceList</a> || !rects.length)
<a name="l03814"></a>03814         <span class="keywordflow">return</span>;
<a name="l03815"></a>03815 
<a name="l03816"></a>03816     var context = [[<a class="code" href="interface_c_p_graphics_context.html">CPGraphicsContext</a> <a class="code" href="interface_c_p_graphics_context.html#a378dafc8fb951053dd6877fb45e87f61">currentContext</a>] <a class="code" href="interface_c_p_graphics_context.html#a92895bd939c04da463d02425bec83f0b">graphicsPort</a>],
<a name="l03817"></a>03817         i = rects.length;
<a name="l03818"></a>03818 
<a name="l03819"></a>03819     <a class="code" href="group__coregraphics.html#ga02cca9368e5aacc0bef423d724635376">CGContextBeginPath</a>(context);
<a name="l03820"></a>03820 
<a name="l03821"></a>03821     var gradientCache = [<span class="keyword">self</span> selectionGradientColors],
<a name="l03822"></a>03822         topLineColor = [<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#a80c4273ef2d3bb9cc836946de79c8a1e">colorWithHexString</a>:&quot;d3d3d3&quot;],
<a name="l03823"></a>03823         bottomLineColor = [<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#a80c4273ef2d3bb9cc836946de79c8a1e">colorWithHexString</a>:&quot;bebebd&quot;],
<a name="l03824"></a>03824         gradientColor = <a class="code" href="_c_g_gradient_8j.html#ad8d31cbcc471f671205098ba416bfc84">CGGradientCreateWithColorComponents</a>(<a class="code" href="_c_g_color_space_8j.html#a775e411191b3539566c438fb961b62df">CGColorSpaceCreateDeviceRGB</a>(), [220.0 / 255.0, 220.0 / 255.0, 220.0 / 255.0,1.0,
<a name="l03825"></a>03825                                                                                             199.0 / 255.0, 199.0 / 255.0, 199.0 / 255.0,1.0], [0,1], 2),
<a name="l03826"></a>03826         drawGradient = YES;
<a name="l03827"></a>03827 
<a name="l03828"></a>03828     <span class="keywordflow">while</span> (i--)
<a name="l03829"></a>03829     {
<a name="l03830"></a>03830         var rowRect = rects[i];
<a name="l03831"></a>03831 
<a name="l03832"></a>03832         <a class="code" href="group__coregraphics.html#ga63142912cf5a80c8c72c29d55cd7f730">CGContextAddRect</a>(context, rowRect);
<a name="l03833"></a>03833 
<a name="l03834"></a>03834         <span class="keywordflow">if</span> (drawGradient)
<a name="l03835"></a>03835         {
<a name="l03836"></a>03836             var minX = CGRectGetMinX(rowRect),
<a name="l03837"></a>03837                 minY = CGRectGetMinY(rowRect),
<a name="l03838"></a>03838                 maxX = CGRectGetMaxX(rowRect),
<a name="l03839"></a>03839                 maxY = CGRectGetMaxY(rowRect);
<a name="l03840"></a>03840 
<a name="l03841"></a>03841             <a class="code" href="_c_g_context_v_m_l_8j.html#ad5aab9a4c77342b828db694cea80e128">CGContextDrawLinearGradient</a>(context, gradientColor, rowRect.origin, CGPointMake(minX, maxY), 0);
<a name="l03842"></a>03842             <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l03843"></a>03843 
<a name="l03844"></a>03844             <a class="code" href="group__coregraphics.html#ga02cca9368e5aacc0bef423d724635376">CGContextBeginPath</a>(context);
<a name="l03845"></a>03845             <a class="code" href="group__coregraphics.html#ga44dc04bb1efb98ff834308c997d10dc5">CGContextMoveToPoint</a>(context, minX, minY);
<a name="l03846"></a>03846             <a class="code" href="group__coregraphics.html#ga834b9d5848989453730d162f251a29c3">CGContextAddLineToPoint</a>(context, maxX, minY);
<a name="l03847"></a>03847             <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l03848"></a>03848             <a class="code" href="group__coregraphics.html#gac13f17a8bed76d16b9e5252106d196e0">CGContextSetStrokeColor</a>(context, topLineColor);
<a name="l03849"></a>03849             <a class="code" href="group__coregraphics.html#ga03bda4b6dc1763d22d122d565e027012">CGContextStrokePath</a>(context);
<a name="l03850"></a>03850 
<a name="l03851"></a>03851             <a class="code" href="group__coregraphics.html#ga02cca9368e5aacc0bef423d724635376">CGContextBeginPath</a>(context);
<a name="l03852"></a>03852             <a class="code" href="group__coregraphics.html#ga44dc04bb1efb98ff834308c997d10dc5">CGContextMoveToPoint</a>(context, minX, maxY);
<a name="l03853"></a>03853             <a class="code" href="group__coregraphics.html#ga834b9d5848989453730d162f251a29c3">CGContextAddLineToPoint</a>(context, maxX, maxY - 1);
<a name="l03854"></a>03854             <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l03855"></a>03855             <a class="code" href="group__coregraphics.html#gac13f17a8bed76d16b9e5252106d196e0">CGContextSetStrokeColor</a>(context, bottomLineColor);
<a name="l03856"></a>03856             <a class="code" href="group__coregraphics.html#ga03bda4b6dc1763d22d122d565e027012">CGContextStrokePath</a>(context);
<a name="l03857"></a>03857         }
<a name="l03858"></a>03858     }
<a name="l03859"></a>03859 
<a name="l03860"></a>03860     <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l03861"></a>03861 }
<a name="l03862"></a>03862 
<a name="l03866"></a>03866 - (void)_drawRows:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)rowsIndexes clipRect:(CGRect)clipRect
<a name="l03867"></a>03867 {
<a name="l03868"></a>03868     var row = [rowsIndexes <a class="code" href="class_c_p_index_set.html#abc895f4b5df7bdaf090161db6b234b73">firstIndex</a>];
<a name="l03869"></a>03869 
<a name="l03870"></a>03870     <span class="keywordflow">while</span> (row !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l03871"></a>03871     {
<a name="l03872"></a>03872         [<span class="keyword">self</span> drawRow:row clipRect:CGRectIntersection(clipRect, [<span class="keyword">self</span> rectOfRow:row])];
<a name="l03873"></a>03873         row = [rowsIndexes <a class="code" href="class_c_p_index_set.html#a3f66583eea02c42c2b14e53daf697559">indexGreaterThanIndex</a>:row];
<a name="l03874"></a>03874     }
<a name="l03875"></a>03875 }
<a name="l03876"></a>03876 
<a name="l03883"></a><a class="code" href="interface_c_p_table_view.html#a0d0e754546163166d458ebf24ef4d149">03883</a> - (void)drawRow:(CPInteger)row clipRect:(CGRect)rect
<a name="l03884"></a>03884 {
<a name="l03885"></a>03885     <span class="comment">// This method does currently nothing in cappuccino. Can be overridden by subclasses.</span>
<a name="l03886"></a>03886 
<a name="l03887"></a>03887 }
<a name="l03888"></a>03888 
<a name="l03892"></a><a class="code" href="interface_c_p_table_view.html#a37955da775ea839340abc7bea7bd9fd1">03892</a> - (void)layoutSubviews
<a name="l03893"></a>03893 {
<a name="l03894"></a>03894     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a7dc6ff16b80a132f5bb7aa3dbaa16e50">load</a>];
<a name="l03895"></a>03895 }
<a name="l03896"></a>03896 
<a name="l03900"></a><a class="code" href="interface_c_p_table_view.html#a7a71c5e32d14791d19693f9a87d88491">03900</a> - (void)viewWillMoveToSuperview:(<a class="code" href="interface_c_p_view.html">CPView</a>)aView
<a name="l03901"></a>03901 {
<a name="l03902"></a>03902     var superview = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ae7fe2569d290f7eaabdebf5d48cb2745">superview</a>],
<a name="l03903"></a>03903         defaultCenter = [<a class="code" href="interface_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="interface_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>];
<a name="l03904"></a>03904 
<a name="l03905"></a>03905     <span class="keywordflow">if</span> (superview)
<a name="l03906"></a>03906     {
<a name="l03907"></a>03907         [defaultCenter
<a name="l03908"></a>03908             removeObserver:self
<a name="l03909"></a>03909                       name:CPViewFrameDidChangeNotification
<a name="l03910"></a>03910                     object:superview];
<a name="l03911"></a>03911 
<a name="l03912"></a>03912         [defaultCenter
<a name="l03913"></a>03913             removeObserver:self
<a name="l03914"></a>03914                       name:CPViewBoundsDidChangeNotification
<a name="l03915"></a>03915                     object:superview];
<a name="l03916"></a>03916     }
<a name="l03917"></a>03917 
<a name="l03918"></a>03918     <span class="keywordflow">if</span> ([aView isKindOfClass:[<a class="code" href="interface_c_p_clip_view.html">CPClipView</a> <span class="keyword">class</span>]])
<a name="l03919"></a>03919     {
<a name="l03920"></a>03920         [aView <a class="code" href="interface_c_p_view.html#a1e2e604070ac86b98b610bde11488eb9">setPostsFrameChangedNotifications</a>:YES];
<a name="l03921"></a>03921         [aView <a class="code" href="interface_c_p_view.html#a4cac5dff2634c55e643412707b514d53">setPostsBoundsChangedNotifications</a>:YES];
<a name="l03922"></a>03922 
<a name="l03923"></a>03923         [defaultCenter
<a name="l03924"></a>03924             addObserver:self
<a name="l03925"></a>03925                selector:@selector(superviewFrameChanged:)
<a name="l03926"></a>03926                    name:CPViewFrameDidChangeNotification
<a name="l03927"></a>03927                  object:aView];
<a name="l03928"></a>03928 
<a name="l03929"></a>03929         [defaultCenter
<a name="l03930"></a>03930             addObserver:self
<a name="l03931"></a>03931                selector:@selector(superviewBoundsChanged:)
<a name="l03932"></a>03932                    name:CPViewBoundsDidChangeNotification
<a name="l03933"></a>03933                  object:aView];
<a name="l03934"></a>03934     }
<a name="l03935"></a>03935 }
<a name="l03936"></a>03936 
<a name="l03940"></a><a class="code" href="interface_c_p_table_view.html#abe4f0984deafc23e6ae4e952155e75f4">03940</a> - (void)superviewBoundsChanged:(<a class="code" href="interface_c_p_notification.html" title="A notification that can be posted to a CPNotificationCenter.">CPNotification</a>)aNotification
<a name="l03941"></a>03941 {
<a name="l03942"></a>03942     _exposedRect = nil;
<a name="l03943"></a>03943 
<a name="l03944"></a>03944     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a31af19dc321476a95414cd5e5da60ef0">setNeedsDisplay</a>:YES];
<a name="l03945"></a>03945     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a39431c7a00864c9ddfe57c191fd82ccf">setNeedsLayout</a>];
<a name="l03946"></a>03946 }
<a name="l03947"></a>03947 
<a name="l03951"></a><a class="code" href="interface_c_p_table_view.html#a95d81bc03909fd8aa1c2ace4c5a81285">03951</a> - (void)superviewFrameChanged:(<a class="code" href="interface_c_p_notification.html" title="A notification that can be posted to a CPNotificationCenter.">CPNotification</a>)aNotification
<a name="l03952"></a>03952 {
<a name="l03953"></a>03953     _exposedRect = nil;
<a name="l03954"></a>03954 
<a name="l03955"></a>03955     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#af2af4f3cd8a4020f17c25c64548051ea">tile</a>];
<a name="l03956"></a>03956 }
<a name="l03957"></a>03957 
<a name="l03958"></a>03958 <span class="comment">/*</span>
<a name="l03959"></a>03959 <span class="comment">    @ignore</span>
<a name="l03960"></a>03960 <span class="comment">*/</span>
<a name="l03961"></a><a class="code" href="interface_c_p_table_view.html#a1f7e3a786ba3254260371678d08d0abf">03961</a> - (BOOL)tracksMouseOutsideOfFrame
<a name="l03962"></a>03962 {
<a name="l03963"></a>03963     <span class="keywordflow">return</span> YES;
<a name="l03964"></a>03964 }
<a name="l03965"></a>03965 
<a name="l03966"></a>03966 <span class="comment">/*</span>
<a name="l03967"></a>03967 <span class="comment">    @ignore</span>
<a name="l03968"></a>03968 <span class="comment">*/</span>
<a name="l03969"></a><a class="code" href="interface_c_p_table_view.html#abbf2e419712fbe7887c2660c1b6a8370">03969</a> - (BOOL)startTrackingAt:(CGPoint)aPoint
<a name="l03970"></a>03970 {
<a name="l03971"></a>03971     var row = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a6f1d4aad7598b4ca189e2a262d51cd08">rowAtPoint</a>:aPoint];
<a name="l03972"></a>03972 
<a name="l03973"></a>03973     <span class="comment">//if the user clicks outside a row then deselect everything</span>
<a name="l03974"></a>03974     <span class="keywordflow">if</span> (row &lt; 0 &amp;&amp; _allowsEmptySelection)
<a name="l03975"></a>03975         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a9b6204a962c90a046897dce505fec408">selectRowIndexes</a>:[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>] <a class="code" href="interface_c_p_table_view.html#a9b6204a962c90a046897dce505fec408">byExtendingSelection</a>:NO];
<a name="l03976"></a>03976 
<a name="l03977"></a>03977     [<span class="keyword">self</span> _noteSelectionIsChanging];
<a name="l03978"></a>03978 
<a name="l03979"></a>03979     <span class="keywordflow">if</span> ([<span class="keyword">self</span> mouseDownFlags] &amp; <a class="code" href="_c_p_event_8j.html#a2343191b34b38dc1952bb44d83fa30d6">CPShiftKeyMask</a>)
<a name="l03980"></a>03980         _selectionAnchorRow = (ABS([_selectedRowIndexes firstIndex] - row) &lt; ABS([_selectedRowIndexes lastIndex] - row)) ?
<a name="l03981"></a>03981             [_selectedRowIndexes firstIndex] : [_selectedRowIndexes lastIndex];
<a name="l03982"></a>03982     <span class="keywordflow">else</span>
<a name="l03983"></a>03983         _selectionAnchorRow = row;
<a name="l03984"></a>03984 
<a name="l03985"></a>03985 
<a name="l03986"></a>03986     <span class="comment">//set ivars for startTrackingPoint and time...</span>
<a name="l03987"></a>03987     _startTrackingPoint = aPoint;
<a name="l03988"></a>03988     _startTrackingTimestamp = <span class="keyword">new</span> Date();
<a name="l03989"></a>03989 
<a name="l03990"></a>03990     <span class="keywordflow">if</span> (_implementedDataSourceMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a9f25c28df39dca590ad108beb6b4b48b">CPTableViewDataSource_tableView_setObjectValue_forTableColumn_row_</a>)
<a name="l03991"></a>03991         _trackingPointMovedOutOfClickSlop = NO;
<a name="l03992"></a>03992 
<a name="l03993"></a>03993     <span class="comment">// if the table has drag support then we use mouseUp to select a single row.</span>
<a name="l03994"></a>03994     <span class="comment">// otherwise it uses mouse down.</span>
<a name="l03995"></a>03995     <span class="keywordflow">if</span> (row &gt;= 0 &amp;&amp; !(_implementedDataSourceMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a3fb0a731ef8cca0484830f426bcbe81f">CPTableViewDataSource_tableView_writeRowsWithIndexes_toPasteboard_</a>))
<a name="l03996"></a>03996         [<span class="keyword">self</span> _updateSelectionWithMouseAtRow:row];
<a name="l03997"></a>03997 
<a name="l03998"></a>03998     [[<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ae83c8efd2cc2cfe0dd767c1a6bb6d0a7">window</a>] <a class="code" href="class_c_p_window.html#a8fc7c3a24092c25057a4314694ef7c6d">makeFirstResponder</a>:self];
<a name="l03999"></a>03999     <span class="keywordflow">return</span> YES;
<a name="l04000"></a>04000 }
<a name="l04001"></a>04001 
<a name="l04005"></a><a class="code" href="interface_c_p_table_view.html#a6310c6a469089601b2de6e897d6c4450">04005</a> - (<a class="code" href="interface_c_p_menu.html">CPMenu</a>)menuForEvent:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)theEvent
<a name="l04006"></a>04006 {
<a name="l04007"></a>04007     <span class="keywordflow">if</span> (!(_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#aa51e2e3e077c35d99ca7b87d83e2eb01">CPTableViewDelegate_tableViewMenuForTableColumn_Row_</a>))
<a name="l04008"></a>04008         <span class="keywordflow">return</span> [<span class="keyword">super</span> <a class="code" href="interface_c_p_view.html#a84c4725d05ca3699e09f8d2b265189e3">menuForEvent</a>:theEvent];
<a name="l04009"></a>04009 
<a name="l04010"></a>04010     var location = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ae2bfa5f8caa8e73b81f97180c50cd80f">convertPoint</a>:[theEvent <a class="code" href="interface_c_p_event.html#a5a57f4fa909de5d83e5402a8d8af4b94">locationInWindow</a>] <a class="code" href="interface_c_p_view.html#ae2bfa5f8caa8e73b81f97180c50cd80f">fromView</a>:nil],
<a name="l04011"></a>04011         row = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a6f1d4aad7598b4ca189e2a262d51cd08">rowAtPoint</a>:location],
<a name="l04012"></a>04012         column = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aa5bce119e8c4b79e4ed0f9a10172996d">columnAtPoint</a>:location],
<a name="l04013"></a>04013         tableColumn = [[<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#addef4fffbf36e02b399b1fad4425b71e">tableColumns</a>] <a class="code" href="interface_c_p_array.html#a5f4c80df5e0ce9c9c7c64c7c24d917eb">objectAtIndex</a>:column];
<a name="l04014"></a>04014 
<a name="l04015"></a>04015     <span class="keywordflow">return</span> [_delegate tableView:self menuForTableColumn:tableColumn row:row];
<a name="l04016"></a>04016 }
<a name="l04017"></a>04017 
<a name="l04018"></a>04018 <span class="comment">/*</span>
<a name="l04019"></a>04019 <span class="comment">    @ignore</span>
<a name="l04020"></a>04020 <span class="comment">*/</span>
<a name="l04021"></a><a class="code" href="interface_c_p_table_view.html#adbef7bbed471e4c00409a0931612ac33">04021</a> - (void)trackMouse:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)anEvent
<a name="l04022"></a>04022 {
<a name="l04023"></a>04023     <span class="comment">// Prevent CPControl from eating the mouse events when we are in a drag session</span>
<a name="l04024"></a>04024     <span class="keywordflow">if</span> (![_draggedRowIndexes count])
<a name="l04025"></a>04025     {
<a name="l04026"></a>04026         [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#af9dcf4bdd9a34104db09579dc70dd9b0">autoscroll</a>:anEvent];
<a name="l04027"></a>04027         [<span class="keyword">super</span> <a class="code" href="interface_c_p_control.html#a582e5be1f236418e9067169e13b77194">trackMouse</a>:anEvent];
<a name="l04028"></a>04028     }
<a name="l04029"></a>04029     <span class="keywordflow">else</span>
<a name="l04030"></a>04030         [CPApp sendEvent:anEvent];
<a name="l04031"></a>04031 }
<a name="l04032"></a>04032 
<a name="l04033"></a>04033 <span class="comment">/*</span>
<a name="l04034"></a>04034 <span class="comment">    @ignore</span>
<a name="l04035"></a>04035 <span class="comment">*/</span>
<a name="l04036"></a><a class="code" href="interface_c_p_table_view.html#a76f737f3ee5a3cae63075c13d8ac3496">04036</a> - (BOOL)continueTracking:(CGPoint)lastPoint at:(CGPoint)aPoint
<a name="l04037"></a>04037 {
<a name="l04038"></a>04038     var row = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a6f1d4aad7598b4ca189e2a262d51cd08">rowAtPoint</a>:aPoint];
<a name="l04039"></a>04039 
<a name="l04040"></a>04040     <span class="comment">// begin the drag is the datasource lets us, we&#39;ve move at least +-3px vertical or horizontal,</span>
<a name="l04041"></a>04041     <span class="comment">// or we&#39;re dragging from selected rows and we haven&#39;t begun a drag session</span>
<a name="l04042"></a>04042     <span class="keywordflow">if</span> (!_isSelectingSession &amp;&amp; _implementedDataSourceMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a3fb0a731ef8cca0484830f426bcbe81f">CPTableViewDataSource_tableView_writeRowsWithIndexes_toPasteboard_</a>)
<a name="l04043"></a>04043     {
<a name="l04044"></a>04044         <span class="keywordflow">if</span> (row &gt;= 0 &amp;&amp; (ABS(_startTrackingPoint.x - aPoint.x) &gt; 3 || (_verticalMotionCanDrag &amp;&amp; ABS(_startTrackingPoint.y - aPoint.y) &gt; 3)) ||
<a name="l04045"></a>04045             ([_selectedRowIndexes containsIndex:row]))
<a name="l04046"></a>04046         {
<a name="l04047"></a>04047             <span class="keywordflow">if</span> ([_selectedRowIndexes containsIndex:row])
<a name="l04048"></a>04048                 _draggedRowIndexes = [[<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> alloc] initWithIndexSet:_selectedRowIndexes];
<a name="l04049"></a>04049             <span class="keywordflow">else</span>
<a name="l04050"></a>04050                 _draggedRowIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:row];
<a name="l04051"></a>04051 
<a name="l04052"></a>04052 
<a name="l04053"></a>04053             <span class="comment">//ask the datasource for the data</span>
<a name="l04054"></a>04054             var pboard = [<a class="code" href="interface_c_p_pasteboard.html">CPPasteboard</a> <a class="code" href="interface_c_p_pasteboard.html#adc671279bc4d0608ebe421e4657ecd07">pasteboardWithName</a>:CPDragPboard];
<a name="l04055"></a>04055 
<a name="l04056"></a>04056             <span class="keywordflow">if</span> ([<span class="keyword">self</span> canDragRowsWithIndexes:_draggedRowIndexes atPoint:aPoint] &amp;&amp; [_dataSource <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:<span class="keyword">self</span> writeRowsWithIndexes:_draggedRowIndexes toPasteboard:pboard])
<a name="l04057"></a>04057             {
<a name="l04058"></a>04058                 var currentEvent = [CPApp currentEvent],
<a name="l04059"></a>04059                     offset = <a class="code" href="group__appkit.html#gaf966bac39815f4926c5e7dcf7bf4c67c">CPPointMakeZero</a>(),
<a name="l04060"></a>04060                     tableColumns = [_tableColumns objectsAtIndexes:_exposedColumns];
<a name="l04061"></a>04061 
<a name="l04062"></a>04062                 <span class="comment">// We deviate from the default Cocoa implementation here by asking for a view in stead of an image</span>
<a name="l04063"></a>04063                 <span class="comment">// We support both, but the view preferred over the image because we can mimic the rows we are dragging</span>
<a name="l04064"></a>04064                 <span class="comment">// by re-creating the data views for the dragged rows</span>
<a name="l04065"></a>04065                 var view = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a094bbe4cb452c6c540b46ad612fb66f9">dragViewForRowsWithIndexes</a>:_draggedRowIndexes
<a name="l04066"></a>04066                                                <a class="code" href="interface_c_p_table_view.html#a094bbe4cb452c6c540b46ad612fb66f9">tableColumns</a>:tableColumns
<a name="l04067"></a>04067                                                       <a class="code" href="interface_c_p_table_view.html#a094bbe4cb452c6c540b46ad612fb66f9">event</a>:currentEvent
<a name="l04068"></a>04068                                                      <a class="code" href="interface_c_p_table_view.html#a094bbe4cb452c6c540b46ad612fb66f9">offset</a>:offset];
<a name="l04069"></a>04069 
<a name="l04070"></a>04070                 <span class="keywordflow">if</span> (!view)
<a name="l04071"></a>04071                 {
<a name="l04072"></a>04072                     var image = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a62fac1ba2cdd4209fc686134972885b6">dragImageForRowsWithIndexes</a>:_draggedRowIndexes
<a name="l04073"></a>04073                                                      <a class="code" href="interface_c_p_table_view.html#a62fac1ba2cdd4209fc686134972885b6">tableColumns</a>:tableColumns
<a name="l04074"></a>04074                                                             <a class="code" href="interface_c_p_table_view.html#a62fac1ba2cdd4209fc686134972885b6">event</a>:currentEvent
<a name="l04075"></a>04075                                                            <a class="code" href="interface_c_p_table_view.html#a62fac1ba2cdd4209fc686134972885b6">offset</a>:offset];
<a name="l04076"></a>04076                     view = [[<a class="code" href="interface_c_p_image_view.html">CPImageView</a> alloc] initWithFrame:CPMakeRect(0, 0, [image size].width, [image size].height)];
<a name="l04077"></a>04077                     [view setImage:image];
<a name="l04078"></a>04078                 }
<a name="l04079"></a>04079 
<a name="l04080"></a>04080                 var bounds = [view bounds],
<a name="l04081"></a>04081                     viewLocation = <a class="code" href="group__appkit.html#gabbd24c413b418848a07ac0ce30db3f8d">CPPointMake</a>(aPoint.x - CGRectGetWidth(bounds) / 2 + offset.x, aPoint.y - CGRectGetHeight(bounds) / 2 + offset.y);
<a name="l04082"></a>04082                 [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#a8c6c7572137940ff24d7cc3adb84a37f">dragView</a>:view <a class="code" href="interface_c_p_view.html#a8c6c7572137940ff24d7cc3adb84a37f">at</a>:viewLocation <a class="code" href="interface_c_p_view.html#a8c6c7572137940ff24d7cc3adb84a37f">offset</a>:CPPointMakeZero() <a class="code" href="interface_c_p_view.html#a8c6c7572137940ff24d7cc3adb84a37f">event</a>:[CPApp currentEvent] <a class="code" href="interface_c_p_view.html#a8c6c7572137940ff24d7cc3adb84a37f">pasteboard</a>:pboard <a class="code" href="interface_c_p_view.html#a8c6c7572137940ff24d7cc3adb84a37f">source</a>:self <a class="code" href="interface_c_p_view.html#a8c6c7572137940ff24d7cc3adb84a37f">slideBack</a>:YES];
<a name="l04083"></a>04083                 _startTrackingPoint = nil;
<a name="l04084"></a>04084 
<a name="l04085"></a>04085                 <span class="keywordflow">return</span> NO;
<a name="l04086"></a>04086             }
<a name="l04087"></a>04087 
<a name="l04088"></a>04088             <span class="comment">// The delegate disallowed the drag so clear the dragged row indexes</span>
<a name="l04089"></a>04089             _draggedRowIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l04090"></a>04090         }
<a name="l04091"></a>04091         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ABS(_startTrackingPoint.x - aPoint.x) &lt; 5 &amp;&amp; ABS(_startTrackingPoint.y - aPoint.y) &lt; 5)
<a name="l04092"></a>04092             <span class="keywordflow">return</span> YES;
<a name="l04093"></a>04093     }
<a name="l04094"></a>04094 
<a name="l04095"></a>04095     _isSelectingSession = YES;
<a name="l04096"></a>04096     <span class="keywordflow">if</span> (row &gt;= 0 &amp;&amp; row !== _lastTrackedRowIndex)
<a name="l04097"></a>04097     {
<a name="l04098"></a>04098         _lastTrackedRowIndex = row;
<a name="l04099"></a>04099         [<span class="keyword">self</span> _updateSelectionWithMouseAtRow:row];
<a name="l04100"></a>04100     }
<a name="l04101"></a>04101 
<a name="l04102"></a>04102     <span class="keywordflow">if</span> ((_implementedDataSourceMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a9f25c28df39dca590ad108beb6b4b48b">CPTableViewDataSource_tableView_setObjectValue_forTableColumn_row_</a>)
<a name="l04103"></a>04103         &amp;&amp; !_trackingPointMovedOutOfClickSlop)
<a name="l04104"></a>04104     {
<a name="l04105"></a>04105         var CLICK_SPACE_DELTA = 5.0; <span class="comment">// Stolen from AppKit/Platform/DOM/CPPlatformWindow+DOM.j</span>
<a name="l04106"></a>04106         <span class="keywordflow">if</span> (ABS(aPoint.x - _startTrackingPoint.x) &gt; CLICK_SPACE_DELTA
<a name="l04107"></a>04107             || ABS(aPoint.y - _startTrackingPoint.y) &gt; CLICK_SPACE_DELTA)
<a name="l04108"></a>04108         {
<a name="l04109"></a>04109             _trackingPointMovedOutOfClickSlop = YES;
<a name="l04110"></a>04110         }
<a name="l04111"></a>04111     }
<a name="l04112"></a>04112 
<a name="l04113"></a>04113     <span class="keywordflow">return</span> YES;
<a name="l04114"></a>04114 }
<a name="l04115"></a>04115 
<a name="l04119"></a><a class="code" href="interface_c_p_table_view.html#a3b1fa54e2fd7aa107531a00790b725ed">04119</a> - (void)stopTracking:(CGPoint)lastPoint at:(CGPoint)aPoint mouseIsUp:(BOOL)mouseIsUp
<a name="l04120"></a>04120 {
<a name="l04121"></a>04121     _isSelectingSession = NO;
<a name="l04122"></a>04122 
<a name="l04123"></a>04123     var CLICK_TIME_DELTA = 1000,
<a name="l04124"></a>04124         columnIndex,
<a name="l04125"></a>04125         column,
<a name="l04126"></a>04126         rowIndex,
<a name="l04127"></a>04127         shouldEdit = YES;
<a name="l04128"></a>04128 
<a name="l04129"></a>04129     <span class="keywordflow">if</span> (_implementedDataSourceMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a3fb0a731ef8cca0484830f426bcbe81f">CPTableViewDataSource_tableView_writeRowsWithIndexes_toPasteboard_</a>)
<a name="l04130"></a>04130     {
<a name="l04131"></a>04131         rowIndex = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a6f1d4aad7598b4ca189e2a262d51cd08">rowAtPoint</a>:aPoint];
<a name="l04132"></a>04132         <span class="keywordflow">if</span> (rowIndex !== -1)
<a name="l04133"></a>04133         {
<a name="l04134"></a>04134             <span class="keywordflow">if</span> ([_draggedRowIndexes count] &gt; 0)
<a name="l04135"></a>04135             {
<a name="l04136"></a>04136                 _draggedRowIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l04137"></a>04137                 <span class="keywordflow">return</span>;
<a name="l04138"></a>04138             }
<a name="l04139"></a>04139             <span class="comment">// if the table has drag support then we use mouseUp to select a single row.</span>
<a name="l04140"></a>04140              _previouslySelectedRowIndexes = [_selectedRowIndexes copy];
<a name="l04141"></a>04141             [<span class="keyword">self</span> _updateSelectionWithMouseAtRow:rowIndex];
<a name="l04142"></a>04142         }
<a name="l04143"></a>04143     }
<a name="l04144"></a>04144 
<a name="l04145"></a>04145     <span class="comment">// Accept either tableView:setObjectValue:forTableColumn:row: delegate method, or a binding.</span>
<a name="l04146"></a>04146     <span class="keywordflow">if</span> (mouseIsUp
<a name="l04147"></a>04147         &amp;&amp; !_trackingPointMovedOutOfClickSlop
<a name="l04148"></a>04148         &amp;&amp; ([[<a class="code" href="_c_p_application_8j.html#a428912231c07effc32c420ee523bf0b7">CPApp</a> currentEvent] clickCount] &gt; 1)
<a name="l04149"></a>04149         &amp;&amp; ((_implementedDataSourceMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a9f25c28df39dca590ad108beb6b4b48b">CPTableViewDataSource_tableView_setObjectValue_forTableColumn_row_</a>)
<a name="l04150"></a>04150             || [<span class="keyword">self</span> infoForBinding:<span class="stringliteral">@&quot;content&quot;</span>]))
<a name="l04151"></a>04151     {
<a name="l04152"></a>04152         columnIndex = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aa5bce119e8c4b79e4ed0f9a10172996d">columnAtPoint</a>:lastPoint];
<a name="l04153"></a>04153         <span class="keywordflow">if</span> (columnIndex !== -1)
<a name="l04154"></a>04154         {
<a name="l04155"></a>04155             column = _tableColumns[columnIndex];
<a name="l04156"></a>04156             <span class="keywordflow">if</span> ([column isEditable])
<a name="l04157"></a>04157             {
<a name="l04158"></a>04158                 rowIndex = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a6f1d4aad7598b4ca189e2a262d51cd08">rowAtPoint</a>:aPoint];
<a name="l04159"></a>04159                 <span class="keywordflow">if</span> (rowIndex !== -1)
<a name="l04160"></a>04160                 {
<a name="l04161"></a>04161                     <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a13a5d77ea463b7ee16d106bdf440baef">CPTableViewDelegate_tableView_shouldEditTableColumn_row_</a>)
<a name="l04162"></a>04162                         shouldEdit = [_delegate tableView:self shouldEditTableColumn:column row:rowIndex];
<a name="l04163"></a>04163                     <span class="keywordflow">if</span> (shouldEdit)
<a name="l04164"></a>04164                     {
<a name="l04165"></a>04165                         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a4787c1ca24a7e508bc95eabd86eddbbf">editColumn</a>:columnIndex <a class="code" href="interface_c_p_table_view.html#a4787c1ca24a7e508bc95eabd86eddbbf">row</a>:rowIndex <a class="code" href="interface_c_p_table_view.html#a4787c1ca24a7e508bc95eabd86eddbbf">withEvent</a>:nil <a class="code" href="interface_c_p_table_view.html#a4787c1ca24a7e508bc95eabd86eddbbf">select</a>:YES];
<a name="l04166"></a>04166                         <span class="keywordflow">return</span>;
<a name="l04167"></a>04167                     }
<a name="l04168"></a>04168                 }
<a name="l04169"></a>04169             }
<a name="l04170"></a>04170         }
<a name="l04171"></a>04171 
<a name="l04172"></a>04172     } <span class="comment">//end of editing conditional</span>
<a name="l04173"></a>04173 
<a name="l04174"></a>04174     <span class="comment">//double click actions</span>
<a name="l04175"></a>04175     <span class="keywordflow">if</span> ([[<a class="code" href="_c_p_application_8j.html#a428912231c07effc32c420ee523bf0b7">CPApp</a> currentEvent] clickCount] === 2 &amp;&amp; _doubleAction)
<a name="l04176"></a>04176     {
<a name="l04177"></a>04177         _clickedRow = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a6f1d4aad7598b4ca189e2a262d51cd08">rowAtPoint</a>:aPoint];
<a name="l04178"></a>04178         [<span class="keyword">self</span> <a class="code" href="interface_c_p_control.html#a29cd2ce9301709d266fc7f920c901ade">sendAction</a>:_doubleAction <a class="code" href="interface_c_p_control.html#a29cd2ce9301709d266fc7f920c901ade">to</a>:_target];
<a name="l04179"></a>04179     }
<a name="l04180"></a>04180 }
<a name="l04181"></a>04181 
<a name="l04182"></a>04182 <span class="comment">/*</span>
<a name="l04183"></a>04183 <span class="comment">    @ignore</span>
<a name="l04184"></a>04184 <span class="comment">*/</span>
<a name="l04185"></a><a class="code" href="interface_c_p_table_view.html#a917e31de3a4edadbd66e2c2095b70951">04185</a> - (CPDragOperation)draggingEntered:(<span class="keywordtype">id</span>)sender
<a name="l04186"></a>04186 {
<a name="l04187"></a>04187     var location = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ae2bfa5f8caa8e73b81f97180c50cd80f">convertPoint</a>:[sender draggingLocation] <a class="code" href="interface_c_p_view.html#ae2bfa5f8caa8e73b81f97180c50cd80f">fromView</a>:nil],
<a name="l04188"></a>04188         dropOperation = [<span class="keyword">self</span> _proposedDropOperationAtPoint:location],
<a name="l04189"></a>04189         row = [<span class="keyword">self</span> _proposedRowAtPoint:location];
<a name="l04190"></a>04190 
<a name="l04191"></a>04191     <span class="keywordflow">if</span> (_retargetedDropRow !== nil)
<a name="l04192"></a>04192         row = _retargetedDropRow;
<a name="l04193"></a>04193 
<a name="l04194"></a>04194     var draggedTypes = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ad1ecd9b6aa16014db655dff71ad7236b">registeredDraggedTypes</a>],
<a name="l04195"></a>04195         count = [draggedTypes count],
<a name="l04196"></a>04196         i = 0;
<a name="l04197"></a>04197 
<a name="l04198"></a>04198     <span class="keywordflow">for</span> (; i &lt; count; i++)
<a name="l04199"></a>04199     {
<a name="l04200"></a>04200         <span class="keywordflow">if</span> ([[[sender draggingPasteboard] types] containsObject:[draggedTypes objectAtIndex: i]])
<a name="l04201"></a>04201             <span class="keywordflow">return</span> [<span class="keyword">self</span> _validateDrop:sender proposedRow:row proposedDropOperation:dropOperation];
<a name="l04202"></a>04202     }
<a name="l04203"></a>04203 
<a name="l04204"></a>04204     <span class="keywordflow">return</span> <a class="code" href="_c_p_drag_server_8j.html#a10ed549b8e0424ca530089a1cf12bbd3">CPDragOperationNone</a>;
<a name="l04205"></a>04205 }
<a name="l04206"></a>04206 
<a name="l04207"></a>04207 <span class="comment">/*</span>
<a name="l04208"></a>04208 <span class="comment">    @ignore</span>
<a name="l04209"></a>04209 <span class="comment">*/</span>
<a name="l04210"></a><a class="code" href="interface_c_p_table_view.html#a7184eae8871a2f1046906dbd68ed4e5f">04210</a> - (void)draggingExited:(<span class="keywordtype">id</span>)sender
<a name="l04211"></a>04211 {
<a name="l04212"></a>04212     [_dropOperationFeedbackView removeFromSuperview];
<a name="l04213"></a>04213 }
<a name="l04214"></a>04214 
<a name="l04215"></a>04215 <span class="comment">/*</span>
<a name="l04216"></a>04216 <span class="comment">    @ignore</span>
<a name="l04217"></a>04217 <span class="comment">*/</span>
<a name="l04218"></a><a class="code" href="interface_c_p_table_view.html#a6db889a793062a09ddede1f02d991f5f">04218</a> - (void)draggingEnded:(<span class="keywordtype">id</span>)sender
<a name="l04219"></a>04219 {
<a name="l04220"></a>04220     [<span class="keyword">self</span> _draggingEnded];
<a name="l04221"></a>04221 }
<a name="l04222"></a>04222 
<a name="l04226"></a>04226 - (void)_draggingEnded
<a name="l04227"></a>04227 {
<a name="l04228"></a>04228     _retargetedDropOperation = nil;
<a name="l04229"></a>04229     _retargetedDropRow = nil;
<a name="l04230"></a>04230     _draggedRowIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l04231"></a>04231     [_dropOperationFeedbackView removeFromSuperview];
<a name="l04232"></a>04232 }
<a name="l04233"></a>04233 
<a name="l04234"></a>04234 <span class="comment">/*</span>
<a name="l04235"></a>04235 <span class="comment">    @ignore</span>
<a name="l04236"></a>04236 <span class="comment">*/</span>
<a name="l04237"></a><a class="code" href="interface_c_p_table_view.html#a84a148402b33c5309fb33eb077d016d0">04237</a> - (BOOL)wantsPeriodicDraggingUpdates
<a name="l04238"></a>04238 {
<a name="l04239"></a>04239     <span class="keywordflow">return</span> YES;
<a name="l04240"></a>04240 }
<a name="l04241"></a>04241 
<a name="l04242"></a>04242 <span class="comment">/*</span>
<a name="l04243"></a>04243 <span class="comment">    @ignore</span>
<a name="l04244"></a>04244 <span class="comment">*/</span>
<a name="l04245"></a>04245 - (CPTableViewDropOperation)_proposedDropOperationAtPoint:(CGPoint)theDragPoint
<a name="l04246"></a>04246 {
<a name="l04247"></a>04247     <span class="keywordflow">if</span> (_retargetedDropOperation !== nil)
<a name="l04248"></a>04248         <span class="keywordflow">return</span> _retargetedDropOperation;
<a name="l04249"></a>04249 
<a name="l04250"></a>04250     var row = [<span class="keyword">self</span> _proposedRowAtPoint:theDragPoint],
<a name="l04251"></a>04251         rowRect = [<span class="keyword">self</span> rectOfRow:row];
<a name="l04252"></a>04252 
<a name="l04253"></a>04253     <span class="comment">// If there is no (the default) or to little inter cell spacing we create some room for the CPTableViewDropAbove indicator</span>
<a name="l04254"></a>04254     <span class="comment">// This probably doesn&#39;t work if the row height is smaller than or around 5.0</span>
<a name="l04255"></a>04255     <span class="keywordflow">if</span> ([<span class="keyword">self</span> intercellSpacing].height &lt; 5.0)
<a name="l04256"></a>04256         rowRect = <a class="code" href="group__appkit.html#ga735dd5c3fb0f772f423562a82ef1e131">CPRectInset</a>(rowRect, 0.0, 5.0 - [<span class="keyword">self</span> intercellSpacing].height);
<a name="l04257"></a>04257 
<a name="l04258"></a>04258     <span class="comment">// If the altered row rect contains the drag point we show the drop on</span>
<a name="l04259"></a>04259     <span class="comment">// We don&#39;t show the drop on indicator if we are dragging below the last row</span>
<a name="l04260"></a>04260     <span class="comment">// in that case we always want to show the drop above indicator</span>
<a name="l04261"></a>04261     <span class="keywordflow">if</span> (CGRectContainsPoint(rowRect, theDragPoint) &amp;&amp; row &lt; _numberOfRows)
<a name="l04262"></a>04262         <span class="keywordflow">return</span> <a class="code" href="_c_p_table_view_8j.html#a279093eafa50075a94c202e0dd51861a">CPTableViewDropOn</a>;
<a name="l04263"></a>04263 
<a name="l04264"></a>04264     <span class="keywordflow">return</span> <a class="code" href="_c_p_table_view_8j.html#a4c2d1434c8bc5b937eeb47b55f5c74d0">CPTableViewDropAbove</a>;
<a name="l04265"></a>04265 }
<a name="l04266"></a>04266 
<a name="l04267"></a>04267 <span class="comment">/*</span>
<a name="l04268"></a>04268 <span class="comment">    @ignore</span>
<a name="l04269"></a>04269 <span class="comment">*/</span>
<a name="l04270"></a>04270 - (CPInteger)_proposedRowAtPoint:(CGPoint)dragPoint
<a name="l04271"></a>04271 {
<a name="l04272"></a>04272     var row = [<span class="keyword">self</span> rowAtPoint:dragPoint],
<a name="l04273"></a>04273     <span class="comment">// Determine if the mouse is currently closer to this row or the row below it</span>
<a name="l04274"></a>04274         lowerRow = row + 1,
<a name="l04275"></a>04275         rect = [self rectOfRow:row],
<a name="l04276"></a>04276         bottomPoint = _CGRectGetMaxY(rect),
<a name="l04277"></a>04277         bottomThirty = bottomPoint - ((bottomPoint - _CGRectGetMinY(rect)) * 0.3),
<a name="l04278"></a>04278         numberOfRows = [self numberOfRows];
<a name="l04279"></a>04279 
<a name="l04280"></a>04280     <span class="keywordflow">if</span> (row &lt; 0)
<a name="l04281"></a>04281         row = (_CGRectGetMaxY(rect) &lt; dragPoint.y) ? numberOfRows : row;
<a name="l04282"></a>04282     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dragPoint.y &gt; MAX(bottomThirty, bottomPoint - 6))
<a name="l04283"></a>04283         row = lowerRow;
<a name="l04284"></a>04284 
<a name="l04285"></a>04285     row = MIN(numberOfRows, row);
<a name="l04286"></a>04286 
<a name="l04287"></a>04287     <span class="keywordflow">return</span> row;
<a name="l04288"></a>04288 }
<a name="l04289"></a>04289 
<a name="l04293"></a>04293 - (void)_validateDrop:(<span class="keywordtype">id</span>)info proposedRow:(CPInteger)row proposedDropOperation:(CPTableViewDropOperation)dropOperation
<a name="l04294"></a>04294 {
<a name="l04295"></a>04295     <span class="keywordflow">if</span> (_implementedDataSourceMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a4f6917aa9754d8c13c933ae043ca4963">CPTableViewDataSource_tableView_validateDrop_proposedRow_proposedDropOperation_</a>)
<a name="l04296"></a>04296         <span class="keywordflow">return</span> [_dataSource tableView:self validateDrop:info proposedRow:row proposedDropOperation:dropOperation];
<a name="l04297"></a>04297 
<a name="l04298"></a>04298     <span class="keywordflow">return</span> <a class="code" href="_c_p_drag_server_8j.html#a10ed549b8e0424ca530089a1cf12bbd3">CPDragOperationNone</a>;
<a name="l04299"></a>04299 }
<a name="l04300"></a>04300 
<a name="l04304"></a>04304 - (CPRect)_rectForDropHighlightViewOnRow:(<span class="keywordtype">int</span>)theRowIndex
<a name="l04305"></a>04305 {
<a name="l04306"></a>04306     <span class="keywordflow">if</span> (theRowIndex &gt;= [<span class="keyword">self</span> numberOfRows])
<a name="l04307"></a>04307         theRowIndex = [<span class="keyword">self</span> numberOfRows] - 1;
<a name="l04308"></a>04308 
<a name="l04309"></a>04309     <span class="keywordflow">return</span> [<span class="keyword">self</span> _rectOfRow:theRowIndex checkRange:NO];
<a name="l04310"></a>04310 }
<a name="l04311"></a>04311 
<a name="l04315"></a>04315 - (CPRect)_rectForDropHighlightViewBetweenUpperRow:(<span class="keywordtype">int</span>)theUpperRowIndex andLowerRow:(<span class="keywordtype">int</span>)theLowerRowIndex offset:(CPPoint)theOffset
<a name="l04316"></a>04316 {
<a name="l04317"></a>04317     <span class="keywordflow">if</span> (theLowerRowIndex &gt; [<span class="keyword">self</span> numberOfRows])
<a name="l04318"></a>04318         theLowerRowIndex = [<span class="keyword">self</span> numberOfRows];
<a name="l04319"></a>04319 
<a name="l04320"></a>04320     <span class="keywordflow">return</span> [<span class="keyword">self</span> _rectOfRow:theLowerRowIndex checkRange:NO];
<a name="l04321"></a>04321 }
<a name="l04322"></a>04322 
<a name="l04326"></a><a class="code" href="interface_c_p_table_view.html#abeda677bfc7e10aac73b1fe55bb2dd9e">04326</a> - (CPDragOperation)draggingUpdated:(<span class="keywordtype">id</span>)sender
<a name="l04327"></a>04327 {
<a name="l04328"></a>04328     _retargetedDropRow = nil;
<a name="l04329"></a>04329     _retargetedDropOperation = nil;
<a name="l04330"></a>04330 
<a name="l04331"></a>04331     var location = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ae2bfa5f8caa8e73b81f97180c50cd80f">convertPoint</a>:[sender draggingLocation] <a class="code" href="interface_c_p_view.html#ae2bfa5f8caa8e73b81f97180c50cd80f">fromView</a>:nil],
<a name="l04332"></a>04332         dropOperation = [<span class="keyword">self</span> _proposedDropOperationAtPoint:location],
<a name="l04333"></a>04333         numberOfRows = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#ab93d1883609b8aaca737188ee9667c17">numberOfRows</a>],
<a name="l04334"></a>04334         row = [<span class="keyword">self</span> _proposedRowAtPoint:location],
<a name="l04335"></a>04335         dragOperation = [<span class="keyword">self</span> _validateDrop:sender proposedRow:row proposedDropOperation:dropOperation];
<a name="l04336"></a>04336 
<a name="l04337"></a>04337     <span class="keywordflow">if</span> (_retargetedDropRow !== nil)
<a name="l04338"></a>04338         row = _retargetedDropRow;
<a name="l04339"></a>04339     <span class="keywordflow">if</span> (_retargetedDropOperation !== nil)
<a name="l04340"></a>04340         dropOperation = _retargetedDropOperation;
<a name="l04341"></a>04341 
<a name="l04342"></a>04342 
<a name="l04343"></a>04343     <span class="keywordflow">if</span> (dropOperation === <a class="code" href="_c_p_table_view_8j.html#a279093eafa50075a94c202e0dd51861a">CPTableViewDropOn</a> &amp;&amp; row &gt;= numberOfRows)
<a name="l04344"></a>04344         row = numberOfRows - 1;
<a name="l04345"></a>04345 
<a name="l04346"></a>04346     var rect = _CGRectMakeZero();
<a name="l04347"></a>04347 
<a name="l04348"></a>04348     <span class="keywordflow">if</span> (row === -1)
<a name="l04349"></a>04349         rect = [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aafe2e8782dc906770b1dbfcbf97023a2">exposedRect</a>];
<a name="l04350"></a>04350 
<a name="l04351"></a>04351     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dropOperation === <a class="code" href="_c_p_table_view_8j.html#a4c2d1434c8bc5b937eeb47b55f5c74d0">CPTableViewDropAbove</a>)
<a name="l04352"></a>04352         rect = [<span class="keyword">self</span> _rectForDropHighlightViewBetweenUpperRow:row - 1 andLowerRow:row offset:location];
<a name="l04353"></a>04353 
<a name="l04354"></a>04354     <span class="keywordflow">else</span>
<a name="l04355"></a>04355         rect = [<span class="keyword">self</span> _rectForDropHighlightViewOnRow:row];
<a name="l04356"></a>04356 
<a name="l04357"></a>04357     [_dropOperationFeedbackView setDropOperation:row !== -1 ? dropOperation : CPDragOperationNone];
<a name="l04358"></a>04358     [_dropOperationFeedbackView setHidden:(dragOperation == CPDragOperationNone)];
<a name="l04359"></a>04359     [_dropOperationFeedbackView setFrame:rect];
<a name="l04360"></a>04360     [_dropOperationFeedbackView setCurrentRow:row];
<a name="l04361"></a>04361     [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#af4924adfc835aab52b493d32b8f49397">addSubview</a>:_dropOperationFeedbackView];
<a name="l04362"></a>04362 
<a name="l04363"></a>04363     <span class="keywordflow">return</span> dragOperation;
<a name="l04364"></a>04364 }
<a name="l04365"></a>04365 
<a name="l04366"></a>04366 <span class="comment">/*</span>
<a name="l04367"></a>04367 <span class="comment">    @ignore</span>
<a name="l04368"></a>04368 <span class="comment">*/</span>
<a name="l04369"></a><a class="code" href="interface_c_p_table_view.html#a1dbc3c06724af6921ba35a9c15b5c7c5">04369</a> - (BOOL)prepareForDragOperation:(<span class="keywordtype">id</span>)sender
<a name="l04370"></a>04370 {
<a name="l04371"></a>04371     <span class="comment">// FIX ME: is there anything else that needs to happen here?</span>
<a name="l04372"></a>04372     <span class="comment">// actual validation is called in dragginUpdated:</span>
<a name="l04373"></a>04373     [_dropOperationFeedbackView removeFromSuperview];
<a name="l04374"></a>04374 
<a name="l04375"></a>04375     <span class="keywordflow">return</span> (_implementedDataSourceMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a4f6917aa9754d8c13c933ae043ca4963">CPTableViewDataSource_tableView_validateDrop_proposedRow_proposedDropOperation_</a>);
<a name="l04376"></a>04376 }
<a name="l04377"></a>04377 
<a name="l04378"></a>04378 <span class="comment">/*</span>
<a name="l04379"></a>04379 <span class="comment">    @ignore</span>
<a name="l04380"></a>04380 <span class="comment">*/</span>
<a name="l04381"></a><a class="code" href="interface_c_p_table_view.html#af404297dc87b64a9111ed86eaa4f0881">04381</a> - (BOOL)performDragOperation:(<span class="keywordtype">id</span>)sender
<a name="l04382"></a>04382 {
<a name="l04383"></a>04383     var location = [<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ae2bfa5f8caa8e73b81f97180c50cd80f">convertPoint</a>:[sender draggingLocation] <a class="code" href="interface_c_p_view.html#ae2bfa5f8caa8e73b81f97180c50cd80f">fromView</a>:nil],
<a name="l04384"></a>04384         operation = [<span class="keyword">self</span> _proposedDropOperationAtPoint:location],
<a name="l04385"></a>04385         row = _retargetedDropRow;
<a name="l04386"></a>04386 
<a name="l04387"></a>04387     <span class="keywordflow">if</span> (row === nil)
<a name="l04388"></a>04388         var row = [<span class="keyword">self</span> _proposedRowAtPoint:location];
<a name="l04389"></a>04389 
<a name="l04390"></a>04390     <span class="keywordflow">return</span> [_dataSource tableView:self acceptDrop:sender row:row dropOperation:operation];
<a name="l04391"></a>04391 }
<a name="l04392"></a>04392 
<a name="l04393"></a>04393 <span class="comment">/*</span>
<a name="l04394"></a>04394 <span class="comment">    @ignore</span>
<a name="l04395"></a>04395 <span class="comment">*/</span>
<a name="l04396"></a><a class="code" href="interface_c_p_table_view.html#a9c2df81b08de90e3ca739e8433d1e4b1">04396</a> - (void)concludeDragOperation:(<span class="keywordtype">id</span>)sender
<a name="l04397"></a>04397 {
<a name="l04398"></a>04398     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a25ec67f805f6a97b91879cb04933310e">reloadData</a>];
<a name="l04399"></a>04399 }
<a name="l04400"></a>04400 
<a name="l04401"></a>04401 <span class="comment">/*</span>
<a name="l04402"></a>04402 <span class="comment">    This method is sent to the data source for convenience...</span>
<a name="l04403"></a>04403 <span class="comment">*/</span>
<a name="l04404"></a><a class="code" href="interface_c_p_table_view.html#ab92264bacee96b12c9c4180243807c69">04404</a> - (void)draggedImage:(<a class="code" href="interface_c_p_image.html">CPImage</a>)anImage endedAt:(CGPoint)aLocation operation:(CPDragOperation)anOperation
<a name="l04405"></a>04405 {
<a name="l04406"></a>04406     <span class="keywordflow">if</span> ([_dataSource respondsToSelector:<span class="keyword">@selector</span>(<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:didEndDraggedImage:atPosition:operation:)])
<a name="l04407"></a>04407         [_dataSource tableView:self didEndDraggedImage:anImage atPosition:aLocation operation:anOperation];
<a name="l04408"></a>04408 }
<a name="l04409"></a>04409 
<a name="l04410"></a>04410 <span class="comment">/*</span>
<a name="l04411"></a>04411 <span class="comment">    @ignore</span>
<a name="l04412"></a>04412 <span class="comment">    We&#39;re using this because we drag views instead of images so we can get the rows themselves to actually drag.</span>
<a name="l04413"></a>04413 <span class="comment">*/</span>
<a name="l04414"></a><a class="code" href="interface_c_p_table_view.html#a91b55cc101d16dead6206293bdfa11c1">04414</a> - (void)draggedView:(<a class="code" href="interface_c_p_image.html">CPImage</a>)aView endedAt:(CGPoint)aLocation operation:(CPDragOperation)anOperation
<a name="l04415"></a>04415 {
<a name="l04416"></a>04416     [<span class="keyword">self</span> _draggingEnded];
<a name="l04417"></a>04417     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#ab92264bacee96b12c9c4180243807c69">draggedImage</a>:aView <a class="code" href="interface_c_p_table_view.html#ab92264bacee96b12c9c4180243807c69">endedAt</a>:aLocation <a class="code" href="interface_c_p_table_view.html#ab92264bacee96b12c9c4180243807c69">operation</a>:anOperation];
<a name="l04418"></a>04418 }
<a name="l04419"></a>04419 
<a name="l04423"></a>04423 - (void)_updateSelectionWithMouseAtRow:(CPInteger)aRow
<a name="l04424"></a>04424 {
<a name="l04425"></a>04425     <span class="comment">//check to make sure the row exists</span>
<a name="l04426"></a>04426     <span class="keywordflow">if</span> (aRow &lt; 0)
<a name="l04427"></a>04427         <span class="keywordflow">return</span>;
<a name="l04428"></a>04428 
<a name="l04429"></a>04429     var newSelection,
<a name="l04430"></a>04430         shouldExtendSelection = NO;
<a name="l04431"></a>04431     <span class="comment">// If cmd/ctrl was held down XOR the old selection with the proposed selection</span>
<a name="l04432"></a>04432     <span class="keywordflow">if</span> ([<span class="keyword">self</span> mouseDownFlags] &amp; (<a class="code" href="_c_p_event_8j.html#a675a3ab6cfc14dd4ad6702d7c682c7fe">CPCommandKeyMask</a> | <a class="code" href="_c_p_event_8j.html#a144f394b3de6afb9b329491dba0e8d14">CPControlKeyMask</a> | <a class="code" href="_c_p_event_8j.html#abb24a409c7daa575dd1fa20b7fcf8d51">CPAlternateKeyMask</a>))
<a name="l04433"></a>04433     {
<a name="l04434"></a>04434         <span class="keywordflow">if</span> ([_selectedRowIndexes containsIndex:aRow])
<a name="l04435"></a>04435         {
<a name="l04436"></a>04436             newSelection = [_selectedRowIndexes copy];
<a name="l04437"></a>04437 
<a name="l04438"></a>04438             [newSelection removeIndex:aRow];
<a name="l04439"></a>04439         }
<a name="l04440"></a>04440 
<a name="l04441"></a>04441         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_allowsMultipleSelection)
<a name="l04442"></a>04442         {
<a name="l04443"></a>04443             newSelection = [_selectedRowIndexes copy];
<a name="l04444"></a>04444 
<a name="l04445"></a>04445             [newSelection addIndex:aRow];
<a name="l04446"></a>04446         }
<a name="l04447"></a>04447 
<a name="l04448"></a>04448         <span class="keywordflow">else</span>
<a name="l04449"></a>04449             newSelection = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:aRow];
<a name="l04450"></a>04450     }
<a name="l04451"></a>04451     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_allowsMultipleSelection)
<a name="l04452"></a>04452     {
<a name="l04453"></a>04453         newSelection = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4c32a454bd5323253b9e8c4f81712ea5">indexSetWithIndexesInRange</a>:CPMakeRange(MIN(aRow, _selectionAnchorRow), ABS(aRow - _selectionAnchorRow) + 1)];
<a name="l04454"></a>04454         shouldExtendSelection = [<span class="keyword">self</span> mouseDownFlags] &amp; <a class="code" href="_c_p_event_8j.html#a2343191b34b38dc1952bb44d83fa30d6">CPShiftKeyMask</a> &amp;&amp;
<a name="l04455"></a>04455                                 ((_lastSelectedRow == [_selectedRowIndexes lastIndex] &amp;&amp; aRow &gt; _lastSelectedRow) ||
<a name="l04456"></a>04456                                 (_lastSelectedRow == [_selectedRowIndexes firstIndex] &amp;&amp; aRow &lt; _lastSelectedRow));
<a name="l04457"></a>04457     }
<a name="l04458"></a>04458     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (aRow &gt;= 0 &amp;&amp; aRow &lt; _numberOfRows)
<a name="l04459"></a>04459         newSelection = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:aRow];
<a name="l04460"></a>04460     <span class="keywordflow">else</span>
<a name="l04461"></a>04461         newSelection = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>];
<a name="l04462"></a>04462 
<a name="l04463"></a>04463     <span class="keywordflow">if</span> ([newSelection isEqualToIndexSet:_selectedRowIndexes])
<a name="l04464"></a>04464         <span class="keywordflow">return</span>;
<a name="l04465"></a>04465 
<a name="l04466"></a>04466     <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a17dd3c2f77d47e02db83a2643962e03f">CPTableViewDelegate_selectionShouldChangeInTableView_</a> &amp;&amp;
<a name="l04467"></a>04467         ![_delegate selectionShouldChangeInTableView:<span class="keyword">self</span>])
<a name="l04468"></a>04468         <span class="keywordflow">return</span>;
<a name="l04469"></a>04469 
<a name="l04470"></a>04470     <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a87a639d266ecdd1db204b2b3e3d0e97d">CPTableViewDelegate_tableView_selectionIndexesForProposedSelection_</a>)
<a name="l04471"></a>04471         newSelection = [_delegate tableView:self selectionIndexesForProposedSelection:newSelection];
<a name="l04472"></a>04472 
<a name="l04473"></a>04473     <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#aaea951ab19dc11a096a69b28cc216e38">CPTableViewDelegate_tableView_shouldSelectRow_</a>)
<a name="l04474"></a>04474     {
<a name="l04475"></a>04475         var indexArray = [];
<a name="l04476"></a>04476 
<a name="l04477"></a>04477         [newSelection getIndexes:indexArray maxCount:-1 inIndexRange:nil];
<a name="l04478"></a>04478 
<a name="l04479"></a>04479         var indexCount = indexArray.length;
<a name="l04480"></a>04480 
<a name="l04481"></a>04481         <span class="keywordflow">while</span> (indexCount--)
<a name="l04482"></a>04482         {
<a name="l04483"></a>04483             var index = indexArray[indexCount];
<a name="l04484"></a>04484 
<a name="l04485"></a>04485             <span class="keywordflow">if</span> (![_delegate <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:<span class="keyword">self</span> shouldSelectRow:index])
<a name="l04486"></a>04486                 [newSelection removeIndex:index];
<a name="l04487"></a>04487         }
<a name="l04488"></a>04488 
<a name="l04489"></a>04489         <span class="comment">// as per cocoa</span>
<a name="l04490"></a>04490         <span class="keywordflow">if</span> ([newSelection count] === 0)
<a name="l04491"></a>04491             <span class="keywordflow">return</span>;
<a name="l04492"></a>04492     }
<a name="l04493"></a>04493 
<a name="l04494"></a>04494     <span class="comment">// if empty selection is not allowed and the new selection has nothing selected, abort</span>
<a name="l04495"></a>04495     <span class="keywordflow">if</span> (!_allowsEmptySelection &amp;&amp; [newSelection count] === 0)
<a name="l04496"></a>04496         <span class="keywordflow">return</span>;
<a name="l04497"></a>04497 
<a name="l04498"></a>04498     <span class="keywordflow">if</span> ([newSelection isEqualToIndexSet:_selectedRowIndexes])
<a name="l04499"></a>04499         <span class="keywordflow">return</span>;
<a name="l04500"></a>04500 
<a name="l04501"></a>04501     [<span class="keyword">self</span> selectRowIndexes:newSelection byExtendingSelection:shouldExtendSelection];
<a name="l04502"></a>04502 
<a name="l04503"></a>04503     _lastSelectedRow = [newSelection containsIndex:aRow] ? aRow : [newSelection lastIndex];
<a name="l04504"></a>04504 }
<a name="l04505"></a>04505 
<a name="l04509"></a>04509 - (void)_noteSelectionIsChanging
<a name="l04510"></a>04510 {
<a name="l04511"></a>04511     [[<a class="code" href="interface_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="interface_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>]
<a name="l04512"></a>04512         <a class="code" href="interface_c_p_notification_center.html#ac5e7dc8d0972292f52736f6f662bb25a">postNotificationName</a>:CPTableViewSelectionIsChangingNotification
<a name="l04513"></a>04513                       <a class="code" href="interface_c_p_notification_center.html#ac5e7dc8d0972292f52736f6f662bb25a">object</a>:self
<a name="l04514"></a>04514                     <a class="code" href="interface_c_p_notification_center.html#ac5e7dc8d0972292f52736f6f662bb25a">userInfo</a>:nil];
<a name="l04515"></a>04515 }
<a name="l04516"></a>04516 
<a name="l04520"></a>04520 - (void)_noteSelectionDidChange
<a name="l04521"></a>04521 {
<a name="l04522"></a>04522     [[<a class="code" href="interface_c_p_notification_center.html" title="Sends messages (CPNotification) between objects.">CPNotificationCenter</a> <a class="code" href="interface_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>]
<a name="l04523"></a>04523         <a class="code" href="interface_c_p_notification_center.html#ac5e7dc8d0972292f52736f6f662bb25a">postNotificationName</a>:CPTableViewSelectionDidChangeNotification
<a name="l04524"></a>04524                       <a class="code" href="interface_c_p_notification_center.html#ac5e7dc8d0972292f52736f6f662bb25a">object</a>:self
<a name="l04525"></a>04525                     <a class="code" href="interface_c_p_notification_center.html#ac5e7dc8d0972292f52736f6f662bb25a">userInfo</a>:nil];
<a name="l04526"></a>04526 }
<a name="l04527"></a>04527 
<a name="l04531"></a><a class="code" href="interface_c_p_table_view.html#a11b8c128c30eddaa1c1e4934183dee4a">04531</a> - (BOOL)becomeFirstResponder
<a name="l04532"></a>04532 {
<a name="l04533"></a>04533     <span class="keywordflow">return</span> YES;
<a name="l04534"></a>04534 }
<a name="l04535"></a>04535 
<a name="l04539"></a><a class="code" href="interface_c_p_table_view.html#a2a59649caf5935edd4b2d24ee477cc6b">04539</a> - (BOOL)acceptsFirstResponder
<a name="l04540"></a>04540 {
<a name="l04541"></a>04541     <span class="keywordflow">return</span> YES;
<a name="l04542"></a>04542 }
<a name="l04543"></a>04543 
<a name="l04547"></a><a class="code" href="interface_c_p_table_view.html#acef038119638ef86e8c02a10d7076c7e">04547</a> - (void)keyDown:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)anEvent
<a name="l04548"></a>04548 {
<a name="l04549"></a>04549     var character = [anEvent <a class="code" href="interface_c_p_event.html#aa1b99c685842a415f6736d776c8aba90">charactersIgnoringModifiers</a>],
<a name="l04550"></a>04550         modifierFlags = [anEvent <a class="code" href="interface_c_p_event.html#ae1990580a2f73b19009f30f27ff1e396">modifierFlags</a>];
<a name="l04551"></a>04551 
<a name="l04552"></a>04552     <span class="comment">// Check for the key events manually, as opposed to waiting for CPWindow to sent the actual action message</span>
<a name="l04553"></a>04553     <span class="comment">// in _processKeyboardUIKey:, because we might not want to handle the arrow events.</span>
<a name="l04554"></a>04554     <span class="keywordflow">if</span> (character === <a class="code" href="_c_p_event_8j.html#ae1778265f97b7c394c0617159156585c">CPUpArrowFunctionKey</a> || character === <a class="code" href="_c_p_event_8j.html#a81c853f6885886ea46e804182dd4fa0b">CPDownArrowFunctionKey</a>)
<a name="l04555"></a>04555     {
<a name="l04556"></a>04556         <span class="comment">// We&#39;re not interested in the arrow keys if there are no rows.</span>
<a name="l04557"></a>04557         <span class="comment">// Technically we should also not be interested if we can&#39;t scroll,</span>
<a name="l04558"></a>04558         <span class="comment">// but Cocoa doesn&#39;t handle that situation either.</span>
<a name="l04559"></a>04559         <span class="keywordflow">if</span> ([<span class="keyword">self</span> numberOfRows] !== 0)
<a name="l04560"></a>04560         {
<a name="l04561"></a>04561             [<span class="keyword">self</span> _moveSelectionWithEvent:anEvent upward:(character === CPUpArrowFunctionKey)];
<a name="l04562"></a>04562 
<a name="l04563"></a>04563             <span class="keywordflow">return</span>;
<a name="l04564"></a>04564         }
<a name="l04565"></a>04565     }
<a name="l04566"></a>04566     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (character === <a class="code" href="_c_p_text_8j.html#ac307a9857718545f7f0b9d43c0e6009c">CPDeleteCharacter</a> || character === <a class="code" href="_c_p_event_8j.html#a18dd9139c2e4b4c4b833138bf7d73b40">CPDeleteFunctionKey</a>)
<a name="l04567"></a>04567     {
<a name="l04568"></a>04568         <span class="comment">// Don&#39;t call super if the delegate is interested in the delete key</span>
<a name="l04569"></a>04569         <span class="keywordflow">if</span> ([<span class="keyword">self</span> _sendDelegateDeleteKeyPressed])
<a name="l04570"></a>04570             <span class="keywordflow">return</span>;
<a name="l04571"></a>04571     }
<a name="l04572"></a>04572 
<a name="l04573"></a>04573     [<span class="keyword">super</span> <a class="code" href="interface_c_p_responder.html#ab79a1f20ad2061e44fcf08ced0e2d391">keyDown</a>:anEvent];
<a name="l04574"></a>04574 }
<a name="l04575"></a>04575 
<a name="l04581"></a>04581 - (BOOL)_selectionIsBroken
<a name="l04582"></a>04582 {
<a name="l04583"></a>04583     <span class="keywordflow">return</span> [<span class="keyword">self</span> selectedRowIndexes]._ranges.length !== 1;
<a name="l04584"></a>04584 }
<a name="l04585"></a>04585 
<a name="l04591"></a>04591 - (void)_moveSelectionWithEvent:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)theEvent upward:(BOOL)shouldGoUpward
<a name="l04592"></a>04592 {
<a name="l04593"></a>04593     <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#a17dd3c2f77d47e02db83a2643962e03f">CPTableViewDelegate_selectionShouldChangeInTableView_</a> &amp;&amp; ![_delegate selectionShouldChangeInTableView:<span class="keyword">self</span>])
<a name="l04594"></a>04594         <span class="keywordflow">return</span>;
<a name="l04595"></a>04595     var selectedIndexes = [<span class="keyword">self</span> selectedRowIndexes];
<a name="l04596"></a>04596 
<a name="l04597"></a>04597     <span class="keywordflow">if</span> ([selectedIndexes count] &gt; 0)
<a name="l04598"></a>04598     {
<a name="l04599"></a>04599         var extend = (([theEvent <a class="code" href="interface_c_p_event.html#ae1990580a2f73b19009f30f27ff1e396">modifierFlags</a>] &amp; <a class="code" href="_c_p_event_8j.html#a2343191b34b38dc1952bb44d83fa30d6">CPShiftKeyMask</a>) &amp;&amp; _allowsMultipleSelection),
<a name="l04600"></a>04600             i = [<span class="keyword">self</span> selectedRow];
<a name="l04601"></a>04601 
<a name="l04602"></a>04602         <span class="keywordflow">if</span> ([<span class="keyword">self</span> _selectionIsBroken])
<a name="l04603"></a>04603         {
<a name="l04604"></a>04604             <span class="keywordflow">while</span> ([selectedIndexes containsIndex:i])
<a name="l04605"></a>04605             {
<a name="l04606"></a>04606                 shouldGoUpward ? i-- : i++;
<a name="l04607"></a>04607             }
<a name="l04608"></a>04608             _wasSelectionBroken = <span class="keyword">true</span>;
<a name="l04609"></a>04609         }
<a name="l04610"></a>04610         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_wasSelectionBroken &amp;&amp; ((shouldGoUpward &amp;&amp; i !== [selectedIndexes firstIndex]) || (!shouldGoUpward &amp;&amp; i !== [selectedIndexes lastIndex])))
<a name="l04611"></a>04611         {
<a name="l04612"></a>04612             shouldGoUpward ? i = [selectedIndexes firstIndex] - 1 : i = [selectedIndexes lastIndex];
<a name="l04613"></a>04613             _wasSelectionBroken = <span class="keyword">false</span>;
<a name="l04614"></a>04614         }
<a name="l04615"></a>04615         <span class="keywordflow">else</span>
<a name="l04616"></a>04616         {
<a name="l04617"></a>04617             shouldGoUpward ? i-- : i++;
<a name="l04618"></a>04618         }
<a name="l04619"></a>04619     }
<a name="l04620"></a>04620     <span class="keywordflow">else</span>
<a name="l04621"></a>04621     {
<a name="l04622"></a>04622         var extend = NO;
<a name="l04623"></a>04623         <span class="comment">//no rows are currently selected</span>
<a name="l04624"></a>04624         <span class="keywordflow">if</span> ([<span class="keyword">self</span> numberOfRows] &gt; 0)
<a name="l04625"></a>04625             var i = shouldGoUpward ? [<span class="keyword">self</span> numberOfRows] - 1 : 0; <span class="comment">// if we select upward select the last row, otherwise select the first row</span>
<a name="l04626"></a>04626     }
<a name="l04627"></a>04627 
<a name="l04628"></a>04628     <span class="keywordflow">if</span> (i &gt;= [<span class="keyword">self</span> numberOfRows] || i &lt; 0)
<a name="l04629"></a>04629         <span class="keywordflow">return</span>;
<a name="l04630"></a>04630 
<a name="l04631"></a>04631 
<a name="l04632"></a>04632     <span class="keywordflow">if</span> (_implementedDelegateMethods &amp; <a class="code" href="_c_p_table_view_8j.html#aaea951ab19dc11a096a69b28cc216e38">CPTableViewDelegate_tableView_shouldSelectRow_</a>)
<a name="l04633"></a>04633     {
<a name="l04634"></a>04634 
<a name="l04635"></a>04635         <span class="keywordflow">while</span> (![_delegate <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:<span class="keyword">self</span> shouldSelectRow:i] &amp;&amp; (i &lt; [<span class="keyword">self</span> numberOfRows] || i &gt; 0))
<a name="l04636"></a>04636             shouldGoUpward ? i-- : i++; <span class="comment">//check to see if the row can be selected if it can&#39;t be then see if the next row can be selected</span>
<a name="l04637"></a>04637 
<a name="l04638"></a>04638         <span class="comment">//if the index still can be selected after the loop then just return</span>
<a name="l04639"></a>04639          <span class="keywordflow">if</span> (![_delegate <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>:<span class="keyword">self</span> shouldSelectRow:i])
<a name="l04640"></a>04640              <span class="keywordflow">return</span>;
<a name="l04641"></a>04641     }
<a name="l04642"></a>04642 
<a name="l04643"></a>04643     <span class="comment">// if we go upward and see that this row is already selected we should deselect the row below</span>
<a name="l04644"></a>04644     <span class="keywordflow">if</span> ([selectedIndexes containsIndex:i] &amp;&amp; extend)
<a name="l04645"></a>04645     {
<a name="l04646"></a>04646         <span class="comment">// the row we&#39;re on is the last to be selected</span>
<a name="l04647"></a>04647         var differedLastSelectedRow = i;
<a name="l04648"></a>04648 
<a name="l04649"></a>04649         <span class="comment">// no remove the one before/after it</span>
<a name="l04650"></a>04650         shouldGoUpward ? i++  : i--;
<a name="l04651"></a>04651 
<a name="l04652"></a>04652         [selectedIndexes removeIndex:i];
<a name="l04653"></a>04653 
<a name="l04654"></a>04654         <span class="comment">//we&#39;re going to replace the selection</span>
<a name="l04655"></a>04655         extend = NO;
<a name="l04656"></a>04656     }
<a name="l04657"></a>04657     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (extend)
<a name="l04658"></a>04658     {
<a name="l04659"></a>04659         <span class="keywordflow">if</span> ([selectedIndexes containsIndex:i])
<a name="l04660"></a>04660         {
<a name="l04661"></a>04661             i = shouldGoUpward ? [selectedIndexes firstIndex] -1 : [selectedIndexes lastIndex] + 1;
<a name="l04662"></a>04662             i = MIN(MAX(i,0), [<span class="keyword">self</span> numberOfRows] - 1);
<a name="l04663"></a>04663         }
<a name="l04664"></a>04664 
<a name="l04665"></a>04665         [selectedIndexes addIndex:i];
<a name="l04666"></a>04666         var differedLastSelectedRow = i;
<a name="l04667"></a>04667     }
<a name="l04668"></a>04668     <span class="keywordflow">else</span>
<a name="l04669"></a>04669     {
<a name="l04670"></a>04670         selectedIndexes = [<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> <a class="code" href="class_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:i];
<a name="l04671"></a>04671         var differedLastSelectedRow = i;
<a name="l04672"></a>04672     }
<a name="l04673"></a>04673 
<a name="l04674"></a>04674     [<span class="keyword">self</span> selectRowIndexes:selectedIndexes byExtendingSelection:extend];
<a name="l04675"></a>04675 
<a name="l04676"></a>04676     <span class="comment">// we differ because selectRowIndexes: does its own thing which would set the wrong index</span>
<a name="l04677"></a>04677     _lastSelectedRow = differedLastSelectedRow;
<a name="l04678"></a>04678 
<a name="l04679"></a>04679     <span class="keywordflow">if</span> (i !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l04680"></a>04680         [<span class="keyword">self</span> scrollRowToVisible:i];
<a name="l04681"></a>04681 }
<a name="l04682"></a>04682 
<a name="l04683"></a>04683 <span class="keyword">@end</span>
<a name="l04684"></a>04684 
<a name="l04685"></a>04685 <span class="keyword">@implementation </span><a class="code" href="interface_c_p_table_view.html">CPTableView</a> (Bindings)
<a name="l04686"></a>04686 
<a name="l04690"></a>04690 - (<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)_replacementKeyPathForBinding:(<a class="code" href="class_c_p_string.html" title="An immutable string (collection of characters).">CPString</a>)aBinding
<a name="l04691"></a>04691 {
<a name="l04692"></a>04692     <span class="keywordflow">if</span> (aBinding === <span class="stringliteral">@&quot;selectionIndexes&quot;</span>)
<a name="l04693"></a>04693         <span class="keywordflow">return</span> <span class="stringliteral">@&quot;selectedRowIndexes&quot;</span>;
<a name="l04694"></a>04694 
<a name="l04695"></a>04695     <span class="keywordflow">return</span> [<span class="keyword">super</span> _replacementKeyPathForBinding:aBinding];
<a name="l04696"></a>04696 }
<a name="l04697"></a>04697 
<a name="l04701"></a>04701 - (void)_establishBindingsIfUnbound:(<span class="keywordtype">id</span>)destination
<a name="l04702"></a>04702 {
<a name="l04703"></a>04703     <span class="keywordflow">if</span> ([[<span class="keyword">self</span> infoForBinding:<span class="stringliteral">@&quot;content&quot;</span>] objectForKey:CPObservedObjectKey] !== destination)
<a name="l04704"></a>04704         [<span class="keyword">self</span> bind:@&quot;content&quot; toObject:destination withKeyPath:@&quot;arrangedObjects&quot; options:nil];
<a name="l04705"></a>04705 
<a name="l04706"></a>04706     <span class="keywordflow">if</span> ([[<span class="keyword">self</span> infoForBinding:<span class="stringliteral">@&quot;selectionIndexes&quot;</span>] objectForKey:CPObservedObjectKey] !== destination)
<a name="l04707"></a>04707         [<span class="keyword">self</span> bind:@&quot;selectionIndexes&quot; toObject:destination withKeyPath:@&quot;selectionIndexes&quot; options:nil];
<a name="l04708"></a>04708 
<a name="l04709"></a>04709     <span class="comment">//[self bind:@&quot;sortDescriptors&quot; toObject:destination withKeyPath:@&quot;sortDescriptors&quot; options:nil];</span>
<a name="l04710"></a>04710 }
<a name="l04711"></a>04711 
<a name="l04712"></a><a class="code" href="interface_c_p_table_view.html#a5900067361b1513319b0a3b8f7a80c9d">04712</a> - (void)setContent:(<a class="code" href="interface_c_p_array.html" title="A mutable array backed by a JavaScript Array.A mutable array class backed by a JavaScript Array...">CPArray</a>)content
<a name="l04713"></a>04713 {
<a name="l04714"></a>04714     [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a25ec67f805f6a97b91879cb04933310e">reloadData</a>];
<a name="l04715"></a>04715 }
<a name="l04716"></a>04716 
<a name="l04717"></a>04717 <span class="keyword">@end</span>
<a name="l04718"></a>04718 
<a name="l04719"></a><a class="code" href="_c_p_table_view_8j.html#a3735b96051bc5ac351c70b3fe5d49126">04719</a> var <a class="code" href="_c_p_table_view_8j.html#a3735b96051bc5ac351c70b3fe5d49126">CPTableViewDataSourceKey</a>                = <span class="stringliteral">@&quot;CPTableViewDataSourceKey&quot;</span>,
<a name="l04720"></a><a class="code" href="_c_p_table_view_8j.html#a1d6265a4e180c8fc79fa0653f3a42b5d">04720</a>     <a class="code" href="_c_p_table_view_8j.html#a1d6265a4e180c8fc79fa0653f3a42b5d">CPTableViewDelegateKey</a>                  = <span class="stringliteral">@&quot;CPTableViewDelegateKey&quot;</span>,
<a name="l04721"></a><a class="code" href="_c_p_table_view_8j.html#a249d34f03b936c7d41a2028ceb1f7e13">04721</a>     <a class="code" href="_c_p_table_view_8j.html#a249d34f03b936c7d41a2028ceb1f7e13">CPTableViewHeaderViewKey</a>                = <span class="stringliteral">@&quot;CPTableViewHeaderViewKey&quot;</span>,
<a name="l04722"></a><a class="code" href="_c_p_table_view_8j.html#a10daae21892ff9308af8721efe4a9e24">04722</a>     <a class="code" href="_c_p_table_view_8j.html#a10daae21892ff9308af8721efe4a9e24">CPTableViewTableColumnsKey</a>              = <span class="stringliteral">@&quot;CPTableViewTableColumnsKey&quot;</span>,
<a name="l04723"></a><a class="code" href="_c_p_table_view_8j.html#a0f4346d28a9ff7f382a9b4ceac22f0f2">04723</a>     <a class="code" href="_c_p_table_view_8j.html#a0f4346d28a9ff7f382a9b4ceac22f0f2">CPTableViewRowHeightKey</a>                 = <span class="stringliteral">@&quot;CPTableViewRowHeightKey&quot;</span>,
<a name="l04724"></a><a class="code" href="_c_p_table_view_8j.html#a3459f0e162c9fdaa9d9251365df5aba0">04724</a>     <a class="code" href="_c_p_table_view_8j.html#a3459f0e162c9fdaa9d9251365df5aba0">CPTableViewIntercellSpacingKey</a>          = <span class="stringliteral">@&quot;CPTableViewIntercellSpacingKey&quot;</span>,
<a name="l04725"></a><a class="code" href="_c_p_table_view_8j.html#aa1db315678b5ce21fcb790d7b945839c">04725</a>     <a class="code" href="_c_p_table_view_8j.html#aa1db315678b5ce21fcb790d7b945839c">CPTableViewSelectionHighlightStyleKey</a>   = <span class="stringliteral">@&quot;CPTableViewSelectionHighlightStyleKey&quot;</span>,
<a name="l04726"></a><a class="code" href="_c_p_table_view_8j.html#a94bdb3dd3b74f91fad23bc9ab097d067">04726</a>     <a class="code" href="_c_p_table_view_8j.html#a94bdb3dd3b74f91fad23bc9ab097d067">CPTableViewMultipleSelectionKey</a>         = <span class="stringliteral">@&quot;CPTableViewMultipleSelectionKey&quot;</span>,
<a name="l04727"></a><a class="code" href="_c_p_table_view_8j.html#a129e907aaab3495bf0b923cc1be6f48e">04727</a>     <a class="code" href="_c_p_table_view_8j.html#a129e907aaab3495bf0b923cc1be6f48e">CPTableViewEmptySelectionKey</a>            = <span class="stringliteral">@&quot;CPTableViewEmptySelectionKey&quot;</span>,
<a name="l04728"></a><a class="code" href="_c_p_table_view_8j.html#aae1c199636e44c44b958774033d0b6bb">04728</a>     <a class="code" href="_c_p_table_view_8j.html#aae1c199636e44c44b958774033d0b6bb">CPTableViewColumnReorderingKey</a>          = <span class="stringliteral">@&quot;CPTableViewColumnReorderingKey&quot;</span>,
<a name="l04729"></a><a class="code" href="_c_p_table_view_8j.html#a6a9b6cd9d76351a4b0435a25dfd1d9e1">04729</a>     <a class="code" href="_c_p_table_view_8j.html#a6a9b6cd9d76351a4b0435a25dfd1d9e1">CPTableViewColumnResizingKey</a>            = <span class="stringliteral">@&quot;CPTableViewColumnResizingKey&quot;</span>,
<a name="l04730"></a><a class="code" href="_c_p_table_view_8j.html#a73766d88a09c50be1f1e5382384555a3">04730</a>     <a class="code" href="_c_p_table_view_8j.html#a73766d88a09c50be1f1e5382384555a3">CPTableViewColumnSelectionKey</a>           = <span class="stringliteral">@&quot;CPTableViewColumnSelectionKey&quot;</span>,
<a name="l04731"></a><a class="code" href="_c_p_table_view_8j.html#a45083376bbddf64913daf0d7f9a5e33a">04731</a>     <a class="code" href="_c_p_table_view_8j.html#a45083376bbddf64913daf0d7f9a5e33a">CPTableViewColumnAutoresizingStyleKey</a>   = <span class="stringliteral">@&quot;CPTableViewColumnAutoresizingStyleKey&quot;</span>,
<a name="l04732"></a><a class="code" href="_c_p_table_view_8j.html#a65100994e5f1bb660a4953bb99e99b3f">04732</a>     <a class="code" href="_c_p_table_view_8j.html#a65100994e5f1bb660a4953bb99e99b3f">CPTableViewGridColorKey</a>                 = <span class="stringliteral">@&quot;CPTableViewGridColorKey&quot;</span>,
<a name="l04733"></a><a class="code" href="_c_p_table_view_8j.html#a0f557abb46aa661ee0ccca18398d053f">04733</a>     <a class="code" href="_c_p_table_view_8j.html#a0f557abb46aa661ee0ccca18398d053f">CPTableViewGridStyleMaskKey</a>             = <span class="stringliteral">@&quot;CPTableViewGridStyleMaskKey&quot;</span>,
<a name="l04734"></a><a class="code" href="_c_p_table_view_8j.html#ae14aa7a0bfbabe81b219baafe1338614">04734</a>     <a class="code" href="_c_p_table_view_8j.html#ae14aa7a0bfbabe81b219baafe1338614">CPTableViewUsesAlternatingBackgroundKey</a> = <span class="stringliteral">@&quot;CPTableViewUsesAlternatingBackgroundKey&quot;</span>,
<a name="l04735"></a><a class="code" href="_c_p_table_view_8j.html#a9a6e49d234e93ae63319031b510c5714">04735</a>     <a class="code" href="_c_p_table_view_8j.html#a9a6e49d234e93ae63319031b510c5714">CPTableViewAlternatingRowColorsKey</a>      = <span class="stringliteral">@&quot;CPTableViewAlternatingRowColorsKey&quot;</span>,
<a name="l04736"></a>04736     <a class="code" href="_c_p_table_view_8j.html#a249d34f03b936c7d41a2028ceb1f7e13">CPTableViewHeaderViewKey</a>                = <span class="stringliteral">@&quot;CPTableViewHeaderViewKey&quot;</span>,
<a name="l04737"></a><a class="code" href="_c_p_table_view_8j.html#a2603164ca98d123c78e88939205d38e4">04737</a>     <a class="code" href="_c_p_table_view_8j.html#a2603164ca98d123c78e88939205d38e4">CPTableViewCornerViewKey</a>                = <span class="stringliteral">@&quot;CPTableViewCornerViewKey&quot;</span>,
<a name="l04738"></a><a class="code" href="_c_p_table_view_8j.html#ab35607914f144a63f5fdbb0ed9f35e69">04738</a>     <a class="code" href="_c_p_table_view_8j.html#ab35607914f144a63f5fdbb0ed9f35e69">CPTableViewAutosaveNameKey</a>              = <span class="stringliteral">@&quot;CPTableViewAutosaveNameKey&quot;</span>;
<a name="l04739"></a>04739 
<a name="l04740"></a>04740 <span class="keyword">@implementation </span><a class="code" href="interface_c_p_table_view.html">CPTableView</a> (CPCoding)
<a name="l04741"></a>04741 
<a name="l04742"></a><a class="code" href="interface_c_p_table_view.html#a02877f5a02c4821d135993877ecbf6ff">04742</a> - (id)initWithCoder:(<a class="code" href="interface_c_p_coder.html" title="Defines methods for use when archiving &amp; restoring (enc/decoding).">CPCoder</a>)aCoder
<a name="l04743"></a>04743 {
<a name="l04744"></a>04744     <span class="keyword">self</span> = [<span class="keyword">super</span> <a class="code" href="interface_c_p_control.html#a3d5b4fdb3d98b155e15b7d2da8c64de7">initWithCoder</a>:aCoder];
<a name="l04745"></a>04745 
<a name="l04746"></a>04746     <span class="keywordflow">if</span> (<span class="keyword">self</span>)
<a name="l04747"></a>04747     {
<a name="l04748"></a>04748         <span class="comment">//Configuring Behavior</span>
<a name="l04749"></a>04749         _allowsColumnReordering = [aCoder decodeBoolForKey:CPTableViewColumnReorderingKey];
<a name="l04750"></a>04750         _allowsColumnResizing = [aCoder decodeBoolForKey:CPTableViewColumnResizingKey];
<a name="l04751"></a>04751         _allowsMultipleSelection = [aCoder decodeBoolForKey:CPTableViewMultipleSelectionKey];
<a name="l04752"></a>04752         _allowsEmptySelection = [aCoder decodeBoolForKey:CPTableViewEmptySelectionKey];
<a name="l04753"></a>04753         _allowsColumnSelection = [aCoder decodeBoolForKey:CPTableViewColumnSelectionKey];
<a name="l04754"></a>04754 
<a name="l04755"></a>04755         <span class="comment">//Setting Display Attributes</span>
<a name="l04756"></a>04756         _selectionHighlightStyle = [aCoder decodeIntForKey:CPTableViewSelectionHighlightStyleKey];
<a name="l04757"></a>04757         _columnAutoResizingStyle = [aCoder decodeIntForKey:CPTableViewColumnAutoresizingStyleKey];
<a name="l04758"></a>04758 
<a name="l04759"></a>04759         _tableColumns = [aCoder decodeObjectForKey:CPTableViewTableColumnsKey] || [];
<a name="l04760"></a>04760         [_tableColumns makeObjectsPerformSelector:@selector(setTableView:) withObject:self];
<a name="l04761"></a>04761 
<a name="l04762"></a>04762         <span class="keywordflow">if</span> ([aCoder containsValueForKey:<a class="code" href="_c_p_table_view_8j.html#a0f4346d28a9ff7f382a9b4ceac22f0f2">CPTableViewRowHeightKey</a>])
<a name="l04763"></a>04763             _rowHeight = [aCoder decodeFloatForKey:CPTableViewRowHeightKey];
<a name="l04764"></a>04764         <span class="keywordflow">else</span>
<a name="l04765"></a>04765             _rowHeight = 23.0;
<a name="l04766"></a>04766 
<a name="l04767"></a>04767         _intercellSpacing = [aCoder decodeSizeForKey:CPTableViewIntercellSpacingKey] || _CGSizeMake(3.0, 2.0);
<a name="l04768"></a>04768 
<a name="l04769"></a>04769         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a87d09099f126a8e7e741a192e05e10f7">setGridColor</a>:[aCoder decodeObjectForKey:CPTableViewGridColorKey]];
<a name="l04770"></a>04770         _gridStyleMask = [aCoder decodeIntForKey:CPTableViewGridStyleMaskKey] || <a class="code" href="_c_p_table_view_8j.html#aa39cb0e13ea617a0962d2b72bbbedd81">CPTableViewGridNone</a>;
<a name="l04771"></a>04771 
<a name="l04772"></a>04772         _usesAlternatingRowBackgroundColors = [aCoder decodeObjectForKey:CPTableViewUsesAlternatingBackgroundKey];
<a name="l04773"></a>04773         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aa50e7802368fe0b0be6756beaa70fd71">setAlternatingRowBackgroundColors</a>:[aCoder decodeObjectForKey:CPTableViewAlternatingRowColorsKey]];
<a name="l04774"></a>04774 
<a name="l04775"></a>04775         _headerView = [aCoder decodeObjectForKey:CPTableViewHeaderViewKey];
<a name="l04776"></a>04776         _cornerView = [aCoder decodeObjectForKey:CPTableViewCornerViewKey];
<a name="l04777"></a>04777 
<a name="l04778"></a>04778         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a13b891524111eeb3c8873a789df3cb6a">setDataSource</a>:[aCoder decodeObjectForKey:CPTableViewDataSourceKey]];
<a name="l04779"></a>04779         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#ad35bac24324e17ec66afbafce1a6e597">setDelegate</a>:[aCoder decodeObjectForKey:CPTableViewDelegateKey]];
<a name="l04780"></a>04780 
<a name="l04781"></a>04781         [<span class="keyword">self</span> _init];
<a name="l04782"></a>04782 
<a name="l04783"></a>04783         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a7a71c5e32d14791d19693f9a87d88491">viewWillMoveToSuperview</a>:[<span class="keyword">self</span> <a class="code" href="interface_c_p_view.html#ae7fe2569d290f7eaabdebf5d48cb2745">superview</a>]];
<a name="l04784"></a>04784 
<a name="l04785"></a>04785         <span class="comment">// Do this as late as possible to make sure the tableview is fully configured</span>
<a name="l04786"></a>04786         [<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a13be1e95519d062c419a1e8e321bc81e">setAutosaveName</a>:[aCoder decodeObjectForKey:CPTableViewAutosaveNameKey]];
<a name="l04787"></a>04787     }
<a name="l04788"></a>04788 
<a name="l04789"></a>04789     <span class="keywordflow">return</span> <span class="keyword">self</span>;
<a name="l04790"></a>04790 }
<a name="l04791"></a>04791 
<a name="l04792"></a><a class="code" href="interface_c_p_table_view.html#aec6f0cd6615c4643e90179f847ffbb2d">04792</a> - (void)encodeWithCoder:(<a class="code" href="interface_c_p_coder.html" title="Defines methods for use when archiving &amp; restoring (enc/decoding).">CPCoder</a>)aCoder
<a name="l04793"></a>04793 {
<a name="l04794"></a>04794     [<span class="keyword">super</span> <a class="code" href="interface_c_p_control.html#ad8c17d6f0ad4c14c4f000fb21de93200">encodeWithCoder</a>:aCoder];
<a name="l04795"></a>04795 
<a name="l04796"></a>04796     [aCoder encodeObject:_dataSource forKey:CPTableViewDataSourceKey];
<a name="l04797"></a>04797     [aCoder encodeObject:_delegate forKey:CPTableViewDelegateKey];
<a name="l04798"></a>04798 
<a name="l04799"></a>04799     [aCoder encodeFloat:_rowHeight forKey:CPTableViewRowHeightKey];
<a name="l04800"></a>04800     [aCoder encodeSize:_intercellSpacing forKey:CPTableViewIntercellSpacingKey];
<a name="l04801"></a>04801 
<a name="l04802"></a>04802     [aCoder encodeInt:_selectionHighlightStyle forKey:CPTableViewSelectionHighlightStyleKey];
<a name="l04803"></a>04803     [aCoder encodeInt:_columnAutoResizingStyle forKey:CPTableViewColumnAutoresizingStyleKey];
<a name="l04804"></a>04804 
<a name="l04805"></a>04805     [aCoder encodeBool:_allowsMultipleSelection forKey:CPTableViewMultipleSelectionKey];
<a name="l04806"></a>04806     [aCoder encodeBool:_allowsEmptySelection forKey:CPTableViewEmptySelectionKey];
<a name="l04807"></a>04807     [aCoder encodeBool:_allowsColumnReordering forKey:CPTableViewColumnReorderingKey];
<a name="l04808"></a>04808     [aCoder encodeBool:_allowsColumnResizing forKey:CPTableViewColumnResizingKey];
<a name="l04809"></a>04809     [aCoder encodeBool:_allowsColumnSelection forKey:CPTableViewColumnSelectionKey];
<a name="l04810"></a>04810 
<a name="l04811"></a>04811     [aCoder encodeObject:_tableColumns forKey:CPTableViewTableColumnsKey];
<a name="l04812"></a>04812 
<a name="l04813"></a>04813     [aCoder encodeObject:[<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#a23c390780203dd17c0593b269b705814">gridColor</a>] forKey:CPTableViewGridColorKey];
<a name="l04814"></a>04814     [aCoder encodeInt:_gridStyleMask forKey:CPTableViewGridStyleMaskKey];
<a name="l04815"></a>04815 
<a name="l04816"></a>04816     [aCoder encodeBool:_usesAlternatingRowBackgroundColors forKey:CPTableViewUsesAlternatingBackgroundKey];
<a name="l04817"></a>04817     [aCoder encodeObject:[<span class="keyword">self</span> <a class="code" href="interface_c_p_table_view.html#aa31301940f52f185b7905f89a17e9bc1">alternatingRowBackgroundColors</a>] forKey:CPTableViewAlternatingRowColorsKey];
<a name="l04818"></a>04818 
<a name="l04819"></a>04819     [aCoder encodeObject:_cornerView forKey:CPTableViewCornerViewKey];
<a name="l04820"></a>04820     [aCoder encodeObject:_headerView forKey:CPTableViewHeaderViewKey];
<a name="l04821"></a>04821 
<a name="l04822"></a>04822     [aCoder encodeObject:_autosaveName forKey:CPTableViewAutosaveNameKey];
<a name="l04823"></a>04823 }
<a name="l04824"></a>04824 
<a name="l04825"></a>04825 <span class="keyword">@end</span>
<a name="l04826"></a>04826 
<a name="l04827"></a><a class="code" href="class_c_p_index_set.html">04827</a> <span class="keyword">@implementation </span><a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a> (tableview)
<a name="l04828"></a>04828 
<a name="l04829"></a><a class="code" href="class_c_p_index_set.html#ae25ddde6d99032477687a0448bab061a">04829</a> - (void)removeMatches:(<a class="code" href="class_c_p_index_set.html" title="A collection of unique integers.">CPIndexSet</a>)otherSet
<a name="l04830"></a>04830 {
<a name="l04831"></a>04831     var firstindex = [<span class="keyword">self</span> <a class="code" href="class_c_p_index_set.html#abc895f4b5df7bdaf090161db6b234b73">firstIndex</a>],
<a name="l04832"></a>04832         index = MIN(firstindex, [otherSet <a class="code" href="class_c_p_index_set.html#abc895f4b5df7bdaf090161db6b234b73">firstIndex</a>]),
<a name="l04833"></a>04833         switchFlag = (index == firstindex);
<a name="l04834"></a>04834 
<a name="l04835"></a>04835     <span class="keywordflow">while</span> (index != <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)
<a name="l04836"></a>04836     {
<a name="l04837"></a>04837         var <a class="code" href="class_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a> = (switchFlag) ? otherSet : <span class="keyword">self</span>;
<a name="l04838"></a>04838 
<a name="l04839"></a>04839         otherIndex = [indexSet indexGreaterThanOrEqualToIndex:index];
<a name="l04840"></a>04840 
<a name="l04841"></a>04841         <span class="keywordflow">if</span> (otherIndex == index)
<a name="l04842"></a>04842         {
<a name="l04843"></a>04843             [<span class="keyword">self</span> <a class="code" href="class_c_p_index_set.html#ae5735bf105324052eb4f502244cdd0db">removeIndex</a>:index];
<a name="l04844"></a>04844             [otherSet <a class="code" href="class_c_p_index_set.html#ae5735bf105324052eb4f502244cdd0db">removeIndex</a>:index];
<a name="l04845"></a>04845         }
<a name="l04846"></a>04846 
<a name="l04847"></a>04847         index = otherIndex;
<a name="l04848"></a>04848         switchFlag = !switchFlag;
<a name="l04849"></a>04849     }
<a name="l04850"></a>04850 }
<a name="l04851"></a>04851 
<a name="l04852"></a>04852 <span class="keyword">@end</span>
<a name="l04853"></a>04853 
<a name="l04854"></a>04854 <span class="keyword">@implementation </span>_CPDropOperationDrawingView : <a class="code" href="interface_c_p_view.html">CPView</a>
<a name="l04855"></a>04855 {
<a name="l04856"></a>04856     <span class="keywordtype">unsigned</span>    dropOperation;
<a name="l04857"></a><a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">04857</a>     <a class="code" href="interface_c_p_table_view.html">CPTableView</a> <a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>;
<a name="l04858"></a><a class="code" href="_c_p_table_view_8j.html#a789bfe83cfe007cc723e4fd58bb6b112">04858</a>     <span class="keywordtype">int</span>         <a class="code" href="_c_p_table_view_8j.html#a789bfe83cfe007cc723e4fd58bb6b112">currentRow</a>;
<a name="l04859"></a><a class="code" href="_c_p_table_view_8j.html#ab2661134e33859f16482d8e8aa7a7f5f">04859</a>     BOOL        <a class="code" href="_c_p_table_view_8j.html#ab2661134e33859f16482d8e8aa7a7f5f">isBlinking</a>;
<a name="l04860"></a>04860 }
<a name="l04861"></a>04861 
<a name="l04862"></a>04862 - (void)drawRect:(CGRect)aRect
<a name="l04863"></a>04863 {
<a name="l04864"></a>04864     <span class="keywordflow">if</span> (<a class="code" href="_c_p_table_view_8j.html#a6f0de04f9698790aa0711230cb97d5d2">tableView</a>._destinationDragStyle === <a class="code" href="_c_p_table_view_8j.html#a7d721e523dd8ab8740aff52cb54efa91">CPTableViewDraggingDestinationFeedbackStyleNone</a> || <a class="code" href="_c_p_table_view_8j.html#ab2661134e33859f16482d8e8aa7a7f5f">isBlinking</a>)
<a name="l04865"></a>04865         <span class="keywordflow">return</span>;
<a name="l04866"></a>04866 
<a name="l04867"></a>04867     var context = [[<a class="code" href="interface_c_p_graphics_context.html">CPGraphicsContext</a> <a class="code" href="interface_c_p_graphics_context.html#a378dafc8fb951053dd6877fb45e87f61">currentContext</a>] <a class="code" href="interface_c_p_graphics_context.html#a92895bd939c04da463d02425bec83f0b">graphicsPort</a>];
<a name="l04868"></a>04868 
<a name="l04869"></a>04869     <a class="code" href="group__coregraphics.html#gac13f17a8bed76d16b9e5252106d196e0">CGContextSetStrokeColor</a>(context, [<a class="code" href="interface_c_p_color.html">CPColor</a> colorWithHexString:<span class="stringliteral">@&quot;4886ca&quot;</span>]);
<a name="l04870"></a>04870     <a class="code" href="group__coregraphics.html#ga96bba0be21dd53a15a84c8f23eb7cc70">CGContextSetLineWidth</a>(context, 3);
<a name="l04871"></a>04871 
<a name="l04872"></a>04872     <span class="keywordflow">if</span> (<a class="code" href="_c_p_table_view_8j.html#a789bfe83cfe007cc723e4fd58bb6b112">currentRow</a> === -1)
<a name="l04873"></a>04873     {
<a name="l04874"></a>04874         <a class="code" href="group__coregraphics.html#ga97161b64abcac5e58a722ecb0767993a">CGContextStrokeRect</a>(context, [<span class="keyword">self</span> bounds]);
<a name="l04875"></a>04875     }
<a name="l04876"></a>04876 
<a name="l04877"></a>04877     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dropOperation === <a class="code" href="_c_p_table_view_8j.html#a279093eafa50075a94c202e0dd51861a">CPTableViewDropOn</a>)
<a name="l04878"></a>04878     {
<a name="l04879"></a>04879         <span class="comment">//if row is selected don&#39;t fill and stroke white</span>
<a name="l04880"></a>04880         var selectedRows = [tableView selectedRowIndexes],
<a name="l04881"></a>04881             newRect = _CGRectMake(aRect.origin.x + 2, aRect.origin.y + 2, aRect.size.width - 4, aRect.size.height - 5);
<a name="l04882"></a>04882 
<a name="l04883"></a>04883         <span class="keywordflow">if</span> ([selectedRows containsIndex:<a class="code" href="_c_p_table_view_8j.html#a789bfe83cfe007cc723e4fd58bb6b112">currentRow</a>])
<a name="l04884"></a>04884         {
<a name="l04885"></a>04885             <a class="code" href="group__coregraphics.html#ga96bba0be21dd53a15a84c8f23eb7cc70">CGContextSetLineWidth</a>(context, 2);
<a name="l04886"></a>04886             <a class="code" href="group__coregraphics.html#gac13f17a8bed76d16b9e5252106d196e0">CGContextSetStrokeColor</a>(context, [<a class="code" href="interface_c_p_color.html">CPColor</a> whiteColor]);
<a name="l04887"></a>04887         }
<a name="l04888"></a>04888         <span class="keywordflow">else</span>
<a name="l04889"></a>04889         {
<a name="l04890"></a>04890             <a class="code" href="group__coregraphics.html#ga800a3e5b0c46359d28b091376630bb0e">CGContextSetFillColor</a>(context, [<a class="code" href="interface_c_p_color.html">CPColor</a> colorWithRed:72 / 255 green:134 / 255 blue:202 / 255 alpha:0.25]);
<a name="l04891"></a>04891             <a class="code" href="group__coregraphics.html#ga76628754093e198ead6806bf8a934d35">CGContextFillRoundedRectangleInRect</a>(context, newRect, 8, YES, YES, YES, YES);
<a name="l04892"></a>04892         }
<a name="l04893"></a>04893         <a class="code" href="group__coregraphics.html#ga183a83821529224dc910a3ffd9f07f91">CGContextStrokeRoundedRectangleInRect</a>(context, newRect, 8, YES, YES, YES, YES);
<a name="l04894"></a>04894 
<a name="l04895"></a>04895     }
<a name="l04896"></a>04896     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dropOperation === <a class="code" href="_c_p_table_view_8j.html#a4c2d1434c8bc5b937eeb47b55f5c74d0">CPTableViewDropAbove</a>)
<a name="l04897"></a>04897     {
<a name="l04898"></a>04898         <span class="comment">//reposition the view up a tad</span>
<a name="l04899"></a>04899         [<span class="keyword">self</span> setFrameOrigin:_CGPointMake(_frame.origin.x, _frame.origin.y - 8)];
<a name="l04900"></a>04900 
<a name="l04901"></a>04901         var selectedRows = [tableView selectedRowIndexes];
<a name="l04902"></a>04902 
<a name="l04903"></a>04903         <span class="keywordflow">if</span> ([selectedRows containsIndex:<a class="code" href="_c_p_table_view_8j.html#a789bfe83cfe007cc723e4fd58bb6b112">currentRow</a> - 1] || [selectedRows containsIndex:<a class="code" href="_c_p_table_view_8j.html#a789bfe83cfe007cc723e4fd58bb6b112">currentRow</a>])
<a name="l04904"></a>04904         {
<a name="l04905"></a>04905             <a class="code" href="group__coregraphics.html#gac13f17a8bed76d16b9e5252106d196e0">CGContextSetStrokeColor</a>(context, [<a class="code" href="interface_c_p_color.html">CPColor</a> whiteColor]);
<a name="l04906"></a>04906             <a class="code" href="group__coregraphics.html#ga96bba0be21dd53a15a84c8f23eb7cc70">CGContextSetLineWidth</a>(context, 4);
<a name="l04907"></a>04907             <span class="comment">//draw the circle thing</span>
<a name="l04908"></a>04908             <a class="code" href="group__coregraphics.html#gab6e04d0c787c9f065d87534fd4654cbf">CGContextStrokeEllipseInRect</a>(context, _CGRectMake(aRect.origin.x + 4, aRect.origin.y + 4, 8, 8));
<a name="l04909"></a>04909             <span class="comment">//then draw the line</span>
<a name="l04910"></a>04910             <a class="code" href="group__coregraphics.html#ga02cca9368e5aacc0bef423d724635376">CGContextBeginPath</a>(context);
<a name="l04911"></a>04911             <a class="code" href="group__coregraphics.html#ga44dc04bb1efb98ff834308c997d10dc5">CGContextMoveToPoint</a>(context, 10, aRect.origin.y + 8);
<a name="l04912"></a>04912             <a class="code" href="group__coregraphics.html#ga834b9d5848989453730d162f251a29c3">CGContextAddLineToPoint</a>(context, aRect.size.width - aRect.origin.y - 8, aRect.origin.y + 8);
<a name="l04913"></a>04913             <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l04914"></a>04914             <a class="code" href="group__coregraphics.html#ga03bda4b6dc1763d22d122d565e027012">CGContextStrokePath</a>(context);
<a name="l04915"></a>04915 
<a name="l04916"></a>04916             <a class="code" href="group__coregraphics.html#gac13f17a8bed76d16b9e5252106d196e0">CGContextSetStrokeColor</a>(context, [<a class="code" href="interface_c_p_color.html">CPColor</a> colorWithHexString:<span class="stringliteral">@&quot;4886ca&quot;</span>]);
<a name="l04917"></a>04917             <a class="code" href="group__coregraphics.html#ga96bba0be21dd53a15a84c8f23eb7cc70">CGContextSetLineWidth</a>(context, 3);
<a name="l04918"></a>04918         }
<a name="l04919"></a>04919 
<a name="l04920"></a>04920         <span class="comment">//draw the circle thing</span>
<a name="l04921"></a>04921         <a class="code" href="group__coregraphics.html#gab6e04d0c787c9f065d87534fd4654cbf">CGContextStrokeEllipseInRect</a>(context, _CGRectMake(aRect.origin.x + 4, aRect.origin.y + 4, 8, 8));
<a name="l04922"></a>04922         <span class="comment">//then draw the line</span>
<a name="l04923"></a>04923         <a class="code" href="group__coregraphics.html#ga02cca9368e5aacc0bef423d724635376">CGContextBeginPath</a>(context);
<a name="l04924"></a>04924         <a class="code" href="group__coregraphics.html#ga44dc04bb1efb98ff834308c997d10dc5">CGContextMoveToPoint</a>(context, 10, aRect.origin.y + 8);
<a name="l04925"></a>04925         <a class="code" href="group__coregraphics.html#ga834b9d5848989453730d162f251a29c3">CGContextAddLineToPoint</a>(context, aRect.size.width - aRect.origin.y - 8, aRect.origin.y + 8);
<a name="l04926"></a>04926         <a class="code" href="group__coregraphics.html#gaaf20d10c7501084913e6fdee367f3efa">CGContextClosePath</a>(context);
<a name="l04927"></a>04927         <a class="code" href="group__coregraphics.html#ga03bda4b6dc1763d22d122d565e027012">CGContextStrokePath</a>(context);
<a name="l04928"></a>04928         <span class="comment">//CGContextStrokeLineSegments(context, [aRect.origin.x + 8,  aRect.origin.y + 8, 300 , aRect.origin.y + 8]);</span>
<a name="l04929"></a>04929     }
<a name="l04930"></a>04930 }
<a name="l04931"></a>04931 
<a name="l04932"></a>04932 - (void)blink
<a name="l04933"></a>04933 {
<a name="l04934"></a>04934     <span class="keywordflow">if</span> (dropOperation !== <a class="code" href="_c_p_table_view_8j.html#a279093eafa50075a94c202e0dd51861a">CPTableViewDropOn</a>)
<a name="l04935"></a>04935         <span class="keywordflow">return</span>;
<a name="l04936"></a>04936 
<a name="l04937"></a>04937     <a class="code" href="_c_p_table_view_8j.html#ab2661134e33859f16482d8e8aa7a7f5f">isBlinking</a> = YES;
<a name="l04938"></a>04938 
<a name="l04939"></a>04939     var showCallback = function() {
<a name="l04940"></a>04940         objj_msgSend(<span class="keyword">self</span>, <span class="stringliteral">&quot;setHidden:&quot;</span>, NO)
<a name="l04941"></a>04941         <a class="code" href="_c_p_table_view_8j.html#ab2661134e33859f16482d8e8aa7a7f5f">isBlinking</a> = NO;
<a name="l04942"></a>04942     }
<a name="l04943"></a>04943 
<a name="l04944"></a>04944     var hideCallback = function() {
<a name="l04945"></a>04945         objj_msgSend(<span class="keyword">self</span>, <span class="stringliteral">&quot;setHidden:&quot;</span>, YES)
<a name="l04946"></a>04946         <a class="code" href="_c_p_table_view_8j.html#ab2661134e33859f16482d8e8aa7a7f5f">isBlinking</a> = YES;
<a name="l04947"></a>04947     }
<a name="l04948"></a>04948 
<a name="l04949"></a>04949     objj_msgSend(self, &quot;setHidden:&quot;, YES);
<a name="l04950"></a>04950     [<a class="code" href="interface_c_p_timer.html" title="A timer object that can send a message after the given time interval.">CPTimer</a> scheduledTimerWithTimeInterval:0.1 callback:showCallback repeats:NO];
<a name="l04951"></a>04951     [<a class="code" href="interface_c_p_timer.html" title="A timer object that can send a message after the given time interval.">CPTimer</a> scheduledTimerWithTimeInterval:0.19 callback:hideCallback repeats:NO];
<a name="l04952"></a>04952     [<a class="code" href="interface_c_p_timer.html" title="A timer object that can send a message after the given time interval.">CPTimer</a> scheduledTimerWithTimeInterval:0.27 callback:showCallback repeats:NO];
<a name="l04953"></a>04953 }
<a name="l04954"></a>04954 
<a name="l04955"></a>04955 @end
<a name="l04956"></a>04956 
<a name="l04957"></a>04957 @implementation _CPColumnDragView : <a class="code" href="interface_c_p_view.html">CPView</a>
<a name="l04958"></a>04958 {
<a name="l04959"></a>04959     <a class="code" href="interface_c_p_color.html">CPColor</a> _lineColor;
<a name="l04960"></a>04960 }
<a name="l04961"></a>04961 
<a name="l04962"></a>04962 - (id)initWithLineColor:(<a class="code" href="interface_c_p_color.html">CPColor</a>)aColor
<a name="l04963"></a>04963 {
<a name="l04964"></a>04964     <span class="keyword">self</span> = [<span class="keyword">super</span> initWithFrame:_CGRectMakeZero()];
<a name="l04965"></a>04965 
<a name="l04966"></a>04966     <span class="keywordflow">if</span> (<span class="keyword">self</span>)
<a name="l04967"></a>04967         _lineColor = aColor;
<a name="l04968"></a>04968 
<a name="l04969"></a>04969     <span class="keywordflow">return</span> <span class="keyword">self</span>;
<a name="l04970"></a>04970 }
<a name="l04971"></a>04971 
<a name="l04972"></a>04972 - (void)drawRect:(CGRect)aRect
<a name="l04973"></a>04973 {
<a name="l04974"></a>04974     var context = [[<a class="code" href="interface_c_p_graphics_context.html">CPGraphicsContext</a> <a class="code" href="interface_c_p_graphics_context.html#a378dafc8fb951053dd6877fb45e87f61">currentContext</a>] <a class="code" href="interface_c_p_graphics_context.html#a92895bd939c04da463d02425bec83f0b">graphicsPort</a>];
<a name="l04975"></a>04975 
<a name="l04976"></a>04976     <a class="code" href="group__coregraphics.html#gac13f17a8bed76d16b9e5252106d196e0">CGContextSetStrokeColor</a>(context, _lineColor);
<a name="l04977"></a>04977 
<a name="l04978"></a>04978     var points = [
<a name="l04979"></a>04979                     _CGPointMake(0.5, 0),
<a name="l04980"></a>04980                     _CGPointMake(0.5, aRect.size.height)
<a name="l04981"></a>04981                  ];
<a name="l04982"></a>04982 
<a name="l04983"></a>04983     <a class="code" href="group__coregraphics.html#gae37d73ed577cdc93f9c1e4166b3eb460">CGContextStrokeLineSegments</a>(context, points, 2);
<a name="l04984"></a>04984 
<a name="l04985"></a>04985     points = [
<a name="l04986"></a>04986                 _CGPointMake(aRect.size.width - 0.5, 0),
<a name="l04987"></a>04987                 _CGPointMake(aRect.size.width - 0.5, aRect.size.height)
<a name="l04988"></a>04988              ];
<a name="l04989"></a>04989 
<a name="l04990"></a>04990     <a class="code" href="group__coregraphics.html#gae37d73ed577cdc93f9c1e4166b3eb460">CGContextStrokeLineSegments</a>(context, points, 2);
<a name="l04991"></a>04991 }
<a name="l04992"></a>04992 
<a name="l04993"></a>04993 <span class="keyword">@end</span>
<a name="l04994"></a>04994 
<a name="l04995"></a>04995 <span class="keyword">@implementation </span><a class="code" href="interface_c_p_table_view.html">CPTableView</a> (CPSynthesizedAccessors)
<a name="l04996"></a>04996 
<a name="l05000"></a><a class="code" href="interface_c_p_table_view.html#aca9a136546bf37059f0df015b45a8517">05000</a> - (BOOL)<a class="code" href="interface_c_p_table_view.html#aca9a136546bf37059f0df015b45a8517">disableAutomaticResizing</a>
<a name="l05001"></a>05001 {
<a name="l05002"></a>05002     <span class="keywordflow">return</span> _disableAutomaticResizing;
<a name="l05003"></a>05003 }
<a name="l05004"></a>05004 
<a name="l05008"></a><a class="code" href="interface_c_p_table_view.html#aa30076e5c784d981f73fb5547a8fb98d">05008</a> - (void)setDisableAutomaticResizing:(BOOL)aValue
<a name="l05009"></a>05009 {
<a name="l05010"></a>05010     _disableAutomaticResizing = aValue;
<a name="l05011"></a>05011 }
<a name="l05012"></a>05012 
<a name="l05013"></a>05013 <span class="keyword">@end</span>
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="_c_p_table_view_8j.html">CPTableView.j</a>      </li>
      <li class="footer">Generated on Wed Nov 16 2011 17:34:42 for API by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
